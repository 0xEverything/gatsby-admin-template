{"version":3,"sources":["webpack:///./node_modules/@tinymce/tinymce-react/lib/es2015/main/ts/TinyMCE.js","webpack:///./node_modules/tinymce/plugins/code/plugin.js","webpack:///./node_modules/tinymce/plugins/table/index.js","webpack:///./node_modules/tinymce/plugins/link/index.js","webpack:///./node_modules/tinymce/plugins/image/index.js","webpack:///./node_modules/@tinymce/tinymce-react/lib/es2015/main/ts/components/Editor.js","webpack:///./node_modules/@tinymce/tinymce-react/lib/es2015/main/ts/components/EditorPropTypes.js","webpack:///./node_modules/@tinymce/tinymce-react/lib/es2015/main/ts/Utils.js","webpack:///./node_modules/@tinymce/tinymce-react/lib/es2015/main/ts/ScriptLoader.js","webpack:///./node_modules/@tinymce/tinymce-react/lib/es2015/main/ts/index.js","webpack:///./node_modules/tinymce/plugins/code/index.js","webpack:///./src/pages/editors/tinymce.js","webpack:///./node_modules/tinymce/plugins/table/plugin.js","webpack:///./node_modules/tinymce/plugins/link/plugin.js","webpack:///./node_modules/tinymce/plugins/image/plugin.js"],"names":["getGlobal","window","global","getTinymce","tinymce","util","Tools","resolve","Content","editor","html","focus","undoManager","transact","setContent","selection","setCursorLocation","nodeChanged","getContent","source_view","Dialog","editorContent","windowManager","open","title","size","body","type","items","name","buttons","text","primary","initialData","code","onSubmit","api","getData","close","Commands","register","addCommand","Buttons","ui","registry","addButton","icon","tooltip","onAction","addMenuItem","add","_extendStatics","__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","eventPropTypes","onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onUndo","onVisualAid","EditorPropTypes","apiKey","id","inline","init","initialValue","onEditorChange","value","tagName","cloudChannel","plugins","toolbar","disabled","textareaName","isFunction","x","bindHandlers","props","boundHandlers","keys","filter","map","handler","eventName","substring","findEventHandlers","forEach","found","oldHandler","off","newHandler","e","on","unique","uuid","prefix","time","Date","getTime","Math","floor","random","String","isTextarea","element","toLowerCase","normalizePluginArray","Array","isArray","split","mergePlugins","initPlugins","inputPlugins","concat","__extends","d","b","setPrototypeOf","__proto__","__","constructor","create","scriptState","listeners","scriptId","scriptLoaded","_super","Editor","_this","initialise","finalInit","target","elementRef","current","readonly","setup","initEditor","style","visibility","componentDidUpdate","prevProps","initialized","currentContent","setMode","componentDidMount","ownerDocument","doc","channel","state","url","callback","push","getElementById","scriptTag","createElement","referrerPolicy","addEventListener","src","head","appendChild","injectScriptTag","fn","componentWillUnmount","remove","render","renderInline","renderIframe","initEvent","newContent","_a","ref","propTypes","defaultProps","TinyMCE","useState","setEditor","useEffect","require","keywords","domGlobals","Cell","initial","get","set","v","clone","noop","compose","fa","fb","args","_i","constant","identity","curry","initialArgs","restArgs","all","pIndexOf","not","f","never","always","never$1","always$1","none","NONE","eq","o","isNone","thunk","me","fold","is","isSome","getOr","getOrThunk","getOrDie","msg","Error","getOrNull","getOrUndefined","or","orThunk","ap","each","bind","flatten","exists","forall","equals","equals_","toArray","toString","freeze","some","a","constant_a","self","optfab","fab","elementEq","Option","from","isType","isPrototypeOf","typeOf","isString","isBoolean","isNumber","slice","rawIndexOf","undefined","indexOf","xs","slowIndexOf","contains","pred","findIndex","len","r","foldr","acc","eachr","foldl","find","output","reverse","each$1","obj","k","map$1","tupleMap","tuple","key","has","Immutable","fields","values","struct","sort","arr","reqMessage","required","join","unsuppMessage","unsupported","validateStrArr","label","array","checkDupes","everything","sorted","MixedBag","optional","keys$1","req","opt","COMMENT","Node","ATTRIBUTE_NODE","CDATA_SECTION_NODE","COMMENT_NODE","DOCUMENT","DOCUMENT_NODE","ELEMENT","DOCUMENT_TYPE_NODE","DOCUMENT_FRAGMENT_NODE","ELEMENT_NODE","TEXT","TEXT_NODE","PROCESSING_INSTRUCTION_NODE","ENTITY_REFERENCE_NODE","ENTITY_NODE","NOTATION_NODE","Function","dom","nodeName","nodeType","isType$1","isComment","isElement","isText","rawSet","console","error","setAttribute","setAll","attrs","get$1","getAttribute","has$1","hasAttribute","removeAttribute","attributes","attr","checkRange","str","substr","start","contains$1","startsWith","isSupported","getPropertyValue","cached","called","fromDom","node","Element","fromHtml","scope","div","document","innerHTML","hasChildNodes","childNodes","fromTag","tag","fromText","createTextNode","fromPoint","docElm","y","elementFromPoint","inBody","parentNode","getBody","internalSet","property","setProperty","set$1","setAll$1","css","get$2","getComputedStyle","getUnsafeProperty","getRaw","raw","remove$1","removeProperty","internalRemove","replace","compareDocumentPosition","match","DOCUMENT_POSITION_CONTAINED_BY","unknown","nu","major","minor","Version","detect","versionRegexes","agent","cleanedAgent","regexes","test","firstMatch","group","Number","find$1","isBrowser","nu$1","info","version","isEdge","isChrome","isIE","isOpera","isFirefox","isSafari","Browser","edge","chrome","ie","opera","firefox","safari","isOS","nu$2","isWindows","isiOS","isAndroid","isOSX","isLinux","isSolaris","isFreeBSD","OperatingSystem","windows","ios","android","linux","osx","solaris","freebsd","detect$1","candidates","userAgent","candidate","search","UaString","browsers","browser","oses","os","normalVersionRegex","checkContains","uastring","PlatformInfo","PlatformDetection","deviceType","isiPad","isiPhone","isAndroid3","isAndroid4","isTablet","isTouch","isPhone","iOSwebview","isWebView","DeviceType","PlatformDetection$1","navigator","ELEMENT$1","DOCUMENT$1","selector","elem","matches","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","e1","e2","contains$2","d1","d2","is$1","owner","parent","parents","isRoot","stop","ret","rawParent","prevSibling","previousSibling","nextSibling","children","child","index","cs","before","marker","insertBefore","after","append","prepend","firstChild","wrap","wrapper","after$1","elements","append$1","empty","textContent","rogue","remove$2","removeChild","unwrap","children$1","grid","address","detail","detailnew","extended","rowdata","elementnew","rowdatanew","rowcells","rowdetails","bounds","descendants","predicate","result","ancestors$1","ancestors","children$2","descendants$1","base","querySelectorAll","ClosestOrAncestor","ancestor","el","ancestor$1","child$2","child$1","descendant$1","querySelector","one","closest$1","filterFirstLayer","LayerSelector","firstLayer","lookup","tags","elm","neighbours","neighbourCells","neighbourRows","parseInt","TableLookup","cell","firstCell","cells","table","row","rows","notCell","rowProp","colProp","rowsCount","cols","DetailsList","parentSection","parentName","rowspan","colspan","example","section","column","filterItems","warehouse","Warehouse","generate","list","access","maxRows","maxColumns","details","currentRow","j","cc","newpos","max","grid$1","getAt","findItem","item","comparator","filtered","justCells","w","statsStruct","makeCell","seenSelected","rowIndex","td","CopySelected","selectedSelector","isSelected","house","stats","totalColumns","columns","minRow","minCol","maxRow","maxCol","startRow","endRow","startCol","endCol","findSelectedStats","unselectedCells","totalRows","fillInGaps","emptyRows","clean","getOption","nodeValue","NodeValue","get$3","set$2","getEnd","elementsWithCursorPosition","isCursorPosition","trim","first","descend","child_1","res","last$1","descendantRtl","clone$1","original","isDeep","cloneNode","shallow","deep","copy$1","shallowAs","cloneChildren","createCell","replica","pasteReplace","newRow","TableFill","mutate","formatsToClone","prev","source","sourceDom","targetDom","docu","formats","lastNode","oldCell","newCell","firstText","formatSelector","last","clonedFormat","cloneFormats","cssText","gap","isWithin","finishCol","finishRow","CellBounds","leftEdge","rightEdge","topEdge","bottomEdge","isRect","detailIsWithin","getAnyBox","startCell","finishCell","startCoords","finishCoords","sc","fc","detailA","detailB","min","CellGroup","CellFinder","finish","inside","innerCell","c1","c2","getWarehouse","TablePositions","deltaRow","deltaColumn","firstTable","lastTable","optStartCell","optLastCell","lastCell","TagBoundaries","DomUniverse","up","closest","down","styles","copyTo","destination","as","insert","afterAll","appendAll","query","comparePosition","other","getText","setText","isBoundary","isEmptyTag","leftRight","brokenPath","bisect","universe","ind","unsafeOne","look","tail","commonElement","end","eq$1","ancestors$2","ps1","ps2","prune","path","pruned1","pruned2","shared","firstpath","secondpath","Parent","sharedOne","all$1","subset","ancs","common","finder","ps","topDown","startIndex","endIndex","sIndex","eIndex","unsafeSubset","breakToLeft","parts","prior","breakToRight","second","breakPath","isTop","breaker","next","splits","fallback","breakage","extra","left","right","nextChild","DomParent","_universe","u","c","Identified","lookupTable","container","identify","getIsRoot","rootTable","boxes","startTable","finishTable","ancestorCells","lca","lcaTable","finishAncestorCells","startAncestorCells","CellSelection","retrieve","sels","shiftSelection","firstSelectedSelector","lastSelectedSelector","box","getLast","identified","expandTo","getEdges","tbl","TableSelection","edges","firstAncestor","lastAncestor","fA","lA","selected","Ephemera","attributeSelector","firstSelected","lastSelected","Adt","cases","constructors","adt","acase","count","argLength","branches","branchKeys","reqKey","log","params","type$1","multiple","single","SelectionTypes","cata","subject","onNone","onMultiple","onSingle","selections","CellOperations","_env","noMenu","mergable","unmergable","paste$1","TableTargets","forMenu","paste","pasteRows","clipboard","generators","Clipboard","registerEvents","actions","cellSelection","preventDefault","extractSelected","content","format","innerText","getTextContent","serializer","serialize","serializeElements","getParent","getStart","domCell","getDoc","targets","pasteCells","rng","setRng","clear","Dimension","getOffset","parseFloat","aggregate","properties","val","isNaN","h","getOuter","cumulativeInclusions","api$1","getBoundingClientRect","height","offsetHeight","get$4","api$2","offsetWidth","get$5","getOuter$1","platform","getProp","px","num","toNumber","RuntimeSize","paddingTop","paddingBottom","borderTop","borderBottom","getCalculatedHeight","genericSizeRegex","percentageBasedSizeRegex","pixelBasedSizeRegex","setHeight","amount","normalizePixelSize","getter","setter","suffix","number","newSize","total","convert","getTotalHeight","getHeightValue","getSpan","getRawWidth","width","normalizePercentageWidth","cellWidth","tableSize","pixelWidth","Sizes","setPixelWidth","setPercentageWidth","getPixelWidth","pixelMatch","exec","percentMatch","normalizePixelWidth","choosePixelSize","getPercentageWidth","intWidth","choosePercentageSize","getGenericWidth","unit","setGenericWidth","getHeight","get$6","CellMutations","main","newWidth","Position","top","translate","firstDefinedOrZero","absolute","win","defaultView","documentElement","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","offsetLeft","offsetTop","boxPosition","rowInfo","colInfo","rtlEdge","ltrEdge","getLeftEdge","getRightEdge","getTop","getTopEdge","getBottomEdge","findPositions","getInnerEdge","getOuterEdge","lines","cellOption","lastLine","BarPositions","delta","positions","optElements","rtl","step","ltr","ResizeDirection","TableDirection","directionAt","auto","isRtl","merger","TableGridSize","input","_assign","cat","findMap","setIfNot","ignore","Redraw","newRows","newCells","renderOrRemoveSection","gridSection","sectionName","tb","isNew","tr","renderSection","removeSection","headSection","bodySection","footSection","clonedCell","read","supports","classList","add$1","clazz","remove$4","remove$3","add$2","cleanClass","get$7","has$2","range","deduce","rest","aa","extras","abs","decide","getBlock","isSingle","getFallback","inBlock","Blocks","rowsArr","col","namespace","dashNamespace","Styles","Bar","blocker","position","resizeBar","resizeRowBar","resizeColBar","destroy","wire","previous","drawBar","origin","cpOption","cp","bar","refreshGrid","hdirection","vdirection","rowPositions","tableWidth","rowBar","refreshRow","colPositions","tableHeight","colBar","refreshCol","each$2","bars","Bars","setCells","gridRow","getCell","GridRow","addCell","mutateCell","getCellElement","mapCells","cellLength","findDiff","comp","TableGrid","restOfRow","getRow","endColIndex","restOfColumn","getColumn","endRowIndex","Transitions","seen","ri","ci","updateSeen","rowCells","deriveRows","rendered","findRow","toDetailList","findInWarehouse","run","operation","extract","adjustment","postAction","genWrappers","direction","model","fromWarehouse","cursor","out","newElements","onCell","onPasteRows","lc","onCells","isValue","isError","_","onValue","mapError","toOption","message","onError","Result","fill","generator","rowFill","repititions","repeat","_row","colFill","Fitment","startAddress","gridA","gridB","rowRemainder","colRemainder","colRequired","rowRequired","rowDelta","colDelta","colLengthA","colLengthB","fillCols","MergingOperations","substitution","isToReplace","currentCell","uniqueCells","replacement","_loop_1","_loop_2","sub","isSpanning","matching","TableMerge","fittedGrid","mergeTables","fittedNewGrid","secondDelta","fittedOldGrid","ModificationOperations","between","ex","exampleRow","exampleCol","replaceIn","isTarget","notStartRow","colIndex","notStartColumn","TransformOperations","targetRow","only","middle","ColumnContext","Deltas","context","neighbours$1","zero","newNext","minCellWidth","newThis","diffx","onLeft","singleColumnWidth","_prev","getSpan$1","CellUtils","hasColspan","hasRowspan","minWidth","minHeight","getInt","getRaw$1","getRawW","getRawH","getWidthFrom","getWidth","backups","deduced","getDeduced","getHeightFrom","ColumnSizes","getRawWidths","getPixelWidths","getPercentageWidths","getPixelHeights","getRawHeights","measures","Recalculations","widths","heights","pixelSize","getCellDelta","getWidths","setElementWidth","setTableWidth","newWidths","_delta","chooseSize","floatWidth","_newWidths","change","percentageSize","fallbackWidth","TableSize","getWarehouse$1","getTableWarehouse","Adjustments","adjustWidth","deltas","dx","newSizes","adjustHeight","newHeights","dy","newCellSizes","newRowSizes","adjustWidthTo","baseWith","handleUnsupported","invalidKeys","validate","incorrect","invalidTypeMessage","handleExact","exactly","verifyGenerators","elementToData","Generators","toData","nuFrom","data","recent","getOrInit","makeNew","replaceOrInit","combine","blockList","isBlock","Structure","universe$1","DomStructure","TableContent","isBr","markCell","rightSiblingIsBlock","rightSibling","isListItem","contents","advancedBr","outcome","elementFromGrid","findIn","bundle","uniqueRows","currentDetail","uniqueColumns","gridifyRows","pasteDetails","wh","resize","TableOperations","insertRowBefore","targetIndex","newGrid","insertRowsBefore","newG","insertRowAfter","insertRowsAfter","insertColumnBefore","insertColumnsBefore","insertColumnAfter","insertColumnsAfter","splitCellIntoColumns","splitCellIntoRows","eraseColumns","_comparator","_genWrappers","eraseRows","makeColumnHeader","unmakeColumnHeader","makeRowHeader","unmakeRowHeader","mergeCells","_warehouse","unmergeCells","gridify","nuGrid","pasteRowsBefore","mergedGrid","pasteRowsAfter","getBody$1","getPixelWidth$1","getPixelHeight","addSizeSuffix","removeDataStyle","dataStyleCells","ltr$1","rtl$1","Direction","getDirection","defaultStyles","defaultAttributes","border","getDefaultAttributes","getParam","getDefaultStyles","hasTabNavigation","hasAdvancedCellTab","hasAdvancedRowTab","hasAdvancedTableTab","shouldStyleWithCss","getTableClassList","isPixelsForced","fireNewRow","fire","fireNewCell","fireObjectResizeStart","fireObjectResized","TableActions","lazyWire","isTableBody","cloneElements","getCloneElements","execute","guard","createRng","setStart","setEnd","deleteRow","deleteColumn","CopyRows","selectedCells","slicedGrid","slicedDetails","global$1","Styles$1","formatter","firstChildStyle","elms","currentStyle","getStyle","checkChildren","select","extractAdvancedStyles","rgbToHex","toHex","borderstyle","bordercolor","backgroundcolor","getAlignment","alignments","formatName","dataName","alignmentData","matchNode","getHAlignment","getVAlignment","Helpers","inputList","itemCallback","startItems","appendItems","menuItem","menu","baseData","comparisonData","itemValue","itemKey","comparisonValue","hasAdvTableTab","getAttrib","cellspacing","cellpadding","optBorderWidth","getBorder","caption","align","celltype","spacing","padding","borderWidth","advStyle","borderStyle","borderColor","bgColor","extractAdvancedStyleData","children$3","CellDialogGeneralTab","rowClassList","getCellClassList","classes","textStyle","getCssText","block","getClassList","classlist","DomModifier","normal","setAttrib","setStyle","prop","ifTruthy","updateSimpleProps","modifiers","updateAdvancedProps","applyToSingle","cellElm","rename","halign","valign","applyToMultiple","onSubmitCellForm","CellDialog","cellsData","dialogTabPanel","tabs","dialogPanel","formChildren","RowDialogGeneralTab","getRowClassList","getClassList$1","onSubmitRowForm","oldData","createModifier","rowElm","toType","tableElm","oldParentElm","parentElm","insertAfter","switchRowType","modifier","updateAdvancedProps$1","RowDialog","rowsData","hasOwnProperty$1","merge$3","old","objects","curObject","global$2","DefaultRenderOptions","percentages","render$1","rowHeaders","columnHeaders","renderOpts","tbody","trs","placeCaretInCell","collapse","InsertTable","options","get$8","getOuter$2","insertContent","fireEvents","selectFirstCellInTable","TableDialogGeneralTab","hasClasses","insertNewTable","rowColCountItems","appearanceItems","hasAppearanceOptions","classListItem","styleTDTH","onSubmitTableForm","captionElm","serializeStyle","setAttribs","applyDataToElement","addVisual","TableDialog","generalPanel","dialogBody","getSelectionStartFromSelector","getSelectionStartCell","getSelectionStartCellOrCaption","each$3","registerCommands","clipboardRows","getTableFromCell","getSize","actOnSelection","beforeSize","oldSize","resizeChange","copyRowSelection","pasteOnSelection","clonedRows","mceTableSplitCells","mceTableMergeCells","mceTableInsertRowBefore","mceTableInsertRowAfter","mceTableInsertColBefore","mceTableInsertColAfter","mceTableDeleteCol","mceTableDeleteRow","mceTableCutRow","mceTableCopyRow","mceTablePasteRowBefore","mceTablePasteRowAfter","mceTableDelete","cellOrCaption","isEmpty","func","mceInsertTable","mceTableProps","mceTableRowProps","mceTableCellProps","ResizeWire","view","editable","Event","handlers","unbind","trigger","event","Events","typeDefs","handle","rawEvent","stopPropagation","prevent","kill","evt","mkEvent","clientX","clientY","bind$1","useCapture","wrapped","binder","removeEventListener","filter$1","bind$2","Styles$2","DragMode","DragSink","DragApi","MouseDrag","compare","sink","dragApi","settings","layerClass","Blocker","mdown","forceDrop","mup","drop","mmove","move","mout","delayDrop","mutation","InDrag","events","onEvent","mode","update","reset","Movement","noDragState","inDragState","dragState","isOn","Dragging","rate","timer","active","movement","throttledDrop","cancel","clearTimeout","throttle","setTimeout","runIfActive","go","Dragger","BarMutation","drag","delegate","Mutation","xDelta","yDelta","isContentEditableTrue","resizeBarDragging","BarManager","resizing","hoverTable","getResizer","_dataRow","_dataCol","currentCol","getDelta","dir","startAdjust","mousedown","findClosestEditableTable","findClosestContentEditable","mouseover","refresh","hideBars","showBars","TableWire","margin","createContainer","calculatePercentageWidth","getResizeHandler","startW","startRawW","selectionRng","isTable","lazyResize","rawWire","objectResizing","hasObjectResizing","hasTableResizeBars","sz","manager","beforeResize","afterResize","startDrag","TableResize","getRng","rawTable","targetElm","tableHasPercentage","enforcePixels","isPercentagesForced","tablePercentage","enforcePercentage","percentW","targetPercentW","newCellSizes_1","newCellSize","adt$1","CellLocation","detect$4","CellNavigation","SimRange","adt$2","Situ","onBefore","onOn","onAfter","situ","adt$3","domRange","relative","exact","Selection","exactFromRange","simRange","soffset","foffset","getWin","startContainer","startSitu","finishSitu","getStart$1","selectNodeContentsUsing","selectNodeContents","relativeToNative","createRange","setStartBefore","setStartAfter","setEndBefore","setEndAfter","setFinish","exactToNative","toRect","rect","bottom","adt$4","fromRange","startOffset","endContainer","endOffset","diagnose","ranges","collapsed","rev","doDiagnose","getRanges","asLtrRange","inRect","locateOffset","textnode","rangeForOffset","offset","rectForOffset","maxX","curDeltaX","searchForPoint","searchInChildren","nodes","selectNode","locateNode","rects","getClientRects","locate","getCollapseDirection","createCollapsedNode","collapseDirection","locateInElement","cursorRange","locateInEmpty","searchTextNodes","boundedX","boundedY","locate$1","availableSearch","caretPositionFromPoint","pos","offsetNode","caretRangeFromPoint","beforeSpecial","name$1","preprocessRelative","preprocessExact","after$3","makeRange","same","doSetNativeRange","getSelection","removeAllRanges","addRange","doSetRange","setRangeFromRelative","setBaseAndExtent","extend","setLegacyRtlRange","toNative","getDomRange","preprocess","doGetExact","anchor","anchorNode","focusNode","anchorOffset","focusOffset","rangeCount","firstRng","getRangeAt","lastRng","readRange","setToElement","get$a","sel","getExact","getFirstRect$1","getFirstRect","getAtPoint","fromPoint$1","global$3","forward","backward","getCellFirstCursorPosition","getNewRowCursorPosition","rootElements","TabContext","keyCode","TAB","body_1","isRoot_1","shiftKey","Response","Situs","Util","convertToRange","makeSitus","detect$5","selectRange","cellSel","KeySelection","sync","annotations","newSels","traverse","backtrack","_direction","transition","sidestep","advance","sibling","successors","Walkers","hone","go$1","rules","succ","rule","isLeaf","seekLeft","seekRight","universe$2","before$4","before$3","after$5","after$4","point","adt$5","success","failedUp","failedDown","isRow","BeforeAfter","verify","bridge","beforeOffset","afterOffset","failure","afterCell","beforeCell","beforeBounds","getRect","afterBounds","isOverlapping","_sharedRow","onSuccess","onFailedUp","onFailedDown","inParent","gatherer","cand","gather","handleParent","findBr","br","adjacent","indexInParent","BrTags","handleBr","tgt","analysis","nu$3","Carets","moveUp","caret","moveDown","moveBottomTo","moveTopTo","getBottom","toCaret","getElemBox","Rectangles","getRangedRect","getPartialBox","adt$6","retry","inOutsideBlock","isOutside","upMovement","adjuster","guessBox","higherCaret","downMovement","lowerCaret","adjustForTable","numRetries","adjustTil","isAtTable","situsFromPoint","guess","newCaret","moved","adjusted","getInnerHeight","checkScroll","scrollBy","Retries","tryUp","tryDown","ieTryUp","ieTryDown","getJumpSize","platform$1","tryAgain","tryAt","otherRetry","ieRetry","tryCursor","TableKeys","brNeighbour","fromSitus","findSpot","spot","scan","situs","detection","inSameTable","simulate","VerticalMovement","precheck","seekLeft$1","lastOffset","seekRight$1","findCell","KeyDirection","isKey","keycode","isUp","isDown","SelectionKeys","isBackward","isForward","isNavigation","Rect","sr","WindowBridge","exactAdt","clearSelection","setSelection","setExact","setRelativeSelection","setRelative","selectContents","innerHeight","getScrollY","_DOC","by","rc","InputHandlers","mouse","clearState","mouseup","_event","MouseSelection","keyboard","clearToNavigate","keydown","realEvent","which","attempts","keyup","remove$7","remove$5","SelectionAnnotation","byClass","ephemera","addSelectionClass","removeSelectionClasses","byAttr","removeSelectionAttributes","addSelectionAttribute","hasInternalTarget","Selections","getSelectionTargets","_targets","changeHandlers","findTargets","resetTargets","onSetup","isDisabled","setDisabled","onSetupTable","onSetupCellOrRow","onSetupMergeable","onSetupUnmergeable","addButtons","selectionTargets","addMenuButton","fetch","cmd","command","execCommand","addToolbars","getToolbar","addContextToolbar","MenuItems","addMenuItems","insertTableAction","numRows","numColumns","tableProperties","deleteTable","rowItems","getSubmenuItems","columnItems","cellItems","hasTableGrid","addNestedMenuItem","fancytype","addContextMenu","getApi","resizeHandler","menuItems","insertTable","setClipboardRows","sugarRows","_setClipboardRows","getClipboardRows","_getClipboardRows","Plugin","handlerStruct","mouseHandlers","keyHandlers","handleResponse","response","hasShiftKey","ns","wrappedEvent","wrapEvent","isMouseEvent","isLeftMouse","button","mouseDown","mouseOver","mouseUp","CellSelection$1","addTempAttr","Settings","externalTargets","global$4","OpenUrl","link","href","rel","createEvent","initMouseEvent","dispatchEvent","appendClickRemove","opener","write","DOM","encode","global$5","hasProtocol","applyRelTargetRules","isUnsafe","rels","removeTargetRules","inArray","newRels","addTargetRules","getAnchorElement","selectedElm","getNode","isImageFigure","isLink","className","getLinkAttrs","unlinkImageFigure","fig","img","getParents","linkImageFigure","Utils","attachState","anchorElm","linkAttrs","newRel","assumeExternalTargets","handleExternalTargets","attach","updateLink","createHTML","createLink","grep","trimCaretContainers","getValue","sanitizeWith","extracter","extractValue","sanitizeList","ListOptions","sanitize","createUi","persistentText","fieldName","catalog","hasPersistentText","findTextByValue","meta","DialogChanges","linkSettings","onCatalogChange","catalogs","urlText","onUrlChange","exports$1","module","exports","define","amd","EphoxContactWrapper","1","cachedSetTimeout","cachedClearTimeout","process","defaultSetTimout","defaultClearTimeout","runTimeout","fun","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","runClearTimeout","Item","nextTick","env","argv","versions","addListener","once","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","binding","cwd","chdir","umask","2","setImmediate","root","setTimeoutFunc","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","deferred","_immediateFn","cb","onFulfilled","onRejected","reject","promise","newValue","then","finale","thisArg","_unhandledRejectionFn","Handler","done","reason","prom","remaining","race","err","warn","_setImmediateFn","_setUnhandledRejectionFn","3","clearImmediate","immediateIds","nextImmediateId","Timeout","clearFn","_id","_clearFn","setInterval","clearInterval","unref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","_onTimeout","4","promisePolyfill","Global","boltExport","baseFn","callbacks","nCallback","isReady","cbs","LazyValue","errorReporter","make","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","Future","global$6","tryEmailTransform","tryProtocolTransform","DialogConfirms","transform","setEditorTimeout","confirm","delayedConfirm","AnchorListOptions","anchorNodes","anchors","ClassListOptions","global$7","LinkListOptions","extractor","convertURL","linkList","send","JSON","parse","parseJson","optItems","RelOptions","initialTarget","isTargetBlank_1","fallbacks","TargetOptions","nonEmptyAttr","DialogInfo","linkNode","links","linkClass","extractFromAnchor","optNode","flags","titleEnabled","collectData","getChangedValue","changedData","pData","handleSubmit","displayText","titleText","defaultTarget","getInitialData","dialogDelta","filetype","newData","setData","makeDialog","spec","getLink","getSelectedLink","gotoLink","targetEl","$","scrollIntoView","Actions","openDialog","gotoSelectedLink","leftClickedOnAHref","isCollapsed","setupGotoLinks","metaKeyPressed","altKey","ctrlKey","metaKey","hasOnlyAltModifier","toggleActiveState","nodeChangeHandler","setActive","toggleEnabledState","toolbarKey","Keyboard","addShortcut","Controls","setupButtons","addToggleButton","setupMenuItems","shortcut","setupContextMenu","setupContextToolbars","onSetupLink","buttonApi","addContextForm","launch","initValue","commands","formApi","collapseSelectionToEnd","hide","isObject","bindFuture","resA","bindResult","mapResult","foldResult","whenError","whenValue","withTimeout","errorThunk","timedOut","worker","FutureResult","baseMerge","deepMerge","merge","makeItems","imageList","hasDescription","hasImageTitle","hasDimensions","hasImageCaption","MainTab","getUploadUrl","getUploadHandler","hasUploadTab","hasAdvTab","getPrependUrl","getImageList","hasUploadUrl","hasUploadHandler","getUploadBasePath","getUploadCredentials","parseIntAndGetMax","val1","val2","dimensions","onload","clientWidth","clientHeight","onerror","splitMargin","imgElm","selectImage","blob","reader","FileReader","readAsDataURL","getHspace","image","marginLeft","marginRight","getVspace","marginTop","marginBottom","hasCaption","toggleCaption","figureElm","removeFigure","contentEditable","wrapInFigure","normalizeStyle","normalizeCss","attrValue","setSize","setHspace","pxValue","setVspace","setBorder","setBorderStyle","isFigure","getStyleValue","hspace","vspace","getBorderStyle","alt","updateProp","normalized","_name","mergedCss","compressed","getSelectedImage","splitTextBlock","figure","textBlock","schema","getTextBlockElements","insertImageAtCaret","outerHTML","insertedElm","insertOrUpdateImage","syncSrcAttr","writeImageDataToSelection","deleteImage","sanitizer","findEntryDelegate","isGroup","ListUtils","optList","pathJoin","path1","path2","Uploader","defaultHandler","blobInfo","progress","xhr","formData","XMLHttpRequest","withCredentials","credentials","upload","onprogress","loaded","status","json","responseText","location","basePath","FormData","filename","uploadBlob","AdvTab","collect","urlListSanitizer","futureImageList","completer","readImageDataFromSelection","prependURL","preUrl","UploadTab","fromImageData","images","fileinput","toImageData","addPrependUrl","srcURL","prependUrl","addPrependUrl2","formFillFromMeta","entry","formFillFromMeta2","changeSrc","helpers","imageSize","calculateImageSize","prevImage","updateImagesDropdown","changeStyle2","parseStyle","dataCopy","calcVSpace","calcHSpace","calcBorderWidth","calcBorderStyle","calcStyle","changeFileInput","unblock","file","blobUri","URL","createObjectURL","uploader","finalize","revokeObjectURL","dataUrl","createBlobCache","showTab","alertErr","changeHandler","prevAlt","changeImages","changeStyle","changeAStyle","closeHandler","makeDialogBody","createState","onClose","submitHandler","editorUpload","uploadImagesAuto","documentBaseURI","toAbsolute","blobCache","base64","alert","normalizeCss$1","stylesArg","hasImageClass","toggleContentEditableState","toggleContentEditable","getAll","FilterContent","parser","addNodeFilter","selectorChangedWithUnbind"],"mappings":"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","file":"component---src-pages-editors-tinymce-js-8cc0092271c21f31b51c.js","sourcesContent":["/**\n * Copyright (c) 2017-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nvar getGlobal = function getGlobal() {\n  return typeof window !== 'undefined' ? window : global;\n};\n\nvar getTinymce = function getTinymce() {\n  var global = getGlobal();\n  return global && global.tinymce ? global.tinymce : null;\n};\n\nexport { getTinymce };","/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.0.15 (2019-09-02)\n */\n(function () {\n  'use strict';\n\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var setContent = function setContent(editor, html) {\n    editor.focus();\n    editor.undoManager.transact(function () {\n      editor.setContent(html);\n    });\n    editor.selection.setCursorLocation();\n    editor.nodeChanged();\n  };\n\n  var getContent = function getContent(editor) {\n    return editor.getContent({\n      source_view: true\n    });\n  };\n\n  var Content = {\n    setContent: setContent,\n    getContent: getContent\n  };\n\n  var open = function open(editor) {\n    var editorContent = Content.getContent(editor);\n    editor.windowManager.open({\n      title: 'Source Code',\n      size: 'large',\n      body: {\n        type: 'panel',\n        items: [{\n          type: 'textarea',\n          name: 'code'\n        }]\n      },\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: {\n        code: editorContent\n      },\n      onSubmit: function onSubmit(api) {\n        Content.setContent(editor, api.getData().code);\n        api.close();\n      }\n    });\n  };\n\n  var Dialog = {\n    open: open\n  };\n\n  var register = function register(editor) {\n    editor.addCommand('mceCodeEditor', function () {\n      Dialog.open(editor);\n    });\n  };\n\n  var Commands = {\n    register: register\n  };\n\n  var register$1 = function register$1(editor) {\n    editor.ui.registry.addButton('code', {\n      icon: 'sourcecode',\n      tooltip: 'Source code',\n      onAction: function onAction() {\n        return Dialog.open(editor);\n      }\n    });\n    editor.ui.registry.addMenuItem('code', {\n      icon: 'sourcecode',\n      text: 'Source code',\n      onAction: function onAction() {\n        return Dialog.open(editor);\n      }\n    });\n  };\n\n  var Buttons = {\n    register: register$1\n  };\n\n  function Plugin() {\n    global.add('code', function (editor) {\n      Commands.register(editor);\n      Buttons.register(editor);\n      return {};\n    });\n  }\n\n  Plugin();\n})();","// Exports the \"table\" plugin for usage with module loaders\n// Usage:\n//   CommonJS:\n//     require('tinymce/plugins/table')\n//   ES2015:\n//     import 'tinymce/plugins/table'\nrequire('./plugin.js');","// Exports the \"link\" plugin for usage with module loaders\n// Usage:\n//   CommonJS:\n//     require('tinymce/plugins/link')\n//   ES2015:\n//     import 'tinymce/plugins/link'\nrequire('./plugin.js');","// Exports the \"image\" plugin for usage with module loaders\n// Usage:\n//   CommonJS:\n//     require('tinymce/plugins/image')\n//   ES2015:\n//     import 'tinymce/plugins/image'\nrequire('./plugin.js');","import \"core-js/modules/es6.object.assign\";\nimport \"core-js/modules/es6.object.create\";\nimport \"core-js/modules/es6.object.set-prototype-of\";\n\n/**\n * Copyright (c) 2017-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nvar __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as React from 'react';\nimport * as ScriptLoader from '../ScriptLoader';\nimport { getTinymce } from '../TinyMCE';\nimport { bindHandlers, isFunction, isTextarea, mergePlugins, uuid } from '../Utils';\nimport { EditorPropTypes } from './EditorPropTypes';\nvar scriptState = ScriptLoader.create();\n\nvar Editor =\n/** @class */\nfunction (_super) {\n  __extends(Editor, _super);\n\n  function Editor(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.initialise = function () {\n      var finalInit = __assign({}, _this.props.init, {\n        target: _this.elementRef.current,\n        readonly: _this.props.disabled,\n        inline: _this.inline,\n        plugins: mergePlugins(_this.props.init && _this.props.init.plugins, _this.props.plugins),\n        toolbar: _this.props.toolbar || _this.props.init && _this.props.init.toolbar,\n        setup: function setup(editor) {\n          _this.editor = editor;\n          editor.on('init', function (e) {\n            _this.initEditor(e, editor);\n          });\n\n          if (_this.props.init && typeof _this.props.init.setup === 'function') {\n            _this.props.init.setup(editor);\n          }\n        }\n      });\n\n      if (isTextarea(_this.elementRef.current)) {\n        _this.elementRef.current.style.visibility = '';\n      }\n\n      getTinymce().init(finalInit);\n    };\n\n    _this.id = _this.props.id || uuid('tiny-react');\n    _this.elementRef = React.createRef();\n    _this.inline = _this.props.inline ? _this.props.inline : _this.props.init && _this.props.init.inline;\n    _this.boundHandlers = {};\n    return _this;\n  }\n\n  Editor.prototype.componentDidUpdate = function (prevProps) {\n    if (this.editor && this.editor.initialized) {\n      bindHandlers(this.editor, this.props, this.boundHandlers);\n      this.currentContent = this.currentContent || this.editor.getContent();\n\n      if (typeof this.props.value === 'string' && this.props.value !== prevProps.value && this.props.value !== this.currentContent) {\n        this.editor.setContent(this.props.value);\n      }\n\n      if (typeof this.props.disabled === 'boolean' && this.props.disabled !== prevProps.disabled) {\n        this.editor.setMode(this.props.disabled ? 'readonly' : 'design');\n      }\n    }\n  };\n\n  Editor.prototype.componentDidMount = function () {\n    if (getTinymce() !== null) {\n      this.initialise();\n    } else if (this.elementRef.current && this.elementRef.current.ownerDocument) {\n      var doc = this.elementRef.current.ownerDocument;\n      var channel = this.props.cloudChannel;\n      var apiKey = this.props.apiKey ? this.props.apiKey : 'no-api-key';\n      ScriptLoader.load(scriptState, doc, \"https://cdn.tiny.cloud/1/\" + apiKey + \"/tinymce/\" + channel + \"/tinymce.min.js\", this.initialise);\n    }\n  };\n\n  Editor.prototype.componentWillUnmount = function () {\n    if (getTinymce() !== null) {\n      getTinymce().remove(this.editor);\n    }\n  };\n\n  Editor.prototype.render = function () {\n    return this.inline ? this.renderInline() : this.renderIframe();\n  };\n\n  Editor.prototype.initEditor = function (initEvent, editor) {\n    var _this = this;\n\n    var value = typeof this.props.value === 'string' ? this.props.value : typeof this.props.initialValue === 'string' ? this.props.initialValue : '';\n    editor.setContent(value);\n\n    if (isFunction(this.props.onEditorChange)) {\n      editor.on('change keyup setcontent', function (e) {\n        var newContent = editor.getContent();\n\n        if (newContent !== _this.currentContent) {\n          _this.currentContent = newContent;\n\n          if (isFunction(_this.props.onEditorChange)) {\n            _this.props.onEditorChange(_this.currentContent, editor);\n          }\n        }\n      });\n    }\n\n    if (isFunction(this.props.onInit)) {\n      this.props.onInit(initEvent, editor);\n    }\n\n    bindHandlers(editor, this.props, this.boundHandlers);\n  };\n\n  Editor.prototype.renderInline = function () {\n    var _a = this.props.tagName,\n        tagName = _a === void 0 ? 'div' : _a;\n    return React.createElement(tagName, {\n      ref: this.elementRef,\n      id: this.id\n    });\n  };\n\n  Editor.prototype.renderIframe = function () {\n    return React.createElement('textarea', {\n      ref: this.elementRef,\n      style: {\n        visibility: 'hidden'\n      },\n      name: this.props.textareaName,\n      id: this.id\n    });\n  };\n\n  Editor.propTypes = EditorPropTypes;\n  Editor.defaultProps = {\n    cloudChannel: '5'\n  };\n  return Editor;\n}(React.Component);\n\nexport { Editor };","import \"core-js/modules/es6.object.assign\";\n\n/**\n * Copyright (c) 2017-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport * as PropTypes from 'prop-types';\nexport var eventPropTypes = {\n  onActivate: PropTypes.func,\n  onAddUndo: PropTypes.func,\n  onBeforeAddUndo: PropTypes.func,\n  onBeforeExecCommand: PropTypes.func,\n  onBeforeGetContent: PropTypes.func,\n  onBeforeRenderUI: PropTypes.func,\n  onBeforeSetContent: PropTypes.func,\n  onBeforePaste: PropTypes.func,\n  onBlur: PropTypes.func,\n  onChange: PropTypes.func,\n  onClearUndos: PropTypes.func,\n  onClick: PropTypes.func,\n  onContextMenu: PropTypes.func,\n  onCopy: PropTypes.func,\n  onCut: PropTypes.func,\n  onDblclick: PropTypes.func,\n  onDeactivate: PropTypes.func,\n  onDirty: PropTypes.func,\n  onDrag: PropTypes.func,\n  onDragDrop: PropTypes.func,\n  onDragEnd: PropTypes.func,\n  onDragGesture: PropTypes.func,\n  onDragOver: PropTypes.func,\n  onDrop: PropTypes.func,\n  onExecCommand: PropTypes.func,\n  onFocus: PropTypes.func,\n  onFocusIn: PropTypes.func,\n  onFocusOut: PropTypes.func,\n  onGetContent: PropTypes.func,\n  onHide: PropTypes.func,\n  onInit: PropTypes.func,\n  onKeyDown: PropTypes.func,\n  onKeyPress: PropTypes.func,\n  onKeyUp: PropTypes.func,\n  onLoadContent: PropTypes.func,\n  onMouseDown: PropTypes.func,\n  onMouseEnter: PropTypes.func,\n  onMouseLeave: PropTypes.func,\n  onMouseMove: PropTypes.func,\n  onMouseOut: PropTypes.func,\n  onMouseOver: PropTypes.func,\n  onMouseUp: PropTypes.func,\n  onNodeChange: PropTypes.func,\n  onObjectResizeStart: PropTypes.func,\n  onObjectResized: PropTypes.func,\n  onObjectSelected: PropTypes.func,\n  onPaste: PropTypes.func,\n  onPostProcess: PropTypes.func,\n  onPostRender: PropTypes.func,\n  onPreProcess: PropTypes.func,\n  onProgressState: PropTypes.func,\n  onRedo: PropTypes.func,\n  onRemove: PropTypes.func,\n  onReset: PropTypes.func,\n  onSaveContent: PropTypes.func,\n  onSelectionChange: PropTypes.func,\n  onSetAttrib: PropTypes.func,\n  onSetContent: PropTypes.func,\n  onShow: PropTypes.func,\n  onSubmit: PropTypes.func,\n  onUndo: PropTypes.func,\n  onVisualAid: PropTypes.func\n};\nexport var EditorPropTypes = __assign({\n  apiKey: PropTypes.string,\n  id: PropTypes.string,\n  inline: PropTypes.bool,\n  init: PropTypes.object,\n  initialValue: PropTypes.string,\n  onEditorChange: PropTypes.func,\n  value: PropTypes.string,\n  tagName: PropTypes.string,\n  cloudChannel: PropTypes.string,\n  plugins: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n  toolbar: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n  disabled: PropTypes.bool,\n  textareaName: PropTypes.string\n}, eventPropTypes);","import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.array.is-array\";\nimport \"core-js/modules/es6.array.for-each\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.iterator\";\nimport \"core-js/modules/es6.object.to-string\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.array.filter\";\nimport \"core-js/modules/es6.array.map\";\n\n/**\n * Copyright (c) 2017-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport { eventPropTypes } from './components/EditorPropTypes';\nexport var isFunction = function isFunction(x) {\n  return typeof x === 'function';\n};\n\nvar isEventProp = function isEventProp(name) {\n  return name in eventPropTypes;\n};\n\nvar findEventHandlers = function findEventHandlers(props) {\n  return Object.keys(props).filter(isEventProp).filter(function (name) {\n    return isFunction(props[name]);\n  }).map(function (name) {\n    return {\n      handler: props[name],\n      eventName: name.substring(2)\n    };\n  });\n};\n\nexport var bindHandlers = function bindHandlers(editor, props, boundHandlers) {\n  findEventHandlers(props).forEach(function (found) {\n    // Unbind old handler\n    var oldHandler = boundHandlers[found.eventName];\n\n    if (isFunction(oldHandler)) {\n      editor.off(found.eventName, oldHandler);\n    } // Bind new handler\n\n\n    var newHandler = function newHandler(e) {\n      return found.handler(e, editor);\n    };\n\n    boundHandlers[found.eventName] = newHandler;\n    editor.on(found.eventName, newHandler);\n  });\n};\nvar unique = 0;\nexport var uuid = function uuid(prefix) {\n  var date = new Date();\n  var time = date.getTime();\n  var random = Math.floor(Math.random() * 1000000000);\n  unique++;\n  return prefix + '_' + random + unique + String(time);\n};\nexport var isTextarea = function isTextarea(element) {\n  return element !== null && element.tagName.toLowerCase() === 'textarea';\n};\n\nvar normalizePluginArray = function normalizePluginArray(plugins) {\n  if (typeof plugins === 'undefined' || plugins === '') {\n    return [];\n  }\n\n  return Array.isArray(plugins) ? plugins : plugins.split(' ');\n};\n\nexport var mergePlugins = function mergePlugins(initPlugins, inputPlugins) {\n  return normalizePluginArray(initPlugins).concat(normalizePluginArray(inputPlugins));\n};","import \"core-js/modules/es6.array.for-each\";\n\n/**\n * Copyright (c) 2017-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport { uuid } from './Utils';\n\nvar injectScriptTag = function injectScriptTag(scriptId, doc, url, callback) {\n  var scriptTag = doc.createElement('script');\n  scriptTag.referrerPolicy = 'origin';\n  scriptTag.type = 'application/javascript';\n  scriptTag.id = scriptId;\n  scriptTag.addEventListener('load', callback);\n  scriptTag.src = url;\n\n  if (doc.head) {\n    doc.head.appendChild(scriptTag);\n  }\n};\n\nexport var create = function create() {\n  return {\n    listeners: [],\n    scriptId: uuid('tiny-script'),\n    scriptLoaded: false\n  };\n};\nexport var load = function load(state, doc, url, callback) {\n  if (state.scriptLoaded) {\n    callback();\n  } else {\n    state.listeners.push(callback);\n\n    if (!doc.getElementById(state.scriptId)) {\n      injectScriptTag(state.scriptId, doc, url, function () {\n        state.listeners.forEach(function (fn) {\n          return fn();\n        });\n        state.scriptLoaded = true;\n      });\n    }\n  }\n};","/**\n * Copyright (c) 2017-present, Ephox, Inc.\n *\n * This source code is licensed under the Apache 2 license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport { Editor } from './components/Editor';\nexport { Editor };","// Exports the \"code\" plugin for usage with module loaders\n// Usage:\n//   CommonJS:\n//     require('tinymce/plugins/code')\n//   ES2015:\n//     import 'tinymce/plugins/code'\nrequire('./plugin.js');","import React, { useState, useEffect } from 'react';\nimport { Card, CardBody } from 'oah-ui';\nimport SEO from '../../components/SEO';\n\nexport default function TinyMCE() {\n  const [editor, setEditor] = useState('');\n\n  useEffect(() => {\n    if (window) {\n      require('tinymce/plugins/table');\n      require('tinymce/plugins/link');\n      require('tinymce/plugins/image');\n      require('tinymce/plugins/code');\n      const { Editor } = require('@tinymce/tinymce-react');\n      setEditor(<Editor init={{ plugins: 'link table image code' }} />);\n    }\n  }, []);\n\n  return (\n    <Card>\n      <SEO title=\"Tiny MCE\" keywords={['OAH', 'application', 'react']} />\n      <header>Tiny MCE</header>\n      <CardBody>{editor}</CardBody>\n    </Card>\n  );\n}\n","require(\"core-js/modules/es6.regexp.to-string\");\n\nrequire(\"core-js/modules/es6.date.to-string\");\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.string.sub\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.object.assign\");\n\nrequire(\"core-js/modules/es6.regexp.match\");\n\nrequire(\"core-js/modules/es6.function.bind\");\n\nrequire(\"core-js/modules/es6.string.trim\");\n\nrequire(\"core-js/modules/es6.regexp.search\");\n\nrequire(\"core-js/modules/es6.number.constructor\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nrequire(\"core-js/modules/es6.array.sort\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.object.keys\");\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.array.from\");\n\nrequire(\"core-js/modules/es6.array.some\");\n\nrequire(\"core-js/modules/es6.array.index-of\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es6.object.freeze\");\n\n/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.0.15 (2019-09-02)\n */\n(function (domGlobals) {\n  'use strict';\n\n  var Cell = function Cell(initial) {\n    var value = initial;\n\n    var get = function get() {\n      return value;\n    };\n\n    var set = function set(v) {\n      value = v;\n    };\n\n    var clone = function clone() {\n      return Cell(get());\n    };\n\n    return {\n      get: get,\n      set: set,\n      clone: clone\n    };\n  };\n\n  var noop = function noop() {};\n\n  var compose = function compose(fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var constant = function constant(value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function identity(x) {\n    return x;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function not(f) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return !f.apply(null, args);\n    };\n  };\n\n  var die = function die(msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n  var never$1 = never;\n  var always$1 = always;\n\n  var none = function none() {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function eq(o) {\n      return o.isNone();\n    };\n\n    var call = function call(thunk) {\n      return thunk();\n    };\n\n    var id = function id(n) {\n      return n;\n    };\n\n    var noop = function noop() {};\n\n    var nul = function nul() {\n      return null;\n    };\n\n    var undef = function undef() {\n      return undefined;\n    };\n\n    var me = {\n      fold: function fold(n, s) {\n        return n();\n      },\n      is: never$1,\n      isSome: never$1,\n      isNone: always$1,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function getOrDie(msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: nul,\n      getOrUndefined: undef,\n      or: id,\n      orThunk: call,\n      map: none,\n      ap: none,\n      each: noop,\n      bind: none,\n      flatten: none,\n      exists: never$1,\n      forall: always$1,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function toArray() {\n        return [];\n      },\n      toString: constant('none()')\n    };\n\n    if (Object.freeze) {\n      Object.freeze(me);\n    }\n\n    return me;\n  }();\n\n  var some = function some(a) {\n    var constant_a = function constant_a() {\n      return a;\n    };\n\n    var self = function self() {\n      return me;\n    };\n\n    var map = function map(f) {\n      return some(f(a));\n    };\n\n    var bind = function bind(f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function fold(n, s) {\n        return s(a);\n      },\n      is: function is(v) {\n        return a === v;\n      },\n      isSome: always$1,\n      isNone: never$1,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: map,\n      ap: function ap(optfab) {\n        return optfab.fold(none, function (fab) {\n          return some(fab(a));\n        });\n      },\n      each: function each(f) {\n        f(a);\n      },\n      bind: bind,\n      flatten: constant_a,\n      exists: bind,\n      forall: bind,\n      filter: function filter(f) {\n        return f(a) ? me : NONE;\n      },\n      equals: function equals(o) {\n        return o.is(a);\n      },\n      equals_: function equals_(o, elementEq) {\n        return o.fold(never$1, function (b) {\n          return elementEq(a, b);\n        });\n      },\n      toArray: function toArray() {\n        return [a];\n      },\n      toString: function toString() {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from = function from(value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Option = {\n    some: some,\n    none: none,\n    from: from\n  };\n  var global = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var typeOf = function typeOf(x) {\n    if (x === null) {\n      return 'null';\n    }\n\n    var t = typeof x;\n\n    if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    }\n\n    if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    }\n\n    return t;\n  };\n\n  var isType = function isType(type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isString = isType('string');\n  var isArray = isType('array');\n  var isBoolean = isType('boolean');\n  var isFunction = isType('function');\n  var isNumber = isType('number');\n  var slice = Array.prototype.slice;\n\n  var rawIndexOf = function () {\n    var pIndexOf = Array.prototype.indexOf;\n\n    var fastIndex = function fastIndex(xs, x) {\n      return pIndexOf.call(xs, x);\n    };\n\n    var slowIndex = function slowIndex(xs, x) {\n      return slowIndexOf(xs, x);\n    };\n\n    return pIndexOf === undefined ? slowIndex : fastIndex;\n  }();\n\n  var contains = function contains(xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function exists(xs, pred) {\n    return findIndex(xs, pred).isSome();\n  };\n\n  var map = function map(xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i, xs);\n    }\n\n    return r;\n  };\n\n  var each = function each(xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i, xs);\n    }\n  };\n\n  var eachr = function eachr(xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i, xs);\n    }\n  };\n\n  var filter = function filter(xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i, xs)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function foldr(xs, f, acc) {\n    eachr(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var foldl = function foldl(xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var find = function find(xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i, xs)) {\n        return Option.some(x);\n      }\n    }\n\n    return Option.none();\n  };\n\n  var findIndex = function findIndex(xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i, xs)) {\n        return Option.some(i);\n      }\n    }\n\n    return Option.none();\n  };\n\n  var slowIndexOf = function slowIndexOf(xs, x) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (xs[i] === x) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var push = Array.prototype.push;\n\n  var flatten = function flatten(xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      push.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function bind(xs, f) {\n    var output = map(xs, f);\n    return flatten(output);\n  };\n\n  var forall = function forall(xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i, xs) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function reverse(xs) {\n    var r = slice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var last = function last(xs) {\n    return xs.length === 0 ? Option.none() : Option.some(xs[xs.length - 1]);\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return slice.call(x);\n  };\n  var keys = Object.keys;\n  var hasOwnProperty = Object.hasOwnProperty;\n\n  var each$1 = function each$1(obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i, obj);\n    }\n  };\n\n  var map$1 = function map$1(obj, f) {\n    return tupleMap(obj, function (x, i, obj) {\n      return {\n        k: i,\n        v: f(x, i, obj)\n      };\n    });\n  };\n\n  var tupleMap = function tupleMap(obj, f) {\n    var r = {};\n    each$1(obj, function (x, i) {\n      var tuple = f(x, i, obj);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var get = function get(obj, key) {\n    return has(obj, key) ? Option.from(obj[key]) : Option.none();\n  };\n\n  var has = function has(obj, key) {\n    return hasOwnProperty.call(obj, key);\n  };\n\n  var Immutable = function Immutable() {\n    var fields = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      fields[_i] = arguments[_i];\n    }\n\n    return function () {\n      var values = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        values[_i] = arguments[_i];\n      }\n\n      if (fields.length !== values.length) {\n        throw new Error('Wrong number of arguments to struct. Expected \"[' + fields.length + ']\", got ' + values.length + ' arguments');\n      }\n\n      var struct = {};\n      each(fields, function (name, i) {\n        struct[name] = constant(values[i]);\n      });\n      return struct;\n    };\n  };\n\n  var sort = function sort(arr) {\n    return arr.slice(0).sort();\n  };\n\n  var reqMessage = function reqMessage(required, keys) {\n    throw new Error('All required keys (' + sort(required).join(', ') + ') were not specified. Specified keys were: ' + sort(keys).join(', ') + '.');\n  };\n\n  var unsuppMessage = function unsuppMessage(unsupported) {\n    throw new Error('Unsupported keys for object: ' + sort(unsupported).join(', '));\n  };\n\n  var validateStrArr = function validateStrArr(label, array) {\n    if (!isArray(array)) {\n      throw new Error('The ' + label + ' fields must be an array. Was: ' + array + '.');\n    }\n\n    each(array, function (a) {\n      if (!isString(a)) {\n        throw new Error('The value ' + a + ' in the ' + label + ' fields was not a string.');\n      }\n    });\n  };\n\n  var invalidTypeMessage = function invalidTypeMessage(incorrect, type) {\n    throw new Error('All values need to be of type: ' + type + '. Keys (' + sort(incorrect).join(', ') + ') were not.');\n  };\n\n  var checkDupes = function checkDupes(everything) {\n    var sorted = sort(everything);\n    var dupe = find(sorted, function (s, i) {\n      return i < sorted.length - 1 && s === sorted[i + 1];\n    });\n    dupe.each(function (d) {\n      throw new Error('The field: ' + d + ' occurs more than once in the combined fields: [' + sorted.join(', ') + '].');\n    });\n  };\n\n  var MixedBag = function MixedBag(required, optional) {\n    var everything = required.concat(optional);\n\n    if (everything.length === 0) {\n      throw new Error('You must specify at least one required or optional field.');\n    }\n\n    validateStrArr('required', required);\n    validateStrArr('optional', optional);\n    checkDupes(everything);\n    return function (obj) {\n      var keys$1 = keys(obj);\n      var allReqd = forall(required, function (req) {\n        return contains(keys$1, req);\n      });\n\n      if (!allReqd) {\n        reqMessage(required, keys$1);\n      }\n\n      var unsupported = filter(keys$1, function (key) {\n        return !contains(everything, key);\n      });\n\n      if (unsupported.length > 0) {\n        unsuppMessage(unsupported);\n      }\n\n      var r = {};\n      each(required, function (req) {\n        r[req] = constant(obj[req]);\n      });\n      each(optional, function (opt) {\n        r[opt] = constant(Object.prototype.hasOwnProperty.call(obj, opt) ? Option.some(obj[opt]) : Option.none());\n      });\n      return r;\n    };\n  };\n\n  var ATTRIBUTE = domGlobals.Node.ATTRIBUTE_NODE;\n  var CDATA_SECTION = domGlobals.Node.CDATA_SECTION_NODE;\n  var COMMENT = domGlobals.Node.COMMENT_NODE;\n  var DOCUMENT = domGlobals.Node.DOCUMENT_NODE;\n  var DOCUMENT_TYPE = domGlobals.Node.DOCUMENT_TYPE_NODE;\n  var DOCUMENT_FRAGMENT = domGlobals.Node.DOCUMENT_FRAGMENT_NODE;\n  var ELEMENT = domGlobals.Node.ELEMENT_NODE;\n  var TEXT = domGlobals.Node.TEXT_NODE;\n  var PROCESSING_INSTRUCTION = domGlobals.Node.PROCESSING_INSTRUCTION_NODE;\n  var ENTITY_REFERENCE = domGlobals.Node.ENTITY_REFERENCE_NODE;\n  var ENTITY = domGlobals.Node.ENTITY_NODE;\n  var NOTATION = domGlobals.Node.NOTATION_NODE;\n  var Global = typeof domGlobals.window !== 'undefined' ? domGlobals.window : Function('return this;')();\n\n  var name = function name(element) {\n    var r = element.dom().nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function type(element) {\n    return element.dom().nodeType;\n  };\n\n  var isType$1 = function isType$1(t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isComment = function isComment(element) {\n    return type(element) === COMMENT || name(element) === '#comment';\n  };\n\n  var isElement = isType$1(ELEMENT);\n  var isText = isType$1(TEXT);\n\n  var rawSet = function rawSet(dom, key, value) {\n    if (isString(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      domGlobals.console.error('Invalid call to Attr.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set = function set(element, key, value) {\n    rawSet(element.dom(), key, value);\n  };\n\n  var setAll = function setAll(element, attrs) {\n    var dom = element.dom();\n    each$1(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var get$1 = function get$1(element, key) {\n    var v = element.dom().getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var has$1 = function has$1(element, key) {\n    var dom = element.dom();\n    return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n  };\n\n  var remove = function remove(element, key) {\n    element.dom().removeAttribute(key);\n  };\n\n  var clone = function clone(element) {\n    return foldl(element.dom().attributes, function (acc, attr) {\n      acc[attr.name] = attr.value;\n      return acc;\n    }, {});\n  };\n\n  var checkRange = function checkRange(str, substr, start) {\n    if (substr === '') {\n      return true;\n    }\n\n    if (str.length < substr.length) {\n      return false;\n    }\n\n    var x = str.substr(start, start + substr.length);\n    return x === substr;\n  };\n\n  var contains$1 = function contains$1(str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var startsWith = function startsWith(str, prefix) {\n    return checkRange(str, prefix, 0);\n  };\n\n  var endsWith = function endsWith(str, suffix) {\n    return checkRange(str, suffix, str.length - suffix.length);\n  };\n\n  var trim = function trim(str) {\n    return str.replace(/^\\s+|\\s+$/g, '');\n  };\n\n  var isSupported = function isSupported(dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var cached = function cached(f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var fromHtml = function fromHtml(html, scope) {\n    var doc = scope || domGlobals.document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      domGlobals.console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom(div.childNodes[0]);\n  };\n\n  var fromTag = function fromTag(tag, scope) {\n    var doc = scope || domGlobals.document;\n    var node = doc.createElement(tag);\n    return fromDom(node);\n  };\n\n  var fromText = function fromText(text, scope) {\n    var doc = scope || domGlobals.document;\n    var node = doc.createTextNode(text);\n    return fromDom(node);\n  };\n\n  var fromDom = function fromDom(node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: constant(node)\n    };\n  };\n\n  var fromPoint = function fromPoint(docElm, x, y) {\n    var doc = docElm.dom();\n    return Option.from(doc.elementFromPoint(x, y)).map(fromDom);\n  };\n\n  var Element = {\n    fromHtml: fromHtml,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom,\n    fromPoint: fromPoint\n  };\n\n  var inBody = function inBody(element) {\n    var dom = isText(element) ? element.dom().parentNode : element.dom();\n    return dom !== undefined && dom !== null && dom.ownerDocument.body.contains(dom);\n  };\n\n  var body = cached(function () {\n    return getBody(Element.fromDom(domGlobals.document));\n  });\n\n  var getBody = function getBody(doc) {\n    var b = doc.dom().body;\n\n    if (b === null || b === undefined) {\n      throw new Error('Body is not available yet');\n    }\n\n    return Element.fromDom(b);\n  };\n\n  var internalSet = function internalSet(dom, property, value) {\n    if (!isString(value)) {\n      domGlobals.console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var internalRemove = function internalRemove(dom, property) {\n    if (isSupported(dom)) {\n      dom.style.removeProperty(property);\n    }\n  };\n\n  var set$1 = function set$1(element, property, value) {\n    var dom = element.dom();\n    internalSet(dom, property, value);\n  };\n\n  var setAll$1 = function setAll$1(element, css) {\n    var dom = element.dom();\n    each$1(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var get$2 = function get$2(element, property) {\n    var dom = element.dom();\n    var styles = domGlobals.window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    var v = r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    return v === null ? undefined : v;\n  };\n\n  var getUnsafeProperty = function getUnsafeProperty(dom, property) {\n    return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw = function getRaw(element, property) {\n    var dom = element.dom();\n    var raw = getUnsafeProperty(dom, property);\n    return Option.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var remove$1 = function remove$1(element, property) {\n    var dom = element.dom();\n    internalRemove(dom, property);\n\n    if (has$1(element, 'style') && trim(get$1(element, 'style')) === '') {\n      remove(element, 'style');\n    }\n  };\n\n  var copy = function copy(source, target) {\n    var sourceDom = source.dom();\n    var targetDom = target.dom();\n\n    if (isSupported(sourceDom) && isSupported(targetDom)) {\n      targetDom.style.cssText = sourceDom.style.cssText;\n    }\n  };\n\n  var compareDocumentPosition = function compareDocumentPosition(a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionPreceding = function documentPositionPreceding(a, b) {\n    return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_PRECEDING);\n  };\n\n  var documentPositionContainedBy = function documentPositionContainedBy(a, b) {\n    return compareDocumentPosition(a, b, domGlobals.Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var Node = {\n    documentPositionPreceding: documentPositionPreceding,\n    documentPositionContainedBy: documentPositionContainedBy\n  };\n\n  var firstMatch = function firstMatch(regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$1 = function find$1(regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function group(i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu(group(1), group(2));\n  };\n\n  var detect = function detect(versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown();\n    }\n\n    return find$1(versionRegexes, cleanedAgent);\n  };\n\n  var unknown = function unknown() {\n    return nu(0, 0);\n  };\n\n  var nu = function nu(major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu,\n    detect: detect,\n    unknown: unknown\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var isBrowser = function isBrowser(name, current) {\n    return function () {\n      return current === name;\n    };\n  };\n\n  var unknown$1 = function unknown$1() {\n    return nu$1({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$1 = function nu$1(info) {\n    var current = info.current;\n    var version = info.version;\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge, current),\n      isChrome: isBrowser(chrome, current),\n      isIE: isBrowser(ie, current),\n      isOpera: isBrowser(opera, current),\n      isFirefox: isBrowser(firefox, current),\n      isSafari: isBrowser(safari, current)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$1,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n\n  var isOS = function isOS(name, current) {\n    return function () {\n      return current === name;\n    };\n  };\n\n  var unknown$2 = function unknown$2() {\n    return nu$2({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$2 = function nu$2(info) {\n    var current = info.current;\n    var version = info.version;\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows, current),\n      isiOS: isOS(ios, current),\n      isAndroid: isOS(android, current),\n      isOSX: isOS(osx, current),\n      isLinux: isOS(linux, current),\n      isSolaris: isOS(solaris, current),\n      isFreeBSD: isOS(freebsd, current)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown$2,\n    nu: nu$2,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd)\n  };\n\n  var DeviceType = function DeviceType(os, browser, userAgent) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isAndroid3 = os.isAndroid() && os.version.major === 3;\n    var isAndroid4 = os.isAndroid() && os.version.major === 4;\n    var isTablet = isiPad || isAndroid3 || isAndroid4 && /mobile/i.test(userAgent) === true;\n    var isTouch = os.isiOS() || os.isAndroid();\n    var isPhone = isTouch && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview)\n    };\n  };\n\n  var detect$1 = function detect$1(candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function detectBrowser(browsers, userAgent) {\n    return detect$1(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function detectOs(oses, userAgent) {\n    return detect$1(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var UaString = {\n    detectBrowser: detectBrowser,\n    detectOs: detectOs\n  };\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function checkContains(target) {\n    return function (uastring) {\n      return contains$1(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function search(uastring) {\n      return contains$1(uastring, 'edge/') && contains$1(uastring, 'chrome') && contains$1(uastring, 'safari') && contains$1(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function search(uastring) {\n      return contains$1(uastring, 'chrome') && !contains$1(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function search(uastring) {\n      return contains$1(uastring, 'msie') || contains$1(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function search(uastring) {\n      return (contains$1(uastring, 'safari') || contains$1(uastring, 'mobile/')) && contains$1(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function search(uastring) {\n      return contains$1(uastring, 'iphone') || contains$1(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('os x'),\n    versionRegexes: [/.*?os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n\n  var detect$2 = function detect$2(userAgent) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = UaString.detectBrowser(browsers, userAgent).fold(Browser.unknown, Browser.nu);\n    var os = UaString.detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$2\n  };\n  var detect$3 = cached(function () {\n    var userAgent = domGlobals.navigator.userAgent;\n    return PlatformDetection.detect(userAgent);\n  });\n  var PlatformDetection$1 = {\n    detect: detect$3\n  };\n  var ELEMENT$1 = ELEMENT;\n  var DOCUMENT$1 = DOCUMENT;\n\n  var is = function is(element, selector) {\n    var dom = element.dom();\n\n    if (dom.nodeType !== ELEMENT$1) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function bypassSelector(dom) {\n    return dom.nodeType !== ELEMENT$1 && dom.nodeType !== DOCUMENT$1 || dom.childElementCount === 0;\n  };\n\n  var all = function all(selector, scope) {\n    var base = scope === undefined ? domGlobals.document : scope.dom();\n    return bypassSelector(base) ? [] : map(base.querySelectorAll(selector), Element.fromDom);\n  };\n\n  var one = function one(selector, scope) {\n    var base = scope === undefined ? domGlobals.document : scope.dom();\n    return bypassSelector(base) ? Option.none() : Option.from(base.querySelector(selector)).map(Element.fromDom);\n  };\n\n  var eq = function eq(e1, e2) {\n    return e1.dom() === e2.dom();\n  };\n\n  var regularContains = function regularContains(e1, e2) {\n    var d1 = e1.dom();\n    var d2 = e2.dom();\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function ieContains(e1, e2) {\n    return Node.documentPositionContainedBy(e1.dom(), e2.dom());\n  };\n\n  var browser = PlatformDetection$1.detect().browser;\n  var contains$2 = browser.isIE() ? ieContains : regularContains;\n  var is$1 = is;\n\n  var owner = function owner(element) {\n    return Element.fromDom(element.dom().ownerDocument);\n  };\n\n  var defaultView = function defaultView(element) {\n    return Element.fromDom(element.dom().ownerDocument.defaultView);\n  };\n\n  var parent = function parent(element) {\n    return Option.from(element.dom().parentNode).map(Element.fromDom);\n  };\n\n  var parents = function parents(element, isRoot) {\n    var stop = isFunction(isRoot) ? isRoot : never;\n    var dom = element.dom();\n    var ret = [];\n\n    while (dom.parentNode !== null && dom.parentNode !== undefined) {\n      var rawParent = dom.parentNode;\n      var p = Element.fromDom(rawParent);\n      ret.push(p);\n\n      if (stop(p) === true) {\n        break;\n      } else {\n        dom = rawParent;\n      }\n    }\n\n    return ret;\n  };\n\n  var prevSibling = function prevSibling(element) {\n    return Option.from(element.dom().previousSibling).map(Element.fromDom);\n  };\n\n  var nextSibling = function nextSibling(element) {\n    return Option.from(element.dom().nextSibling).map(Element.fromDom);\n  };\n\n  var children = function children(element) {\n    return map(element.dom().childNodes, Element.fromDom);\n  };\n\n  var child = function child(element, index) {\n    var cs = element.dom().childNodes;\n    return Option.from(cs[index]).map(Element.fromDom);\n  };\n\n  var firstChild = function firstChild(element) {\n    return child(element, 0);\n  };\n\n  var spot = Immutable('element', 'offset');\n\n  var before = function before(marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom().insertBefore(element.dom(), marker.dom());\n    });\n  };\n\n  var after = function after(marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append(v, element);\n      });\n    }, function (v) {\n      before(v, element);\n    });\n  };\n\n  var prepend = function prepend(parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append(parent, element);\n    }, function (v) {\n      parent.dom().insertBefore(element.dom(), v.dom());\n    });\n  };\n\n  var append = function append(parent, element) {\n    parent.dom().appendChild(element.dom());\n  };\n\n  var wrap = function wrap(element, wrapper) {\n    before(element, wrapper);\n    append(wrapper, element);\n  };\n\n  var before$1 = function before$1(marker, elements) {\n    each(elements, function (x) {\n      before(marker, x);\n    });\n  };\n\n  var after$1 = function after$1(marker, elements) {\n    each(elements, function (x, i) {\n      var e = i === 0 ? marker : elements[i - 1];\n      after(e, x);\n    });\n  };\n\n  var append$1 = function append$1(parent, elements) {\n    each(elements, function (x) {\n      append(parent, x);\n    });\n  };\n\n  var empty = function empty(element) {\n    element.dom().textContent = '';\n    each(children(element), function (rogue) {\n      remove$2(rogue);\n    });\n  };\n\n  var remove$2 = function remove$2(element) {\n    var dom = element.dom();\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function unwrap(wrapper) {\n    var children$1 = children(wrapper);\n\n    if (children$1.length > 0) {\n      before$1(wrapper, children$1);\n    }\n\n    remove$2(wrapper);\n  };\n\n  var dimension = Immutable('width', 'height');\n  var dimensions = Immutable('width', 'height');\n  var grid = Immutable('rows', 'columns');\n  var address = Immutable('row', 'column');\n  var coords = Immutable('x', 'y');\n  var detail = Immutable('element', 'rowspan', 'colspan');\n  var detailnew = Immutable('element', 'rowspan', 'colspan', 'isNew');\n  var extended = Immutable('element', 'rowspan', 'colspan', 'row', 'column');\n  var rowdata = Immutable('element', 'cells', 'section');\n  var elementnew = Immutable('element', 'isNew');\n  var rowdatanew = Immutable('element', 'cells', 'section', 'isNew');\n  var rowcells = Immutable('cells', 'section');\n  var rowdetails = Immutable('details', 'section');\n  var bounds = Immutable('startRow', 'startCol', 'finishRow', 'finishCol');\n\n  var ancestors = function ancestors(scope, predicate, isRoot) {\n    return filter(parents(scope, isRoot), predicate);\n  };\n\n  var children$1 = function children$1(scope, predicate) {\n    return filter(children(scope), predicate);\n  };\n\n  var descendants = function descendants(scope, predicate) {\n    var result = [];\n    each(children(scope), function (x) {\n      if (predicate(x)) {\n        result = result.concat([x]);\n      }\n\n      result = result.concat(descendants(x, predicate));\n    });\n    return result;\n  };\n\n  var ancestors$1 = function ancestors$1(scope, selector, isRoot) {\n    return ancestors(scope, function (e) {\n      return is(e, selector);\n    }, isRoot);\n  };\n\n  var children$2 = function children$2(scope, selector) {\n    return children$1(scope, function (e) {\n      return is(e, selector);\n    });\n  };\n\n  var descendants$1 = function descendants$1(scope, selector) {\n    return all(selector, scope);\n  };\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    return is(scope, a) ? Option.some(scope) : isFunction(isRoot) && isRoot(scope) ? Option.none() : ancestor(scope, a, isRoot);\n  }\n\n  var ancestor = function ancestor(scope, predicate, isRoot) {\n    var element = scope.dom();\n    var stop = isFunction(isRoot) ? isRoot : constant(false);\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = Element.fromDom(element);\n\n      if (predicate(el)) {\n        return Option.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Option.none();\n  };\n\n  var closest = function closest(scope, predicate, isRoot) {\n    var is = function is(s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor, scope, predicate, isRoot);\n  };\n\n  var child$1 = function child$1(scope, predicate) {\n    var pred = function pred(node) {\n      return predicate(Element.fromDom(node));\n    };\n\n    var result = find(scope.dom().childNodes, pred);\n    return result.map(Element.fromDom);\n  };\n\n  var descendant = function descendant(scope, predicate) {\n    var descend = function descend(node) {\n      for (var i = 0; i < node.childNodes.length; i++) {\n        var child_1 = Element.fromDom(node.childNodes[i]);\n\n        if (predicate(child_1)) {\n          return Option.some(child_1);\n        }\n\n        var res = descend(node.childNodes[i]);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Option.none();\n    };\n\n    return descend(scope.dom());\n  };\n\n  var ancestor$1 = function ancestor$1(scope, selector, isRoot) {\n    return ancestor(scope, function (e) {\n      return is(e, selector);\n    }, isRoot);\n  };\n\n  var child$2 = function child$2(scope, selector) {\n    return child$1(scope, function (e) {\n      return is(e, selector);\n    });\n  };\n\n  var descendant$1 = function descendant$1(scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$1 = function closest$1(scope, selector, isRoot) {\n    return ClosestOrAncestor(is, ancestor$1, scope, selector, isRoot);\n  };\n\n  var firstLayer = function firstLayer(scope, selector) {\n    return filterFirstLayer(scope, selector, constant(true));\n  };\n\n  var filterFirstLayer = function filterFirstLayer(scope, selector, predicate) {\n    return bind(children(scope), function (x) {\n      return is(x, selector) ? predicate(x) ? [x] : [] : filterFirstLayer(x, selector, predicate);\n    });\n  };\n\n  var LayerSelector = {\n    firstLayer: firstLayer,\n    filterFirstLayer: filterFirstLayer\n  };\n\n  var lookup = function lookup(tags, element, isRoot) {\n    if (isRoot === void 0) {\n      isRoot = never;\n    }\n\n    if (isRoot(element)) {\n      return Option.none();\n    }\n\n    if (contains(tags, name(element))) {\n      return Option.some(element);\n    }\n\n    var isRootOrUpperTable = function isRootOrUpperTable(elm) {\n      return is(elm, 'table') || isRoot(elm);\n    };\n\n    return ancestor$1(element, tags.join(','), isRootOrUpperTable);\n  };\n\n  var cell = function cell(element, isRoot) {\n    return lookup(['td', 'th'], element, isRoot);\n  };\n\n  var cells = function cells(ancestor) {\n    return LayerSelector.firstLayer(ancestor, 'th,td');\n  };\n\n  var notCell = function notCell(element, isRoot) {\n    return lookup(['caption', 'tr', 'tbody', 'tfoot', 'thead'], element, isRoot);\n  };\n\n  var neighbours = function neighbours(selector, element) {\n    return parent(element).map(function (parent) {\n      return children$2(parent, selector);\n    });\n  };\n\n  var neighbourCells = curry(neighbours, 'th,td');\n  var neighbourRows = curry(neighbours, 'tr');\n\n  var firstCell = function firstCell(ancestor) {\n    return descendant$1(ancestor, 'th,td');\n  };\n\n  var table = function table(element, isRoot) {\n    return closest$1(element, 'table', isRoot);\n  };\n\n  var row = function row(element, isRoot) {\n    return lookup(['tr'], element, isRoot);\n  };\n\n  var rows = function rows(ancestor) {\n    return LayerSelector.firstLayer(ancestor, 'tr');\n  };\n\n  var attr = function attr(element, property) {\n    return parseInt(get$1(element, property), 10);\n  };\n\n  var grid$1 = function grid$1(element, rowProp, colProp) {\n    var rowsCount = attr(element, rowProp);\n    var cols = attr(element, colProp);\n    return grid(rowsCount, cols);\n  };\n\n  var TableLookup = {\n    cell: cell,\n    firstCell: firstCell,\n    cells: cells,\n    neighbourCells: neighbourCells,\n    table: table,\n    row: row,\n    rows: rows,\n    notCell: notCell,\n    neighbourRows: neighbourRows,\n    attr: attr,\n    grid: grid$1\n  };\n\n  var fromTable = function fromTable(table) {\n    var rows = TableLookup.rows(table);\n    return map(rows, function (row) {\n      var element = row;\n      var parent$1 = parent(element);\n      var parentSection = parent$1.map(function (p) {\n        var parentName = name(p);\n        return parentName === 'tfoot' || parentName === 'thead' || parentName === 'tbody' ? parentName : 'tbody';\n      }).getOr('tbody');\n      var cells = map(TableLookup.cells(row), function (cell) {\n        var rowspan = has$1(cell, 'rowspan') ? parseInt(get$1(cell, 'rowspan'), 10) : 1;\n        var colspan = has$1(cell, 'colspan') ? parseInt(get$1(cell, 'colspan'), 10) : 1;\n        return detail(cell, rowspan, colspan);\n      });\n      return rowdata(element, cells, parentSection);\n    });\n  };\n\n  var fromPastedRows = function fromPastedRows(rows, example) {\n    return map(rows, function (row) {\n      var cells = map(TableLookup.cells(row), function (cell) {\n        var rowspan = has$1(cell, 'rowspan') ? parseInt(get$1(cell, 'rowspan'), 10) : 1;\n        var colspan = has$1(cell, 'colspan') ? parseInt(get$1(cell, 'colspan'), 10) : 1;\n        return detail(cell, rowspan, colspan);\n      });\n      return rowdata(row, cells, example.section());\n    });\n  };\n\n  var DetailsList = {\n    fromTable: fromTable,\n    fromPastedRows: fromPastedRows\n  };\n\n  var key = function key(row, column) {\n    return row + ',' + column;\n  };\n\n  var getAt = function getAt(warehouse, row, column) {\n    var raw = warehouse.access()[key(row, column)];\n    return raw !== undefined ? Option.some(raw) : Option.none();\n  };\n\n  var findItem = function findItem(warehouse, item, comparator) {\n    var filtered = filterItems(warehouse, function (detail) {\n      return comparator(item, detail.element());\n    });\n    return filtered.length > 0 ? Option.some(filtered[0]) : Option.none();\n  };\n\n  var filterItems = function filterItems(warehouse, predicate) {\n    var all = bind(warehouse.all(), function (r) {\n      return r.cells();\n    });\n    return filter(all, predicate);\n  };\n\n  var generate = function generate(list) {\n    var access = {};\n    var cells = [];\n    var maxRows = list.length;\n    var maxColumns = 0;\n    each(list, function (details, r) {\n      var currentRow = [];\n      each(details.cells(), function (detail) {\n        var start = 0;\n\n        while (access[key(r, start)] !== undefined) {\n          start++;\n        }\n\n        var current = extended(detail.element(), detail.rowspan(), detail.colspan(), r, start);\n\n        for (var i = 0; i < detail.colspan(); i++) {\n          for (var j = 0; j < detail.rowspan(); j++) {\n            var cr = r + j;\n            var cc = start + i;\n            var newpos = key(cr, cc);\n            access[newpos] = current;\n            maxColumns = Math.max(maxColumns, cc + 1);\n          }\n        }\n\n        currentRow.push(current);\n      });\n      cells.push(rowdata(details.element(), currentRow, details.section()));\n    });\n    var grid$1 = grid(maxRows, maxColumns);\n    return {\n      grid: constant(grid$1),\n      access: constant(access),\n      all: constant(cells)\n    };\n  };\n\n  var justCells = function justCells(warehouse) {\n    var rows = map(warehouse.all(), function (w) {\n      return w.cells();\n    });\n    return flatten(rows);\n  };\n\n  var Warehouse = {\n    generate: generate,\n    getAt: getAt,\n    findItem: findItem,\n    filterItems: filterItems,\n    justCells: justCells\n  };\n  var statsStruct = Immutable('minRow', 'minCol', 'maxRow', 'maxCol');\n\n  var findSelectedStats = function findSelectedStats(house, isSelected) {\n    var totalColumns = house.grid().columns();\n    var totalRows = house.grid().rows();\n    var minRow = totalRows;\n    var minCol = totalColumns;\n    var maxRow = 0;\n    var maxCol = 0;\n    each$1(house.access(), function (detail) {\n      if (isSelected(detail)) {\n        var startRow = detail.row();\n        var endRow = startRow + detail.rowspan() - 1;\n        var startCol = detail.column();\n        var endCol = startCol + detail.colspan() - 1;\n\n        if (startRow < minRow) {\n          minRow = startRow;\n        } else if (endRow > maxRow) {\n          maxRow = endRow;\n        }\n\n        if (startCol < minCol) {\n          minCol = startCol;\n        } else if (endCol > maxCol) {\n          maxCol = endCol;\n        }\n      }\n    });\n    return statsStruct(minRow, minCol, maxRow, maxCol);\n  };\n\n  var makeCell = function makeCell(list, seenSelected, rowIndex) {\n    var row = list[rowIndex].element();\n    var td = Element.fromTag('td');\n    append(td, Element.fromTag('br'));\n    var f = seenSelected ? append : prepend;\n    f(row, td);\n  };\n\n  var fillInGaps = function fillInGaps(list, house, stats, isSelected) {\n    var totalColumns = house.grid().columns();\n    var totalRows = house.grid().rows();\n\n    for (var i = 0; i < totalRows; i++) {\n      var seenSelected = false;\n\n      for (var j = 0; j < totalColumns; j++) {\n        if (!(i < stats.minRow() || i > stats.maxRow() || j < stats.minCol() || j > stats.maxCol())) {\n          var needCell = Warehouse.getAt(house, i, j).filter(isSelected).isNone();\n\n          if (needCell) {\n            makeCell(list, seenSelected, i);\n          } else {\n            seenSelected = true;\n          }\n        }\n      }\n    }\n  };\n\n  var clean = function clean(table, stats) {\n    var emptyRows = filter(LayerSelector.firstLayer(table, 'tr'), function (row) {\n      return row.dom().childElementCount === 0;\n    });\n    each(emptyRows, remove$2);\n\n    if (stats.minCol() === stats.maxCol() || stats.minRow() === stats.maxRow()) {\n      each(LayerSelector.firstLayer(table, 'th,td'), function (cell) {\n        remove(cell, 'rowspan');\n        remove(cell, 'colspan');\n      });\n    }\n\n    remove(table, 'width');\n    remove(table, 'height');\n    remove$1(table, 'width');\n    remove$1(table, 'height');\n  };\n\n  var extract = function extract(table, selectedSelector) {\n    var isSelected = function isSelected(detail) {\n      return is(detail.element(), selectedSelector);\n    };\n\n    var list = DetailsList.fromTable(table);\n    var house = Warehouse.generate(list);\n    var stats = findSelectedStats(house, isSelected);\n    var selector = 'th:not(' + selectedSelector + ')' + ',td:not(' + selectedSelector + ')';\n    var unselectedCells = LayerSelector.filterFirstLayer(table, 'th,td', function (cell) {\n      return is(cell, selector);\n    });\n    each(unselectedCells, remove$2);\n    fillInGaps(list, house, stats, isSelected);\n    clean(table, stats);\n    return table;\n  };\n\n  var CopySelected = {\n    extract: extract\n  };\n\n  function NodeValue(is, name) {\n    var get = function get(element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function getOption(element) {\n      return is(element) ? Option.from(element.dom().nodeValue) : Option.none();\n    };\n\n    var set = function set(element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom().nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  }\n\n  var api = NodeValue(isText, 'text');\n\n  var get$3 = function get$3(element) {\n    return api.get(element);\n  };\n\n  var getOption = function getOption(element) {\n    return api.getOption(element);\n  };\n\n  var set$2 = function set$2(element, value) {\n    api.set(element, value);\n  };\n\n  var getEnd = function getEnd(element) {\n    return name(element) === 'img' ? 1 : getOption(element).fold(function () {\n      return children(element).length;\n    }, function (v) {\n      return v.length;\n    });\n  };\n\n  var NBSP = '\\xA0';\n\n  var isTextNodeWithCursorPosition = function isTextNodeWithCursorPosition(el) {\n    return getOption(el).filter(function (text) {\n      return text.trim().length !== 0 || text.indexOf(NBSP) > -1;\n    }).isSome();\n  };\n\n  var elementsWithCursorPosition = ['img', 'br'];\n\n  var isCursorPosition = function isCursorPosition(elem) {\n    var hasCursorPosition = isTextNodeWithCursorPosition(elem);\n    return hasCursorPosition || contains(elementsWithCursorPosition, name(elem));\n  };\n\n  var first = function first(element) {\n    return descendant(element, isCursorPosition);\n  };\n\n  var last$1 = function last$1(element) {\n    return descendantRtl(element, isCursorPosition);\n  };\n\n  var descendantRtl = function descendantRtl(scope, predicate) {\n    var descend = function descend(element) {\n      var children$1 = children(element);\n\n      for (var i = children$1.length - 1; i >= 0; i--) {\n        var child = children$1[i];\n\n        if (predicate(child)) {\n          return Option.some(child);\n        }\n\n        var res = descend(child);\n\n        if (res.isSome()) {\n          return res;\n        }\n      }\n\n      return Option.none();\n    };\n\n    return descend(scope);\n  };\n\n  var clone$1 = function clone$1(original, isDeep) {\n    return Element.fromDom(original.dom().cloneNode(isDeep));\n  };\n\n  var shallow = function shallow(original) {\n    return clone$1(original, false);\n  };\n\n  var deep = function deep(original) {\n    return clone$1(original, true);\n  };\n\n  var shallowAs = function shallowAs(original, tag) {\n    var nu = Element.fromTag(tag);\n    var attributes = clone(original);\n    setAll(nu, attributes);\n    return nu;\n  };\n\n  var copy$1 = function copy$1(original, tag) {\n    var nu = shallowAs(original, tag);\n    var cloneChildren = children(deep(original));\n    append$1(nu, cloneChildren);\n    return nu;\n  };\n\n  var createCell = function createCell() {\n    var td = Element.fromTag('td');\n    append(td, Element.fromTag('br'));\n    return td;\n  };\n\n  var replace = function replace(cell, tag, attrs) {\n    var replica = copy$1(cell, tag);\n    each$1(attrs, function (v, k) {\n      if (v === null) {\n        remove(replica, k);\n      } else {\n        set(replica, k, v);\n      }\n    });\n    return replica;\n  };\n\n  var pasteReplace = function pasteReplace(cell) {\n    return cell;\n  };\n\n  var newRow = function newRow(doc) {\n    return function () {\n      return Element.fromTag('tr', doc.dom());\n    };\n  };\n\n  var cloneFormats = function cloneFormats(oldCell, newCell, formats) {\n    var first$1 = first(oldCell);\n    return first$1.map(function (firstText) {\n      var formatSelector = formats.join(',');\n      var parents = ancestors$1(firstText, formatSelector, function (element) {\n        return eq(element, oldCell);\n      });\n      return foldr(parents, function (last, parent) {\n        var clonedFormat = shallow(parent);\n        remove(clonedFormat, 'contenteditable');\n        append(last, clonedFormat);\n        return clonedFormat;\n      }, newCell);\n    }).getOr(newCell);\n  };\n\n  var cellOperations = function cellOperations(mutate, doc, formatsToClone) {\n    var newCell = function newCell(prev) {\n      var docu = owner(prev.element());\n      var td = Element.fromTag(name(prev.element()), docu.dom());\n      var formats = formatsToClone.getOr(['strong', 'em', 'b', 'i', 'span', 'font', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div']);\n      var lastNode = formats.length > 0 ? cloneFormats(prev.element(), td, formats) : td;\n      append(lastNode, Element.fromTag('br'));\n      copy(prev.element(), td);\n      remove$1(td, 'height');\n\n      if (prev.colspan() !== 1) {\n        remove$1(prev.element(), 'width');\n      }\n\n      mutate(prev.element(), td);\n      return td;\n    };\n\n    return {\n      row: newRow(doc),\n      cell: newCell,\n      replace: replace,\n      gap: createCell\n    };\n  };\n\n  var paste = function paste(doc) {\n    return {\n      row: newRow(doc),\n      cell: createCell,\n      replace: pasteReplace,\n      gap: createCell\n    };\n  };\n\n  var TableFill = {\n    cellOperations: cellOperations,\n    paste: paste\n  };\n\n  var fromHtml$1 = function fromHtml$1(html, scope) {\n    var doc = scope || domGlobals.document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children(Element.fromDom(div));\n  };\n\n  var inSelection = function inSelection(bounds, detail) {\n    var leftEdge = detail.column();\n    var rightEdge = detail.column() + detail.colspan() - 1;\n    var topEdge = detail.row();\n    var bottomEdge = detail.row() + detail.rowspan() - 1;\n    return leftEdge <= bounds.finishCol() && rightEdge >= bounds.startCol() && topEdge <= bounds.finishRow() && bottomEdge >= bounds.startRow();\n  };\n\n  var isWithin = function isWithin(bounds, detail) {\n    return detail.column() >= bounds.startCol() && detail.column() + detail.colspan() - 1 <= bounds.finishCol() && detail.row() >= bounds.startRow() && detail.row() + detail.rowspan() - 1 <= bounds.finishRow();\n  };\n\n  var isRectangular = function isRectangular(warehouse, bounds) {\n    var isRect = true;\n    var detailIsWithin = curry(isWithin, bounds);\n\n    for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n      for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n        isRect = isRect && Warehouse.getAt(warehouse, i, j).exists(detailIsWithin);\n      }\n    }\n\n    return isRect ? Option.some(bounds) : Option.none();\n  };\n\n  var CellBounds = {\n    inSelection: inSelection,\n    isWithin: isWithin,\n    isRectangular: isRectangular\n  };\n\n  var getBounds = function getBounds(detailA, detailB) {\n    return bounds(Math.min(detailA.row(), detailB.row()), Math.min(detailA.column(), detailB.column()), Math.max(detailA.row() + detailA.rowspan() - 1, detailB.row() + detailB.rowspan() - 1), Math.max(detailA.column() + detailA.colspan() - 1, detailB.column() + detailB.colspan() - 1));\n  };\n\n  var getAnyBox = function getAnyBox(warehouse, startCell, finishCell) {\n    var startCoords = Warehouse.findItem(warehouse, startCell, eq);\n    var finishCoords = Warehouse.findItem(warehouse, finishCell, eq);\n    return startCoords.bind(function (sc) {\n      return finishCoords.map(function (fc) {\n        return getBounds(sc, fc);\n      });\n    });\n  };\n\n  var getBox = function getBox(warehouse, startCell, finishCell) {\n    return getAnyBox(warehouse, startCell, finishCell).bind(function (bounds) {\n      return CellBounds.isRectangular(warehouse, bounds);\n    });\n  };\n\n  var CellGroup = {\n    getAnyBox: getAnyBox,\n    getBox: getBox\n  };\n\n  var moveBy = function moveBy(warehouse, cell, row, column) {\n    return Warehouse.findItem(warehouse, cell, eq).bind(function (detail) {\n      var startRow = row > 0 ? detail.row() + detail.rowspan() - 1 : detail.row();\n      var startCol = column > 0 ? detail.column() + detail.colspan() - 1 : detail.column();\n      var dest = Warehouse.getAt(warehouse, startRow + row, startCol + column);\n      return dest.map(function (d) {\n        return d.element();\n      });\n    });\n  };\n\n  var intercepts = function intercepts(warehouse, start, finish) {\n    return CellGroup.getAnyBox(warehouse, start, finish).map(function (bounds) {\n      var inside = Warehouse.filterItems(warehouse, curry(CellBounds.inSelection, bounds));\n      return map(inside, function (detail) {\n        return detail.element();\n      });\n    });\n  };\n\n  var parentCell = function parentCell(warehouse, innerCell) {\n    var isContainedBy = function isContainedBy(c1, c2) {\n      return contains$2(c2, c1);\n    };\n\n    return Warehouse.findItem(warehouse, innerCell, isContainedBy).map(function (detail) {\n      return detail.element();\n    });\n  };\n\n  var CellFinder = {\n    moveBy: moveBy,\n    intercepts: intercepts,\n    parentCell: parentCell\n  };\n\n  var moveBy$1 = function moveBy$1(cell, deltaRow, deltaColumn) {\n    return TableLookup.table(cell).bind(function (table) {\n      var warehouse = getWarehouse(table);\n      return CellFinder.moveBy(warehouse, cell, deltaRow, deltaColumn);\n    });\n  };\n\n  var intercepts$1 = function intercepts$1(table, first, last) {\n    var warehouse = getWarehouse(table);\n    return CellFinder.intercepts(warehouse, first, last);\n  };\n\n  var nestedIntercepts = function nestedIntercepts(table, first, firstTable, last, lastTable) {\n    var warehouse = getWarehouse(table);\n    var optStartCell = eq(table, firstTable) ? Option.some(first) : CellFinder.parentCell(warehouse, first);\n    var optLastCell = eq(table, lastTable) ? Option.some(last) : CellFinder.parentCell(warehouse, last);\n    return optStartCell.bind(function (startCell) {\n      return optLastCell.bind(function (lastCell) {\n        return CellFinder.intercepts(warehouse, startCell, lastCell);\n      });\n    });\n  };\n\n  var getBox$1 = function getBox$1(table, first, last) {\n    var warehouse = getWarehouse(table);\n    return CellGroup.getBox(warehouse, first, last);\n  };\n\n  var getWarehouse = function getWarehouse(table) {\n    var list = DetailsList.fromTable(table);\n    return Warehouse.generate(list);\n  };\n\n  var TablePositions = {\n    moveBy: moveBy$1,\n    intercepts: intercepts$1,\n    nestedIntercepts: nestedIntercepts,\n    getBox: getBox$1\n  };\n  var TagBoundaries = ['body', 'p', 'div', 'article', 'aside', 'figcaption', 'figure', 'footer', 'header', 'nav', 'section', 'ol', 'ul', 'li', 'table', 'thead', 'tbody', 'tfoot', 'caption', 'tr', 'td', 'th', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'address'];\n\n  function DomUniverse() {\n    var clone$1 = function clone$1(element) {\n      return Element.fromDom(element.dom().cloneNode(false));\n    };\n\n    var document = function document(element) {\n      return element.dom().ownerDocument;\n    };\n\n    var isBoundary = function isBoundary(element) {\n      if (!isElement(element)) {\n        return false;\n      }\n\n      if (name(element) === 'body') {\n        return true;\n      }\n\n      return contains(TagBoundaries, name(element));\n    };\n\n    var isEmptyTag = function isEmptyTag(element) {\n      if (!isElement(element)) {\n        return false;\n      }\n\n      return contains(['br', 'img', 'hr', 'input'], name(element));\n    };\n\n    var comparePosition = function comparePosition(element, other) {\n      return element.dom().compareDocumentPosition(other.dom());\n    };\n\n    var copyAttributesTo = function copyAttributesTo(source, destination) {\n      var as = clone(source);\n      setAll(destination, as);\n    };\n\n    return {\n      up: constant({\n        selector: ancestor$1,\n        closest: closest$1,\n        predicate: ancestor,\n        all: parents\n      }),\n      down: constant({\n        selector: descendants$1,\n        predicate: descendants\n      }),\n      styles: constant({\n        get: get$2,\n        getRaw: getRaw,\n        set: set$1,\n        remove: remove$1\n      }),\n      attrs: constant({\n        get: get$1,\n        set: set,\n        remove: remove,\n        copyTo: copyAttributesTo\n      }),\n      insert: constant({\n        before: before,\n        after: after,\n        afterAll: after$1,\n        append: append,\n        appendAll: append$1,\n        prepend: prepend,\n        wrap: wrap\n      }),\n      remove: constant({\n        unwrap: unwrap,\n        remove: remove$2\n      }),\n      create: constant({\n        nu: Element.fromTag,\n        clone: clone$1,\n        text: Element.fromText\n      }),\n      query: constant({\n        comparePosition: comparePosition,\n        prevSibling: prevSibling,\n        nextSibling: nextSibling\n      }),\n      property: constant({\n        children: children,\n        name: name,\n        parent: parent,\n        document: document,\n        isText: isText,\n        isComment: isComment,\n        isElement: isElement,\n        getText: get$3,\n        setText: set$2,\n        isBoundary: isBoundary,\n        isEmptyTag: isEmptyTag\n      }),\n      eq: eq,\n      is: is$1\n    };\n  }\n\n  var leftRight = Immutable('left', 'right');\n  var brokenPath = Immutable('first', 'second', 'splits');\n\n  var bisect = function bisect(universe, parent, child) {\n    var children = universe.property().children(parent);\n    var index = findIndex(children, curry(universe.eq, child));\n    return index.map(function (ind) {\n      return {\n        before: constant(children.slice(0, ind)),\n        after: constant(children.slice(ind + 1))\n      };\n    });\n  };\n\n  var breakToRight = function breakToRight(universe, parent, child) {\n    return bisect(universe, parent, child).map(function (parts) {\n      var second = universe.create().clone(parent);\n      universe.insert().appendAll(second, parts.after());\n      universe.insert().after(parent, second);\n      return leftRight(parent, second);\n    });\n  };\n\n  var breakToLeft = function breakToLeft(universe, parent, child) {\n    return bisect(universe, parent, child).map(function (parts) {\n      var prior = universe.create().clone(parent);\n      universe.insert().appendAll(prior, parts.before().concat([child]));\n      universe.insert().appendAll(parent, parts.after());\n      universe.insert().before(parent, prior);\n      return leftRight(prior, parent);\n    });\n  };\n\n  var breakPath = function breakPath(universe, item, isTop, breaker) {\n    var next = function next(child, group, splits) {\n      var fallback = brokenPath(child, Option.none(), splits);\n\n      if (isTop(child)) {\n        return brokenPath(child, group, splits);\n      } else {\n        return universe.property().parent(child).bind(function (parent) {\n          return breaker(universe, parent, child).map(function (breakage) {\n            var extra = [{\n              first: breakage.left,\n              second: breakage.right\n            }];\n            var nextChild = isTop(parent) ? parent : breakage.left();\n            return next(nextChild, Option.some(breakage.right()), splits.concat(extra));\n          });\n        }).getOr(fallback);\n      }\n    };\n\n    return next(item, Option.none(), []);\n  };\n\n  var all$1 = function all$1(universe, look, elements, f) {\n    var head = elements[0];\n    var tail = elements.slice(1);\n    return f(universe, look, head, tail);\n  };\n\n  var oneAll = function oneAll(universe, look, elements) {\n    return elements.length > 0 ? all$1(universe, look, elements, unsafeOne) : Option.none();\n  };\n\n  var unsafeOne = function unsafeOne(universe, look, head, tail) {\n    var start = look(universe, head);\n    return foldr(tail, function (b, a) {\n      var current = look(universe, a);\n      return commonElement(universe, b, current);\n    }, start);\n  };\n\n  var commonElement = function commonElement(universe, start, end) {\n    return start.bind(function (s) {\n      return end.filter(curry(universe.eq, s));\n    });\n  };\n\n  var eq$1 = function eq$1(universe, item) {\n    return curry(universe.eq, item);\n  };\n\n  var unsafeSubset = function unsafeSubset(universe, common, ps1, ps2) {\n    var children = universe.property().children(common);\n\n    if (universe.eq(common, ps1[0])) {\n      return Option.some([ps1[0]]);\n    }\n\n    if (universe.eq(common, ps2[0])) {\n      return Option.some([ps2[0]]);\n    }\n\n    var finder = function finder(ps) {\n      var topDown = reverse(ps);\n      var index = findIndex(topDown, eq$1(universe, common)).getOr(-1);\n      var item = index < topDown.length - 1 ? topDown[index + 1] : topDown[index];\n      return findIndex(children, eq$1(universe, item));\n    };\n\n    var startIndex = finder(ps1);\n    var endIndex = finder(ps2);\n    return startIndex.bind(function (sIndex) {\n      return endIndex.map(function (eIndex) {\n        var first = Math.min(sIndex, eIndex);\n        var last = Math.max(sIndex, eIndex);\n        return children.slice(first, last + 1);\n      });\n    });\n  };\n\n  var ancestors$2 = function ancestors$2(universe, start, end, isRoot) {\n    if (isRoot === void 0) {\n      isRoot = never;\n    }\n\n    var ps1 = [start].concat(universe.up().all(start));\n    var ps2 = [end].concat(universe.up().all(end));\n\n    var prune = function prune(path) {\n      var index = findIndex(path, isRoot);\n      return index.fold(function () {\n        return path;\n      }, function (ind) {\n        return path.slice(0, ind + 1);\n      });\n    };\n\n    var pruned1 = prune(ps1);\n    var pruned2 = prune(ps2);\n    var shared = find(pruned1, function (x) {\n      return exists(pruned2, eq$1(universe, x));\n    });\n    return {\n      firstpath: constant(pruned1),\n      secondpath: constant(pruned2),\n      shared: constant(shared)\n    };\n  };\n\n  var subset = function subset(universe, start, end) {\n    var ancs = ancestors$2(universe, start, end);\n    return ancs.shared().bind(function (shared) {\n      return unsafeSubset(universe, shared, ancs.firstpath(), ancs.secondpath());\n    });\n  };\n\n  var SubsetFn = {\n    subset: subset,\n    ancestors: ancestors$2\n  };\n  var sharedOne = oneAll;\n  var subset$1 = SubsetFn.subset;\n  var ancestors$3 = SubsetFn.ancestors;\n  var breakToLeft$1 = breakToLeft;\n  var breakToRight$1 = breakToRight;\n  var breakPath$1 = breakPath;\n  var Parent = {\n    sharedOne: sharedOne,\n    subset: subset$1,\n    ancestors: ancestors$3,\n    breakToLeft: breakToLeft$1,\n    breakToRight: breakToRight$1,\n    breakPath: breakPath$1\n  };\n  var universe = DomUniverse();\n\n  var sharedOne$1 = function sharedOne$1(look, elements) {\n    return Parent.sharedOne(universe, function (_universe, element) {\n      return look(element);\n    }, elements);\n  };\n\n  var subset$2 = function subset$2(start, finish) {\n    return Parent.subset(universe, start, finish);\n  };\n\n  var ancestors$4 = function ancestors$4(start, finish, isRoot) {\n    return Parent.ancestors(universe, start, finish, isRoot);\n  };\n\n  var breakToLeft$2 = function breakToLeft$2(parent, child) {\n    return Parent.breakToLeft(universe, parent, child);\n  };\n\n  var breakToRight$2 = function breakToRight$2(parent, child) {\n    return Parent.breakToRight(universe, parent, child);\n  };\n\n  var breakPath$2 = function breakPath$2(child, isTop, breaker) {\n    return Parent.breakPath(universe, child, isTop, function (u, p, c) {\n      return breaker(p, c);\n    });\n  };\n\n  var DomParent = {\n    sharedOne: sharedOne$1,\n    subset: subset$2,\n    ancestors: ancestors$4,\n    breakToLeft: breakToLeft$2,\n    breakToRight: breakToRight$2,\n    breakPath: breakPath$2\n  };\n  var create = MixedBag(['boxes', 'start', 'finish'], []);\n  var Identified = {\n    create: create\n  };\n\n  var lookupTable = function lookupTable(container) {\n    return ancestor$1(container, 'table');\n  };\n\n  var identify = function identify(start, finish, isRoot) {\n    var getIsRoot = function getIsRoot(rootTable) {\n      return function (element) {\n        return isRoot !== undefined && isRoot(element) || eq(element, rootTable);\n      };\n    };\n\n    if (eq(start, finish)) {\n      return Option.some(Identified.create({\n        boxes: Option.some([start]),\n        start: start,\n        finish: finish\n      }));\n    } else {\n      return lookupTable(start).bind(function (startTable) {\n        return lookupTable(finish).bind(function (finishTable) {\n          if (eq(startTable, finishTable)) {\n            return Option.some(Identified.create({\n              boxes: TablePositions.intercepts(startTable, start, finish),\n              start: start,\n              finish: finish\n            }));\n          } else if (contains$2(startTable, finishTable)) {\n            var ancestorCells = ancestors$1(finish, 'td,th', getIsRoot(startTable));\n            var finishCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : finish;\n            return Option.some(Identified.create({\n              boxes: TablePositions.nestedIntercepts(startTable, start, startTable, finish, finishTable),\n              start: start,\n              finish: finishCell\n            }));\n          } else if (contains$2(finishTable, startTable)) {\n            var ancestorCells = ancestors$1(start, 'td,th', getIsRoot(finishTable));\n            var startCell = ancestorCells.length > 0 ? ancestorCells[ancestorCells.length - 1] : start;\n            return Option.some(Identified.create({\n              boxes: TablePositions.nestedIntercepts(finishTable, start, startTable, finish, finishTable),\n              start: start,\n              finish: startCell\n            }));\n          } else {\n            return DomParent.ancestors(start, finish).shared().bind(function (lca) {\n              return closest$1(lca, 'table', isRoot).bind(function (lcaTable) {\n                var finishAncestorCells = ancestors$1(finish, 'td,th', getIsRoot(lcaTable));\n                var finishCell = finishAncestorCells.length > 0 ? finishAncestorCells[finishAncestorCells.length - 1] : finish;\n                var startAncestorCells = ancestors$1(start, 'td,th', getIsRoot(lcaTable));\n                var startCell = startAncestorCells.length > 0 ? startAncestorCells[startAncestorCells.length - 1] : start;\n                return Option.some(Identified.create({\n                  boxes: TablePositions.nestedIntercepts(lcaTable, start, startTable, finish, finishTable),\n                  start: startCell,\n                  finish: finishCell\n                }));\n              });\n            });\n          }\n        });\n      });\n    }\n  };\n\n  var retrieve = function retrieve(container, selector) {\n    var sels = descendants$1(container, selector);\n    return sels.length > 0 ? Option.some(sels) : Option.none();\n  };\n\n  var getLast = function getLast(boxes, lastSelectedSelector) {\n    return find(boxes, function (box) {\n      return is(box, lastSelectedSelector);\n    });\n  };\n\n  var getEdges = function getEdges(container, firstSelectedSelector, lastSelectedSelector) {\n    return descendant$1(container, firstSelectedSelector).bind(function (first) {\n      return descendant$1(container, lastSelectedSelector).bind(function (last) {\n        return DomParent.sharedOne(lookupTable, [first, last]).map(function (tbl) {\n          return {\n            first: constant(first),\n            last: constant(last),\n            table: constant(tbl)\n          };\n        });\n      });\n    });\n  };\n\n  var expandTo = function expandTo(finish, firstSelectedSelector) {\n    return ancestor$1(finish, 'table').bind(function (table) {\n      return descendant$1(table, firstSelectedSelector).bind(function (start) {\n        return identify(start, finish).bind(function (identified) {\n          return identified.boxes().map(function (boxes) {\n            return {\n              boxes: constant(boxes),\n              start: constant(identified.start()),\n              finish: constant(identified.finish())\n            };\n          });\n        });\n      });\n    });\n  };\n\n  var shiftSelection = function shiftSelection(boxes, deltaRow, deltaColumn, firstSelectedSelector, lastSelectedSelector) {\n    return getLast(boxes, lastSelectedSelector).bind(function (last) {\n      return TablePositions.moveBy(last, deltaRow, deltaColumn).bind(function (finish) {\n        return expandTo(finish, firstSelectedSelector);\n      });\n    });\n  };\n\n  var CellSelection = {\n    identify: identify,\n    retrieve: retrieve,\n    shiftSelection: shiftSelection,\n    getEdges: getEdges\n  };\n\n  var retrieve$1 = function retrieve$1(container, selector) {\n    return CellSelection.retrieve(container, selector);\n  };\n\n  var retrieveBox = function retrieveBox(container, firstSelectedSelector, lastSelectedSelector) {\n    return CellSelection.getEdges(container, firstSelectedSelector, lastSelectedSelector).bind(function (edges) {\n      var isRoot = function isRoot(ancestor) {\n        return eq(container, ancestor);\n      };\n\n      var firstAncestor = ancestor$1(edges.first(), 'thead,tfoot,tbody,table', isRoot);\n      var lastAncestor = ancestor$1(edges.last(), 'thead,tfoot,tbody,table', isRoot);\n      return firstAncestor.bind(function (fA) {\n        return lastAncestor.bind(function (lA) {\n          return eq(fA, lA) ? TablePositions.getBox(edges.table(), edges.first(), edges.last()) : Option.none();\n        });\n      });\n    });\n  };\n\n  var TableSelection = {\n    retrieve: retrieve$1,\n    retrieveBox: retrieveBox\n  };\n  var selected = 'data-mce-selected';\n  var selectedSelector = 'td[' + selected + '],th[' + selected + ']';\n  var attributeSelector = '[' + selected + ']';\n  var firstSelected = 'data-mce-first-selected';\n  var firstSelectedSelector = 'td[' + firstSelected + '],th[' + firstSelected + ']';\n  var lastSelected = 'data-mce-last-selected';\n  var lastSelectedSelector = 'td[' + lastSelected + '],th[' + lastSelected + ']';\n  var Ephemera = {\n    selected: constant(selected),\n    selectedSelector: constant(selectedSelector),\n    attributeSelector: constant(attributeSelector),\n    firstSelected: constant(firstSelected),\n    firstSelectedSelector: constant(firstSelectedSelector),\n    lastSelected: constant(lastSelected),\n    lastSelectedSelector: constant(lastSelectedSelector)\n  };\n\n  var generate$1 = function generate$1(cases) {\n    if (!isArray(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var argLength = arguments.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var args = new Array(argLength);\n\n        for (var i = 0; i < args.length; i++) {\n          args[i] = arguments[i];\n        }\n\n        var match = function match(branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function fold() {\n            if (arguments.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + arguments.length);\n            }\n\n            var target = arguments[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function log(label) {\n            domGlobals.console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate$1\n  };\n  var type$1 = Adt.generate([{\n    none: []\n  }, {\n    multiple: ['elements']\n  }, {\n    single: ['selection']\n  }]);\n\n  var cata = function cata(subject, onNone, onMultiple, onSingle) {\n    return subject.fold(onNone, onMultiple, onSingle);\n  };\n\n  var SelectionTypes = {\n    cata: cata,\n    none: type$1.none,\n    multiple: type$1.multiple,\n    single: type$1.single\n  };\n\n  var selection = function selection(cell, selections) {\n    return SelectionTypes.cata(selections.get(), constant([]), identity, constant([cell]));\n  };\n\n  var unmergable = function unmergable(cell, selections) {\n    var hasSpan = function hasSpan(elem) {\n      return has$1(elem, 'rowspan') && parseInt(get$1(elem, 'rowspan'), 10) > 1 || has$1(elem, 'colspan') && parseInt(get$1(elem, 'colspan'), 10) > 1;\n    };\n\n    var candidates = selection(cell, selections);\n    return candidates.length > 0 && forall(candidates, hasSpan) ? Option.some(candidates) : Option.none();\n  };\n\n  var mergable = function mergable(table, selections) {\n    return SelectionTypes.cata(selections.get(), Option.none, function (cells, _env) {\n      if (cells.length === 0) {\n        return Option.none();\n      }\n\n      return TableSelection.retrieveBox(table, Ephemera.firstSelectedSelector(), Ephemera.lastSelectedSelector()).bind(function (bounds) {\n        return cells.length > 1 ? Option.some({\n          bounds: constant(bounds),\n          cells: constant(cells)\n        }) : Option.none();\n      });\n    }, Option.none);\n  };\n\n  var CellOperations = {\n    mergable: mergable,\n    unmergable: unmergable,\n    selection: selection\n  };\n\n  var noMenu = function noMenu(cell) {\n    return {\n      element: constant(cell),\n      mergable: Option.none,\n      unmergable: Option.none,\n      selection: constant([cell])\n    };\n  };\n\n  var forMenu = function forMenu(selections, table, cell) {\n    return {\n      element: constant(cell),\n      mergable: constant(CellOperations.mergable(table, selections)),\n      unmergable: constant(CellOperations.unmergable(cell, selections)),\n      selection: constant(CellOperations.selection(cell, selections))\n    };\n  };\n\n  var notCell$1 = function notCell$1(element) {\n    return noMenu(element);\n  };\n\n  var paste$1 = Immutable('element', 'clipboard', 'generators');\n\n  var pasteRows = function pasteRows(selections, table, cell, clipboard, generators) {\n    return {\n      element: constant(cell),\n      mergable: Option.none,\n      unmergable: Option.none,\n      selection: constant(CellOperations.selection(cell, selections)),\n      clipboard: constant(clipboard),\n      generators: constant(generators)\n    };\n  };\n\n  var TableTargets = {\n    noMenu: noMenu,\n    forMenu: forMenu,\n    notCell: notCell$1,\n    paste: paste$1,\n    pasteRows: pasteRows\n  };\n\n  var extractSelected = function extractSelected(cells) {\n    return TableLookup.table(cells[0]).map(deep).map(function (replica) {\n      return [CopySelected.extract(replica, Ephemera.attributeSelector())];\n    });\n  };\n\n  var serializeElements = function serializeElements(editor, elements) {\n    return map(elements, function (elm) {\n      return editor.selection.serializer.serialize(elm.dom(), {});\n    }).join('');\n  };\n\n  var getTextContent = function getTextContent(elements) {\n    return map(elements, function (element) {\n      return element.dom().innerText;\n    }).join('');\n  };\n\n  var registerEvents = function registerEvents(editor, selections, actions, cellSelection) {\n    editor.on('BeforeGetContent', function (e) {\n      var multiCellContext = function multiCellContext(cells) {\n        e.preventDefault();\n        extractSelected(cells).each(function (elements) {\n          e.content = e.format === 'text' ? getTextContent(elements) : serializeElements(editor, elements);\n        });\n      };\n\n      if (e.selection === true) {\n        SelectionTypes.cata(selections.get(), noop, multiCellContext, noop);\n      }\n    });\n    editor.on('BeforeSetContent', function (e) {\n      if (e.selection === true && e.paste === true) {\n        var cellOpt = Option.from(editor.dom.getParent(editor.selection.getStart(), 'th,td'));\n        cellOpt.each(function (domCell) {\n          var cell = Element.fromDom(domCell);\n          TableLookup.table(cell).each(function (table) {\n            var elements = filter(fromHtml$1(e.content), function (content) {\n              return name(content) !== 'meta';\n            });\n\n            if (elements.length === 1 && name(elements[0]) === 'table') {\n              e.preventDefault();\n              var doc = Element.fromDom(editor.getDoc());\n              var generators = TableFill.paste(doc);\n              var targets = TableTargets.paste(cell, elements[0], generators);\n              actions.pasteCells(table, targets).each(function (rng) {\n                editor.selection.setRng(rng);\n                editor.focus();\n                cellSelection.clear(table);\n              });\n            }\n          });\n        });\n      }\n    });\n  };\n\n  var Clipboard = {\n    registerEvents: registerEvents\n  };\n\n  function Dimension(name, getOffset) {\n    var set = function set(element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom();\n\n      if (isSupported(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function get(element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$2(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function aggregate(element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$2(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function max(element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  }\n\n  var api$1 = Dimension('height', function (element) {\n    var dom = element.dom();\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$4 = function get$4(element) {\n    return api$1.get(element);\n  };\n\n  var getOuter = function getOuter(element) {\n    return api$1.getOuter(element);\n  };\n\n  var api$2 = Dimension('width', function (element) {\n    return element.dom().offsetWidth;\n  });\n\n  var get$5 = function get$5(element) {\n    return api$2.get(element);\n  };\n\n  var getOuter$1 = function getOuter$1(element) {\n    return api$2.getOuter(element);\n  };\n\n  var platform = PlatformDetection$1.detect();\n\n  var needManualCalc = function needManualCalc() {\n    return platform.browser.isIE() || platform.browser.isEdge();\n  };\n\n  var toNumber = function toNumber(px, fallback) {\n    var num = parseFloat(px);\n    return isNaN(num) ? fallback : num;\n  };\n\n  var getProp = function getProp(elm, name, fallback) {\n    return toNumber(get$2(elm, name), fallback);\n  };\n\n  var getCalculatedHeight = function getCalculatedHeight(cell) {\n    var paddingTop = getProp(cell, 'padding-top', 0);\n    var paddingBottom = getProp(cell, 'padding-bottom', 0);\n    var borderTop = getProp(cell, 'border-top-width', 0);\n    var borderBottom = getProp(cell, 'border-bottom-width', 0);\n    var height = cell.dom().getBoundingClientRect().height;\n    var boxSizing = get$2(cell, 'box-sizing');\n    var borders = borderTop + borderBottom;\n    return boxSizing === 'border-box' ? height : height - paddingTop - paddingBottom - borders;\n  };\n\n  var getWidth = function getWidth(cell) {\n    return getProp(cell, 'width', get$5(cell));\n  };\n\n  var getHeight = function getHeight(cell) {\n    return needManualCalc() ? getCalculatedHeight(cell) : getProp(cell, 'height', get$4(cell));\n  };\n\n  var RuntimeSize = {\n    getWidth: getWidth,\n    getHeight: getHeight\n  };\n  var genericSizeRegex = /(\\d+(\\.\\d+)?)(\\w|%)*/;\n  var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n  var pixelBasedSizeRegex = /(\\d+(\\.\\d+)?)px|em/;\n\n  var setPixelWidth = function setPixelWidth(cell, amount) {\n    set$1(cell, 'width', amount + 'px');\n  };\n\n  var setPercentageWidth = function setPercentageWidth(cell, amount) {\n    set$1(cell, 'width', amount + '%');\n  };\n\n  var setHeight = function setHeight(cell, amount) {\n    set$1(cell, 'height', amount + 'px');\n  };\n\n  var getHeightValue = function getHeightValue(cell) {\n    return getRaw(cell, 'height').getOrThunk(function () {\n      return RuntimeSize.getHeight(cell) + 'px';\n    });\n  };\n\n  var convert = function convert(cell, number, getter, setter) {\n    var newSize = TableLookup.table(cell).map(function (table) {\n      var total = getter(table);\n      return Math.floor(number / 100 * total);\n    }).getOr(number);\n    setter(cell, newSize);\n    return newSize;\n  };\n\n  var normalizePixelSize = function normalizePixelSize(value, cell, getter, setter) {\n    var number = parseInt(value, 10);\n    return endsWith(value, '%') && name(cell) !== 'table' ? convert(cell, number, getter, setter) : number;\n  };\n\n  var getTotalHeight = function getTotalHeight(cell) {\n    var value = getHeightValue(cell);\n\n    if (!value) {\n      return get$4(cell);\n    }\n\n    return normalizePixelSize(value, cell, get$4, setHeight);\n  };\n\n  var get$6 = function get$6(cell, type, f) {\n    var v = f(cell);\n    var span = getSpan(cell, type);\n    return v / span;\n  };\n\n  var getSpan = function getSpan(cell, type) {\n    return has$1(cell, type) ? parseInt(get$1(cell, type), 10) : 1;\n  };\n\n  var getRawWidth = function getRawWidth(element) {\n    var cssWidth = getRaw(element, 'width');\n    return cssWidth.fold(function () {\n      return Option.from(get$1(element, 'width'));\n    }, function (width) {\n      return Option.some(width);\n    });\n  };\n\n  var normalizePercentageWidth = function normalizePercentageWidth(cellWidth, tableSize) {\n    return cellWidth / tableSize.pixelWidth() * 100;\n  };\n\n  var choosePercentageSize = function choosePercentageSize(element, width, tableSize) {\n    var percentMatch = percentageBasedSizeRegex.exec(width);\n\n    if (percentMatch !== null) {\n      return parseFloat(percentMatch[1]);\n    } else {\n      var intWidth = get$5(element);\n      return normalizePercentageWidth(intWidth, tableSize);\n    }\n  };\n\n  var getPercentageWidth = function getPercentageWidth(cell, tableSize) {\n    var width = getRawWidth(cell);\n    return width.fold(function () {\n      var intWidth = get$5(cell);\n      return normalizePercentageWidth(intWidth, tableSize);\n    }, function (w) {\n      return choosePercentageSize(cell, w, tableSize);\n    });\n  };\n\n  var normalizePixelWidth = function normalizePixelWidth(cellWidth, tableSize) {\n    return cellWidth / 100 * tableSize.pixelWidth();\n  };\n\n  var choosePixelSize = function choosePixelSize(element, width, tableSize) {\n    var pixelMatch = pixelBasedSizeRegex.exec(width);\n\n    if (pixelMatch !== null) {\n      return parseInt(pixelMatch[1], 10);\n    }\n\n    var percentMatch = percentageBasedSizeRegex.exec(width);\n\n    if (percentMatch !== null) {\n      var floatWidth = parseFloat(percentMatch[1]);\n      return normalizePixelWidth(floatWidth, tableSize);\n    }\n\n    return get$5(element);\n  };\n\n  var getPixelWidth = function getPixelWidth(cell, tableSize) {\n    var width = getRawWidth(cell);\n    return width.fold(function () {\n      return get$5(cell);\n    }, function (w) {\n      return choosePixelSize(cell, w, tableSize);\n    });\n  };\n\n  var getHeight$1 = function getHeight$1(cell) {\n    return get$6(cell, 'rowspan', getTotalHeight);\n  };\n\n  var getGenericWidth = function getGenericWidth(cell) {\n    var width = getRawWidth(cell);\n    return width.bind(function (w) {\n      var match = genericSizeRegex.exec(w);\n\n      if (match !== null) {\n        return Option.some({\n          width: constant(parseFloat(match[1])),\n          unit: constant(match[3])\n        });\n      } else {\n        return Option.none();\n      }\n    });\n  };\n\n  var setGenericWidth = function setGenericWidth(cell, amount, unit) {\n    set$1(cell, 'width', amount + unit);\n  };\n\n  var Sizes = {\n    percentageBasedSizeRegex: constant(percentageBasedSizeRegex),\n    pixelBasedSizeRegex: constant(pixelBasedSizeRegex),\n    setPixelWidth: setPixelWidth,\n    setPercentageWidth: setPercentageWidth,\n    setHeight: setHeight,\n    getPixelWidth: getPixelWidth,\n    getPercentageWidth: getPercentageWidth,\n    getGenericWidth: getGenericWidth,\n    setGenericWidth: setGenericWidth,\n    getHeight: getHeight$1,\n    getRawWidth: getRawWidth\n  };\n\n  var halve = function halve(main, other) {\n    var width = Sizes.getGenericWidth(main);\n    width.each(function (w) {\n      var newWidth = w.width() / 2;\n      Sizes.setGenericWidth(main, newWidth, w.unit());\n      Sizes.setGenericWidth(other, newWidth, w.unit());\n    });\n  };\n\n  var CellMutations = {\n    halve: halve\n  };\n\n  var r = function r(left, top) {\n    var translate = function translate(x, y) {\n      return r(left + x, top + y);\n    };\n\n    return {\n      left: constant(left),\n      top: constant(top),\n      translate: translate\n    };\n  };\n\n  var Position = r;\n\n  var boxPosition = function boxPosition(dom) {\n    var box = dom.getBoundingClientRect();\n    return Position(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function firstDefinedOrZero(a, b) {\n    return a !== undefined ? a : b !== undefined ? b : 0;\n  };\n\n  var absolute = function absolute(element) {\n    var doc = element.dom().ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n    var scrollTop = firstDefinedOrZero(win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport = function viewport(element) {\n    var dom = element.dom();\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return Position(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return Position(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var rowInfo = Immutable('row', 'y');\n  var colInfo = Immutable('col', 'x');\n\n  var rtlEdge = function rtlEdge(cell) {\n    var pos = absolute(cell);\n    return pos.left() + getOuter$1(cell);\n  };\n\n  var ltrEdge = function ltrEdge(cell) {\n    return absolute(cell).left();\n  };\n\n  var getLeftEdge = function getLeftEdge(index, cell) {\n    return colInfo(index, ltrEdge(cell));\n  };\n\n  var getRightEdge = function getRightEdge(index, cell) {\n    return colInfo(index, rtlEdge(cell));\n  };\n\n  var getTop = function getTop(cell) {\n    return absolute(cell).top();\n  };\n\n  var getTopEdge = function getTopEdge(index, cell) {\n    return rowInfo(index, getTop(cell));\n  };\n\n  var getBottomEdge = function getBottomEdge(index, cell) {\n    return rowInfo(index, getTop(cell) + getOuter(cell));\n  };\n\n  var findPositions = function findPositions(getInnerEdge, getOuterEdge, array) {\n    if (array.length === 0) {\n      return [];\n    }\n\n    var lines = map(array.slice(1), function (cellOption, index) {\n      return cellOption.map(function (cell) {\n        return getInnerEdge(index, cell);\n      });\n    });\n    var lastLine = array[array.length - 1].map(function (cell) {\n      return getOuterEdge(array.length - 1, cell);\n    });\n    return lines.concat([lastLine]);\n  };\n\n  var negate = function negate(step) {\n    return -step;\n  };\n\n  var height = {\n    delta: identity,\n    positions: function positions(optElements) {\n      return findPositions(getTopEdge, getBottomEdge, optElements);\n    },\n    edge: getTop\n  };\n  var ltr = {\n    delta: identity,\n    edge: ltrEdge,\n    positions: function positions(optElements) {\n      return findPositions(getLeftEdge, getRightEdge, optElements);\n    }\n  };\n  var rtl = {\n    delta: negate,\n    edge: rtlEdge,\n    positions: function positions(optElements) {\n      return findPositions(getRightEdge, getLeftEdge, optElements);\n    }\n  };\n  var BarPositions = {\n    height: height,\n    rtl: rtl,\n    ltr: ltr\n  };\n  var ResizeDirection = {\n    ltr: BarPositions.ltr,\n    rtl: BarPositions.rtl\n  };\n\n  function TableDirection(directionAt) {\n    var auto = function auto(table) {\n      return directionAt(table).isRtl() ? ResizeDirection.rtl : ResizeDirection.ltr;\n    };\n\n    var delta = function delta(amount, table) {\n      return auto(table).delta(amount, table);\n    };\n\n    var positions = function positions(cols, table) {\n      return auto(table).positions(cols, table);\n    };\n\n    var edge = function edge(cell) {\n      return auto(cell).edge(cell);\n    };\n\n    return {\n      delta: delta,\n      edge: edge,\n      positions: positions\n    };\n  }\n\n  var getGridSize = function getGridSize(table) {\n    var input = DetailsList.fromTable(table);\n    var warehouse = Warehouse.generate(input);\n    return warehouse.grid();\n  };\n\n  var TableGridSize = {\n    getGridSize: getGridSize\n  };\n\n  var _assign = function __assign() {\n    _assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) {\n          if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n      }\n\n      return t;\n    };\n\n    return _assign.apply(this, arguments);\n  };\n\n  var cat = function cat(arr) {\n    var r = [];\n\n    var push = function push(x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var findMap = function findMap(arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Option.none();\n  };\n\n  var setIfNot = function setIfNot(element, property, value, ignore) {\n    if (value === ignore) {\n      remove(element, property);\n    } else {\n      set(element, property, value);\n    }\n  };\n\n  var render = function render(table, grid) {\n    var newRows = [];\n    var newCells = [];\n\n    var renderSection = function renderSection(gridSection, sectionName) {\n      var section = child$2(table, sectionName).getOrThunk(function () {\n        var tb = Element.fromTag(sectionName, owner(table).dom());\n        append(table, tb);\n        return tb;\n      });\n      empty(section);\n      var rows = map(gridSection, function (row) {\n        if (row.isNew()) {\n          newRows.push(row.element());\n        }\n\n        var tr = row.element();\n        empty(tr);\n        each(row.cells(), function (cell) {\n          if (cell.isNew()) {\n            newCells.push(cell.element());\n          }\n\n          setIfNot(cell.element(), 'colspan', cell.colspan(), 1);\n          setIfNot(cell.element(), 'rowspan', cell.rowspan(), 1);\n          append(tr, cell.element());\n        });\n        return tr;\n      });\n      append$1(section, rows);\n    };\n\n    var removeSection = function removeSection(sectionName) {\n      child$2(table, sectionName).each(remove$2);\n    };\n\n    var renderOrRemoveSection = function renderOrRemoveSection(gridSection, sectionName) {\n      if (gridSection.length > 0) {\n        renderSection(gridSection, sectionName);\n      } else {\n        removeSection(sectionName);\n      }\n    };\n\n    var headSection = [];\n    var bodySection = [];\n    var footSection = [];\n    each(grid, function (row) {\n      switch (row.section()) {\n        case 'thead':\n          headSection.push(row);\n          break;\n\n        case 'tbody':\n          bodySection.push(row);\n          break;\n\n        case 'tfoot':\n          footSection.push(row);\n          break;\n      }\n    });\n    renderOrRemoveSection(headSection, 'thead');\n    renderOrRemoveSection(bodySection, 'tbody');\n    renderOrRemoveSection(footSection, 'tfoot');\n    return {\n      newRows: constant(newRows),\n      newCells: constant(newCells)\n    };\n  };\n\n  var copy$2 = function copy$2(grid) {\n    var rows = map(grid, function (row) {\n      var tr = shallow(row.element());\n      each(row.cells(), function (cell) {\n        var clonedCell = deep(cell.element());\n        setIfNot(clonedCell, 'colspan', cell.colspan(), 1);\n        setIfNot(clonedCell, 'rowspan', cell.rowspan(), 1);\n        append(tr, clonedCell);\n      });\n      return tr;\n    });\n    return rows;\n  };\n\n  var Redraw = {\n    render: render,\n    copy: copy$2\n  };\n\n  var read = function read(element, attr) {\n    var value = get$1(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add = function add(element, attr, id) {\n    var old = read(element, attr);\n    var nu = old.concat([id]);\n    set(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$3 = function remove$3(element, attr, id) {\n    var nu = filter(read(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set(element, attr, nu.join(' '));\n    } else {\n      remove(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function supports(element) {\n    return element.dom().classList !== undefined;\n  };\n\n  var get$7 = function get$7(element) {\n    return read(element, 'class');\n  };\n\n  var add$1 = function add$1(element, clazz) {\n    return add(element, 'class', clazz);\n  };\n\n  var remove$4 = function remove$4(element, clazz) {\n    return remove$3(element, 'class', clazz);\n  };\n\n  var add$2 = function add$2(element, clazz) {\n    if (supports(element)) {\n      element.dom().classList.add(clazz);\n    } else {\n      add$1(element, clazz);\n    }\n  };\n\n  var cleanClass = function cleanClass(element) {\n    var classList = supports(element) ? element.dom().classList : get$7(element);\n\n    if (classList.length === 0) {\n      remove(element, 'class');\n    }\n  };\n\n  var remove$5 = function remove$5(element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom().classList;\n      classList.remove(clazz);\n    } else {\n      remove$4(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has$2 = function has$2(element, clazz) {\n    return supports(element) && element.dom().classList.contains(clazz);\n  };\n\n  var repeat = function repeat(repititions, f) {\n    var r = [];\n\n    for (var i = 0; i < repititions; i++) {\n      r.push(f(i));\n    }\n\n    return r;\n  };\n\n  var range = function range(start, end) {\n    var r = [];\n\n    for (var i = start; i < end; i++) {\n      r.push(i);\n    }\n\n    return r;\n  };\n\n  var deduce = function deduce(xs, index) {\n    if (index < 0 || index >= xs.length - 1) {\n      return Option.none();\n    }\n\n    var current = xs[index].fold(function () {\n      var rest = reverse(xs.slice(0, index));\n      return findMap(rest, function (a, i) {\n        return a.map(function (aa) {\n          return {\n            value: aa,\n            delta: i + 1\n          };\n        });\n      });\n    }, function (c) {\n      return Option.some({\n        value: c,\n        delta: 0\n      });\n    });\n    var next = xs[index + 1].fold(function () {\n      var rest = xs.slice(index + 1);\n      return findMap(rest, function (a, i) {\n        return a.map(function (aa) {\n          return {\n            value: aa,\n            delta: i + 1\n          };\n        });\n      });\n    }, function (n) {\n      return Option.some({\n        value: n,\n        delta: 1\n      });\n    });\n    return current.bind(function (c) {\n      return next.map(function (n) {\n        var extras = n.delta + c.delta;\n        return Math.abs(n.value - c.value) / extras;\n      });\n    });\n  };\n\n  var columns = function columns(warehouse) {\n    var grid = warehouse.grid();\n    var cols = range(0, grid.columns());\n    var rowsArr = range(0, grid.rows());\n    return map(cols, function (col) {\n      var getBlock = function getBlock() {\n        return bind(rowsArr, function (r) {\n          return Warehouse.getAt(warehouse, r, col).filter(function (detail) {\n            return detail.column() === col;\n          }).fold(constant([]), function (detail) {\n            return [detail];\n          });\n        });\n      };\n\n      var isSingle = function isSingle(detail) {\n        return detail.colspan() === 1;\n      };\n\n      var getFallback = function getFallback() {\n        return Warehouse.getAt(warehouse, 0, col);\n      };\n\n      return decide(getBlock, isSingle, getFallback);\n    });\n  };\n\n  var decide = function decide(getBlock, isSingle, getFallback) {\n    var inBlock = getBlock();\n    var singleInBlock = find(inBlock, isSingle);\n    var detailOption = singleInBlock.orThunk(function () {\n      return Option.from(inBlock[0]).orThunk(getFallback);\n    });\n    return detailOption.map(function (detail) {\n      return detail.element();\n    });\n  };\n\n  var rows$1 = function rows$1(warehouse) {\n    var grid = warehouse.grid();\n    var rowsArr = range(0, grid.rows());\n    var cols = range(0, grid.columns());\n    return map(rowsArr, function (row) {\n      var getBlock = function getBlock() {\n        return bind(cols, function (c) {\n          return Warehouse.getAt(warehouse, row, c).filter(function (detail) {\n            return detail.row() === row;\n          }).fold(constant([]), function (detail) {\n            return [detail];\n          });\n        });\n      };\n\n      var isSingle = function isSingle(detail) {\n        return detail.rowspan() === 1;\n      };\n\n      var getFallback = function getFallback() {\n        return Warehouse.getAt(warehouse, row, 0);\n      };\n\n      return decide(getBlock, isSingle, getFallback);\n    });\n  };\n\n  var Blocks = {\n    columns: columns,\n    rows: rows$1\n  };\n\n  var css = function css(namespace) {\n    var dashNamespace = namespace.replace(/\\./g, '-');\n\n    var resolve = function resolve(str) {\n      return dashNamespace + '-' + str;\n    };\n\n    return {\n      resolve: resolve\n    };\n  };\n\n  var styles = css('ephox-snooker');\n  var Styles = {\n    resolve: styles.resolve\n  };\n\n  var col = function col(column, x, y, w, h) {\n    var blocker = Element.fromTag('div');\n    setAll$1(blocker, {\n      position: 'absolute',\n      left: x - w / 2 + 'px',\n      top: y + 'px',\n      height: h + 'px',\n      width: w + 'px'\n    });\n    setAll(blocker, {\n      'data-column': column,\n      'role': 'presentation'\n    });\n    return blocker;\n  };\n\n  var row$1 = function row$1(r, x, y, w, h) {\n    var blocker = Element.fromTag('div');\n    setAll$1(blocker, {\n      position: 'absolute',\n      left: x + 'px',\n      top: y - h / 2 + 'px',\n      height: h + 'px',\n      width: w + 'px'\n    });\n    setAll(blocker, {\n      'data-row': r,\n      'role': 'presentation'\n    });\n    return blocker;\n  };\n\n  var Bar = {\n    col: col,\n    row: row$1\n  };\n  var resizeBar = Styles.resolve('resizer-bar');\n  var resizeRowBar = Styles.resolve('resizer-rows');\n  var resizeColBar = Styles.resolve('resizer-cols');\n  var BAR_THICKNESS = 7;\n\n  var destroy = function destroy(wire) {\n    var previous = descendants$1(wire.parent(), '.' + resizeBar);\n    each(previous, remove$2);\n  };\n\n  var drawBar = function drawBar(wire, positions, create) {\n    var origin = wire.origin();\n    each(positions, function (cpOption, i) {\n      cpOption.each(function (cp) {\n        var bar = create(origin, cp);\n        add$2(bar, resizeBar);\n        append(wire.parent(), bar);\n      });\n    });\n  };\n\n  var refreshCol = function refreshCol(wire, colPositions, position, tableHeight) {\n    drawBar(wire, colPositions, function (origin, cp) {\n      var colBar = Bar.col(cp.col(), cp.x() - origin.left(), position.top() - origin.top(), BAR_THICKNESS, tableHeight);\n      add$2(colBar, resizeColBar);\n      return colBar;\n    });\n  };\n\n  var refreshRow = function refreshRow(wire, rowPositions, position, tableWidth) {\n    drawBar(wire, rowPositions, function (origin, cp) {\n      var rowBar = Bar.row(cp.row(), position.left() - origin.left(), cp.y() - origin.top(), tableWidth, BAR_THICKNESS);\n      add$2(rowBar, resizeRowBar);\n      return rowBar;\n    });\n  };\n\n  var refreshGrid = function refreshGrid(wire, table, rows, cols, hdirection, vdirection) {\n    var position = absolute(table);\n    var rowPositions = rows.length > 0 ? hdirection.positions(rows, table) : [];\n    refreshRow(wire, rowPositions, position, getOuter$1(table));\n    var colPositions = cols.length > 0 ? vdirection.positions(cols, table) : [];\n    refreshCol(wire, colPositions, position, getOuter(table));\n  };\n\n  var refresh = function refresh(wire, table, hdirection, vdirection) {\n    destroy(wire);\n    var list = DetailsList.fromTable(table);\n    var warehouse = Warehouse.generate(list);\n    var rows = Blocks.rows(warehouse);\n    var cols = Blocks.columns(warehouse);\n    refreshGrid(wire, table, rows, cols, hdirection, vdirection);\n  };\n\n  var each$2 = function each$2(wire, f) {\n    var bars = descendants$1(wire.parent(), '.' + resizeBar);\n    each(bars, f);\n  };\n\n  var hide = function hide(wire) {\n    each$2(wire, function (bar) {\n      set$1(bar, 'display', 'none');\n    });\n  };\n\n  var show = function show(wire) {\n    each$2(wire, function (bar) {\n      set$1(bar, 'display', 'block');\n    });\n  };\n\n  var isRowBar = function isRowBar(element) {\n    return has$2(element, resizeRowBar);\n  };\n\n  var isColBar = function isColBar(element) {\n    return has$2(element, resizeColBar);\n  };\n\n  var Bars = {\n    refresh: refresh,\n    hide: hide,\n    show: show,\n    destroy: destroy,\n    isRowBar: isRowBar,\n    isColBar: isColBar\n  };\n\n  var addCell = function addCell(gridRow, index, cell) {\n    var cells = gridRow.cells();\n    var before = cells.slice(0, index);\n    var after = cells.slice(index);\n    var newCells = before.concat([cell]).concat(after);\n    return setCells(gridRow, newCells);\n  };\n\n  var mutateCell = function mutateCell(gridRow, index, cell) {\n    var cells = gridRow.cells();\n    cells[index] = cell;\n  };\n\n  var setCells = function setCells(gridRow, cells) {\n    return rowcells(cells, gridRow.section());\n  };\n\n  var mapCells = function mapCells(gridRow, f) {\n    var cells = gridRow.cells();\n    var r = map(cells, f);\n    return rowcells(r, gridRow.section());\n  };\n\n  var getCell = function getCell(gridRow, index) {\n    return gridRow.cells()[index];\n  };\n\n  var getCellElement = function getCellElement(gridRow, index) {\n    return getCell(gridRow, index).element();\n  };\n\n  var cellLength = function cellLength(gridRow) {\n    return gridRow.cells().length;\n  };\n\n  var GridRow = {\n    addCell: addCell,\n    setCells: setCells,\n    mutateCell: mutateCell,\n    getCell: getCell,\n    getCellElement: getCellElement,\n    mapCells: mapCells,\n    cellLength: cellLength\n  };\n\n  var getColumn = function getColumn(grid, index) {\n    return map(grid, function (row) {\n      return GridRow.getCell(row, index);\n    });\n  };\n\n  var getRow = function getRow(grid, index) {\n    return grid[index];\n  };\n\n  var findDiff = function findDiff(xs, comp) {\n    if (xs.length === 0) {\n      return 0;\n    }\n\n    var first = xs[0];\n    var index = findIndex(xs, function (x) {\n      return !comp(first.element(), x.element());\n    });\n    return index.fold(function () {\n      return xs.length;\n    }, function (ind) {\n      return ind;\n    });\n  };\n\n  var subgrid = function subgrid(grid, row, column, comparator) {\n    var restOfRow = getRow(grid, row).cells().slice(column);\n    var endColIndex = findDiff(restOfRow, comparator);\n    var restOfColumn = getColumn(grid, column).slice(row);\n    var endRowIndex = findDiff(restOfColumn, comparator);\n    return {\n      colspan: constant(endColIndex),\n      rowspan: constant(endRowIndex)\n    };\n  };\n\n  var TableGrid = {\n    subgrid: subgrid\n  };\n\n  var toDetails = function toDetails(grid, comparator) {\n    var seen = map(grid, function (row, ri) {\n      return map(row.cells(), function (col, ci) {\n        return false;\n      });\n    });\n\n    var updateSeen = function updateSeen(ri, ci, rowspan, colspan) {\n      for (var r = ri; r < ri + rowspan; r++) {\n        for (var c = ci; c < ci + colspan; c++) {\n          seen[r][c] = true;\n        }\n      }\n    };\n\n    return map(grid, function (row, ri) {\n      var details = bind(row.cells(), function (cell, ci) {\n        if (seen[ri][ci] === false) {\n          var result = TableGrid.subgrid(grid, ri, ci, comparator);\n          updateSeen(ri, ci, result.rowspan(), result.colspan());\n          return [detailnew(cell.element(), result.rowspan(), result.colspan(), cell.isNew())];\n        } else {\n          return [];\n        }\n      });\n      return rowdetails(details, row.section());\n    });\n  };\n\n  var toGrid = function toGrid(warehouse, generators, isNew) {\n    var grid = [];\n\n    for (var i = 0; i < warehouse.grid().rows(); i++) {\n      var rowCells = [];\n\n      for (var j = 0; j < warehouse.grid().columns(); j++) {\n        var element = Warehouse.getAt(warehouse, i, j).map(function (item) {\n          return elementnew(item.element(), isNew);\n        }).getOrThunk(function () {\n          return elementnew(generators.gap(), true);\n        });\n        rowCells.push(element);\n      }\n\n      var row = rowcells(rowCells, warehouse.all()[i].section());\n      grid.push(row);\n    }\n\n    return grid;\n  };\n\n  var Transitions = {\n    toDetails: toDetails,\n    toGrid: toGrid\n  };\n\n  var fromWarehouse = function fromWarehouse(warehouse, generators) {\n    return Transitions.toGrid(warehouse, generators, false);\n  };\n\n  var deriveRows = function deriveRows(rendered, generators) {\n    var findRow = function findRow(details) {\n      var rowOfCells = findMap(details, function (detail) {\n        return parent(detail.element()).map(function (row) {\n          var isNew = parent(row).isNone();\n          return elementnew(row, isNew);\n        });\n      });\n      return rowOfCells.getOrThunk(function () {\n        return elementnew(generators.row(), true);\n      });\n    };\n\n    return map(rendered, function (details) {\n      var row = findRow(details.details());\n      return rowdatanew(row.element(), details.details(), details.section(), row.isNew());\n    });\n  };\n\n  var toDetailList = function toDetailList(grid, generators) {\n    var rendered = Transitions.toDetails(grid, eq);\n    return deriveRows(rendered, generators);\n  };\n\n  var findInWarehouse = function findInWarehouse(warehouse, element) {\n    var all = flatten(map(warehouse.all(), function (r) {\n      return r.cells();\n    }));\n    return find(all, function (e) {\n      return eq(element, e.element());\n    });\n  };\n\n  var run = function run(operation, extract, adjustment, postAction, genWrappers) {\n    return function (wire, table, target, generators, direction) {\n      var input = DetailsList.fromTable(table);\n      var warehouse = Warehouse.generate(input);\n      var output = extract(warehouse, target).map(function (info) {\n        var model = fromWarehouse(warehouse, generators);\n        var result = operation(model, info, eq, genWrappers(generators));\n        var grid = toDetailList(result.grid(), generators);\n        return {\n          grid: constant(grid),\n          cursor: result.cursor\n        };\n      });\n      return output.fold(function () {\n        return Option.none();\n      }, function (out) {\n        var newElements = Redraw.render(table, out.grid());\n        adjustment(table, out.grid(), direction);\n        postAction(table);\n        Bars.refresh(wire, table, BarPositions.height, direction);\n        return Option.some({\n          cursor: out.cursor,\n          newRows: newElements.newRows,\n          newCells: newElements.newCells\n        });\n      });\n    };\n  };\n\n  var onCell = function onCell(warehouse, target) {\n    return TableLookup.cell(target.element()).bind(function (cell) {\n      return findInWarehouse(warehouse, cell);\n    });\n  };\n\n  var onPaste = function onPaste(warehouse, target) {\n    return TableLookup.cell(target.element()).bind(function (cell) {\n      return findInWarehouse(warehouse, cell).map(function (details) {\n        var value = _assign({}, details, {\n          generators: target.generators,\n          clipboard: target.clipboard\n        });\n\n        return value;\n      });\n    });\n  };\n\n  var onPasteRows = function onPasteRows(warehouse, target) {\n    var details = map(target.selection(), function (cell) {\n      return TableLookup.cell(cell).bind(function (lc) {\n        return findInWarehouse(warehouse, lc);\n      });\n    });\n    var cells = cat(details);\n    return cells.length > 0 ? Option.some({\n      cells: cells,\n      generators: target.generators,\n      clipboard: target.clipboard\n    }) : Option.none();\n  };\n\n  var onMergable = function onMergable(_warehouse, target) {\n    return target.mergable();\n  };\n\n  var onUnmergable = function onUnmergable(_warehouse, target) {\n    return target.unmergable();\n  };\n\n  var onCells = function onCells(warehouse, target) {\n    var details = map(target.selection(), function (cell) {\n      return TableLookup.cell(cell).bind(function (lc) {\n        return findInWarehouse(warehouse, lc);\n      });\n    });\n    var cells = cat(details);\n    return cells.length > 0 ? Option.some(cells) : Option.none();\n  };\n\n  var value = function value(o) {\n    var is = function is(v) {\n      return o === v;\n    };\n\n    var or = function or(opt) {\n      return value(o);\n    };\n\n    var orThunk = function orThunk(f) {\n      return value(o);\n    };\n\n    var map = function map(f) {\n      return value(f(o));\n    };\n\n    var mapError = function mapError(f) {\n      return value(o);\n    };\n\n    var each = function each(f) {\n      f(o);\n    };\n\n    var bind = function bind(f) {\n      return f(o);\n    };\n\n    var fold = function fold(_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function exists(f) {\n      return f(o);\n    };\n\n    var forall = function forall(f) {\n      return f(o);\n    };\n\n    var toOption = function toOption() {\n      return Option.some(o);\n    };\n\n    return {\n      is: is,\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOption: toOption\n    };\n  };\n\n  var error = function error(message) {\n    var getOrThunk = function getOrThunk(f) {\n      return f();\n    };\n\n    var getOrDie = function getOrDie() {\n      return die(String(message))();\n    };\n\n    var or = function or(opt) {\n      return opt;\n    };\n\n    var orThunk = function orThunk(f) {\n      return f();\n    };\n\n    var map = function map(f) {\n      return error(message);\n    };\n\n    var mapError = function mapError(f) {\n      return error(f(message));\n    };\n\n    var bind = function bind(f) {\n      return error(message);\n    };\n\n    var fold = function fold(onError, _) {\n      return onError(message);\n    };\n\n    return {\n      is: never,\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOption: Option.none\n    };\n  };\n\n  var fromOption = function fromOption(opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value);\n  };\n\n  var Result = {\n    value: value,\n    error: error,\n    fromOption: fromOption\n  };\n\n  var measure = function measure(startAddress, gridA, gridB) {\n    if (startAddress.row() >= gridA.length || startAddress.column() > GridRow.cellLength(gridA[0])) {\n      return Result.error('invalid start address out of table bounds, row: ' + startAddress.row() + ', column: ' + startAddress.column());\n    }\n\n    var rowRemainder = gridA.slice(startAddress.row());\n    var colRemainder = rowRemainder[0].cells().slice(startAddress.column());\n    var colRequired = GridRow.cellLength(gridB[0]);\n    var rowRequired = gridB.length;\n    return Result.value({\n      rowDelta: constant(rowRemainder.length - rowRequired),\n      colDelta: constant(colRemainder.length - colRequired)\n    });\n  };\n\n  var measureWidth = function measureWidth(gridA, gridB) {\n    var colLengthA = GridRow.cellLength(gridA[0]);\n    var colLengthB = GridRow.cellLength(gridB[0]);\n    return {\n      rowDelta: constant(0),\n      colDelta: constant(colLengthA - colLengthB)\n    };\n  };\n\n  var fill = function fill(cells, generator) {\n    return map(cells, function () {\n      return elementnew(generator.cell(), true);\n    });\n  };\n\n  var rowFill = function rowFill(grid, amount, generator) {\n    return grid.concat(repeat(amount, function (_row) {\n      return GridRow.setCells(grid[grid.length - 1], fill(grid[grid.length - 1].cells(), generator));\n    }));\n  };\n\n  var colFill = function colFill(grid, amount, generator) {\n    return map(grid, function (row) {\n      return GridRow.setCells(row, row.cells().concat(fill(range(0, amount), generator)));\n    });\n  };\n\n  var tailor = function tailor(gridA, delta, generator) {\n    var fillCols = delta.colDelta() < 0 ? colFill : identity;\n    var fillRows = delta.rowDelta() < 0 ? rowFill : identity;\n    var modifiedCols = fillCols(gridA, Math.abs(delta.colDelta()), generator);\n    var tailoredGrid = fillRows(modifiedCols, Math.abs(delta.rowDelta()), generator);\n    return tailoredGrid;\n  };\n\n  var Fitment = {\n    measure: measure,\n    measureWidth: measureWidth,\n    tailor: tailor\n  };\n\n  var merge = function merge(grid, bounds, comparator, substitution) {\n    if (grid.length === 0) {\n      return grid;\n    }\n\n    for (var i = bounds.startRow(); i <= bounds.finishRow(); i++) {\n      for (var j = bounds.startCol(); j <= bounds.finishCol(); j++) {\n        GridRow.mutateCell(grid[i], j, elementnew(substitution(), false));\n      }\n    }\n\n    return grid;\n  };\n\n  var unmerge = function unmerge(grid, target, comparator, substitution) {\n    var first = true;\n\n    for (var i = 0; i < grid.length; i++) {\n      for (var j = 0; j < GridRow.cellLength(grid[0]); j++) {\n        var current = GridRow.getCellElement(grid[i], j);\n        var isToReplace = comparator(current, target);\n\n        if (isToReplace === true && first === false) {\n          GridRow.mutateCell(grid[i], j, elementnew(substitution(), true));\n        } else if (isToReplace === true) {\n          first = false;\n        }\n      }\n    }\n\n    return grid;\n  };\n\n  var uniqueCells = function uniqueCells(row, comparator) {\n    return foldl(row, function (rest, cell) {\n      return exists(rest, function (currentCell) {\n        return comparator(currentCell.element(), cell.element());\n      }) ? rest : rest.concat([cell]);\n    }, []);\n  };\n\n  var splitRows = function splitRows(grid, index, comparator, substitution) {\n    if (index > 0 && index < grid.length) {\n      var rowPrevCells = grid[index - 1].cells();\n      var cells = uniqueCells(rowPrevCells, comparator);\n      each(cells, function (cell) {\n        var replacement = Option.none();\n\n        var _loop_1 = function _loop_1(i) {\n          var _loop_2 = function _loop_2(j) {\n            var current = grid[i].cells()[j];\n            var isToReplace = comparator(current.element(), cell.element());\n\n            if (isToReplace) {\n              if (replacement.isNone()) {\n                replacement = Option.some(substitution());\n              }\n\n              replacement.each(function (sub) {\n                GridRow.mutateCell(grid[i], j, elementnew(sub, true));\n              });\n            }\n          };\n\n          for (var j = 0; j < GridRow.cellLength(grid[0]); j++) {\n            _loop_2(j);\n          }\n        };\n\n        for (var i = index; i < grid.length; i++) {\n          _loop_1(i);\n        }\n      });\n    }\n\n    return grid;\n  };\n\n  var MergingOperations = {\n    merge: merge,\n    unmerge: unmerge,\n    splitRows: splitRows\n  };\n\n  var isSpanning = function isSpanning(grid, row, col, comparator) {\n    var candidate = GridRow.getCell(grid[row], col);\n    var matching = curry(comparator, candidate.element());\n    var currentRow = grid[row];\n    return grid.length > 1 && GridRow.cellLength(currentRow) > 1 && (col > 0 && matching(GridRow.getCellElement(currentRow, col - 1)) || col < currentRow.cells().length - 1 && matching(GridRow.getCellElement(currentRow, col + 1)) || row > 0 && matching(GridRow.getCellElement(grid[row - 1], col)) || row < grid.length - 1 && matching(GridRow.getCellElement(grid[row + 1], col)));\n  };\n\n  var mergeTables = function mergeTables(startAddress, gridA, gridB, generator, comparator) {\n    var startRow = startAddress.row();\n    var startCol = startAddress.column();\n    var mergeHeight = gridB.length;\n    var mergeWidth = GridRow.cellLength(gridB[0]);\n    var endRow = startRow + mergeHeight;\n    var endCol = startCol + mergeWidth;\n\n    for (var r = startRow; r < endRow; r++) {\n      for (var c = startCol; c < endCol; c++) {\n        if (isSpanning(gridA, r, c, comparator)) {\n          MergingOperations.unmerge(gridA, GridRow.getCellElement(gridA[r], c), comparator, generator.cell);\n        }\n\n        var newCell = GridRow.getCellElement(gridB[r - startRow], c - startCol);\n        var replacement = generator.replace(newCell);\n        GridRow.mutateCell(gridA[r], c, elementnew(replacement, true));\n      }\n    }\n\n    return gridA;\n  };\n\n  var merge$1 = function merge$1(startAddress, gridA, gridB, generator, comparator) {\n    var result = Fitment.measure(startAddress, gridA, gridB);\n    return result.map(function (delta) {\n      var fittedGrid = Fitment.tailor(gridA, delta, generator);\n      return mergeTables(startAddress, fittedGrid, gridB, generator, comparator);\n    });\n  };\n\n  var insert = function insert(index, gridA, gridB, generator, comparator) {\n    MergingOperations.splitRows(gridA, index, comparator, generator.cell);\n    var delta = Fitment.measureWidth(gridB, gridA);\n    var fittedNewGrid = Fitment.tailor(gridB, delta, generator);\n    var secondDelta = Fitment.measureWidth(gridA, fittedNewGrid);\n    var fittedOldGrid = Fitment.tailor(gridA, secondDelta, generator);\n    return fittedOldGrid.slice(0, index).concat(fittedNewGrid).concat(fittedOldGrid.slice(index, fittedOldGrid.length));\n  };\n\n  var TableMerge = {\n    merge: merge$1,\n    insert: insert\n  };\n\n  var insertRowAt = function insertRowAt(grid, index, example, comparator, substitution) {\n    var before = grid.slice(0, index);\n    var after = grid.slice(index);\n    var between = GridRow.mapCells(grid[example], function (ex, c) {\n      var withinSpan = index > 0 && index < grid.length && comparator(GridRow.getCellElement(grid[index - 1], c), GridRow.getCellElement(grid[index], c));\n      var ret = withinSpan ? GridRow.getCell(grid[index], c) : elementnew(substitution(ex.element(), comparator), true);\n      return ret;\n    });\n    return before.concat([between]).concat(after);\n  };\n\n  var insertColumnAt = function insertColumnAt(grid, index, example, comparator, substitution) {\n    return map(grid, function (row) {\n      var withinSpan = index > 0 && index < GridRow.cellLength(row) && comparator(GridRow.getCellElement(row, index - 1), GridRow.getCellElement(row, index));\n      var sub = withinSpan ? GridRow.getCell(row, index) : elementnew(substitution(GridRow.getCellElement(row, example), comparator), true);\n      return GridRow.addCell(row, index, sub);\n    });\n  };\n\n  var splitCellIntoColumns = function splitCellIntoColumns(grid, exampleRow, exampleCol, comparator, substitution) {\n    var index = exampleCol + 1;\n    return map(grid, function (row, i) {\n      var isTargetCell = i === exampleRow;\n      var sub = isTargetCell ? elementnew(substitution(GridRow.getCellElement(row, exampleCol), comparator), true) : GridRow.getCell(row, exampleCol);\n      return GridRow.addCell(row, index, sub);\n    });\n  };\n\n  var splitCellIntoRows = function splitCellIntoRows(grid, exampleRow, exampleCol, comparator, substitution) {\n    var index = exampleRow + 1;\n    var before = grid.slice(0, index);\n    var after = grid.slice(index);\n    var between = GridRow.mapCells(grid[exampleRow], function (ex, i) {\n      var isTargetCell = i === exampleCol;\n      return isTargetCell ? elementnew(substitution(ex.element(), comparator), true) : ex;\n    });\n    return before.concat([between]).concat(after);\n  };\n\n  var deleteColumnsAt = function deleteColumnsAt(grid, start, finish) {\n    var rows = map(grid, function (row) {\n      var cells = row.cells().slice(0, start).concat(row.cells().slice(finish + 1));\n      return rowcells(cells, row.section());\n    });\n    return filter(rows, function (row) {\n      return row.cells().length > 0;\n    });\n  };\n\n  var deleteRowsAt = function deleteRowsAt(grid, start, finish) {\n    return grid.slice(0, start).concat(grid.slice(finish + 1));\n  };\n\n  var ModificationOperations = {\n    insertRowAt: insertRowAt,\n    insertColumnAt: insertColumnAt,\n    splitCellIntoColumns: splitCellIntoColumns,\n    splitCellIntoRows: splitCellIntoRows,\n    deleteRowsAt: deleteRowsAt,\n    deleteColumnsAt: deleteColumnsAt\n  };\n\n  var replaceIn = function replaceIn(grid, targets, comparator, substitution) {\n    var isTarget = function isTarget(cell) {\n      return exists(targets, function (target) {\n        return comparator(cell.element(), target.element());\n      });\n    };\n\n    return map(grid, function (row) {\n      return GridRow.mapCells(row, function (cell) {\n        return isTarget(cell) ? elementnew(substitution(cell.element(), comparator), true) : cell;\n      });\n    });\n  };\n\n  var notStartRow = function notStartRow(grid, rowIndex, colIndex, comparator) {\n    return GridRow.getCellElement(grid[rowIndex], colIndex) !== undefined && rowIndex > 0 && comparator(GridRow.getCellElement(grid[rowIndex - 1], colIndex), GridRow.getCellElement(grid[rowIndex], colIndex));\n  };\n\n  var notStartColumn = function notStartColumn(row, index, comparator) {\n    return index > 0 && comparator(GridRow.getCellElement(row, index - 1), GridRow.getCellElement(row, index));\n  };\n\n  var replaceColumn = function replaceColumn(grid, index, comparator, substitution) {\n    var targets = bind(grid, function (row, i) {\n      var alreadyAdded = notStartRow(grid, i, index, comparator) || notStartColumn(row, index, comparator);\n      return alreadyAdded ? [] : [GridRow.getCell(row, index)];\n    });\n    return replaceIn(grid, targets, comparator, substitution);\n  };\n\n  var replaceRow = function replaceRow(grid, index, comparator, substitution) {\n    var targetRow = grid[index];\n    var targets = bind(targetRow.cells(), function (item, i) {\n      var alreadyAdded = notStartRow(grid, index, i, comparator) || notStartColumn(targetRow, i, comparator);\n      return alreadyAdded ? [] : [item];\n    });\n    return replaceIn(grid, targets, comparator, substitution);\n  };\n\n  var TransformOperations = {\n    replaceColumn: replaceColumn,\n    replaceRow: replaceRow\n  };\n  var adt = Adt.generate([{\n    none: []\n  }, {\n    only: ['index']\n  }, {\n    left: ['index', 'next']\n  }, {\n    middle: ['prev', 'index', 'next']\n  }, {\n    right: ['prev', 'index']\n  }]);\n\n  var ColumnContext = _assign({}, adt);\n\n  var neighbours$1 = function neighbours$1(input, index) {\n    if (input.length === 0) {\n      return ColumnContext.none();\n    }\n\n    if (input.length === 1) {\n      return ColumnContext.only(0);\n    }\n\n    if (index === 0) {\n      return ColumnContext.left(0, 1);\n    }\n\n    if (index === input.length - 1) {\n      return ColumnContext.right(index - 1, index);\n    }\n\n    if (index > 0 && index < input.length - 1) {\n      return ColumnContext.middle(index - 1, index, index + 1);\n    }\n\n    return ColumnContext.none();\n  };\n\n  var determine = function determine(input, column, step, tableSize) {\n    var result = input.slice(0);\n    var context = neighbours$1(input, column);\n\n    var zero = function zero(array) {\n      return map(array, constant(0));\n    };\n\n    var onNone = constant(zero(result));\n\n    var onOnly = function onOnly(index) {\n      return tableSize.singleColumnWidth(result[index], step);\n    };\n\n    var onChange = function onChange(index, next) {\n      if (step >= 0) {\n        var newNext = Math.max(tableSize.minCellWidth(), result[next] - step);\n        return zero(result.slice(0, index)).concat([step, newNext - result[next]]).concat(zero(result.slice(next + 1)));\n      } else {\n        var newThis = Math.max(tableSize.minCellWidth(), result[index] + step);\n        var diffx = result[index] - newThis;\n        return zero(result.slice(0, index)).concat([newThis - result[index], diffx]).concat(zero(result.slice(next + 1)));\n      }\n    };\n\n    var onLeft = onChange;\n\n    var onMiddle = function onMiddle(_prev, index, next) {\n      return onChange(index, next);\n    };\n\n    var onRight = function onRight(_prev, index) {\n      if (step >= 0) {\n        return zero(result.slice(0, index)).concat([step]);\n      } else {\n        var size = Math.max(tableSize.minCellWidth(), result[index] + step);\n        return zero(result.slice(0, index)).concat([size - result[index]]);\n      }\n    };\n\n    return context.fold(onNone, onOnly, onLeft, onMiddle, onRight);\n  };\n\n  var Deltas = {\n    determine: determine\n  };\n\n  var getSpan$1 = function getSpan$1(cell, type) {\n    return has$1(cell, type) && parseInt(get$1(cell, type), 10) > 1;\n  };\n\n  var hasColspan = function hasColspan(cell) {\n    return getSpan$1(cell, 'colspan');\n  };\n\n  var hasRowspan = function hasRowspan(cell) {\n    return getSpan$1(cell, 'rowspan');\n  };\n\n  var getInt = function getInt(element, property) {\n    return parseInt(get$2(element, property), 10);\n  };\n\n  var CellUtils = {\n    hasColspan: hasColspan,\n    hasRowspan: hasRowspan,\n    minWidth: constant(10),\n    minHeight: constant(10),\n    getInt: getInt\n  };\n\n  var getRaw$1 = function getRaw$1(cell, property, getter) {\n    return getRaw(cell, property).fold(function () {\n      return getter(cell) + 'px';\n    }, function (raw) {\n      return raw;\n    });\n  };\n\n  var getRawW = function getRawW(cell, tableSize) {\n    return getRaw$1(cell, 'width', function (e) {\n      return Sizes.getPixelWidth(e, tableSize);\n    });\n  };\n\n  var getRawH = function getRawH(cell) {\n    return getRaw$1(cell, 'height', Sizes.getHeight);\n  };\n\n  var getWidthFrom = function getWidthFrom(warehouse, direction, getWidth, fallback, tableSize) {\n    var columns = Blocks.columns(warehouse);\n    var backups = map(columns, function (cellOption) {\n      return cellOption.map(direction.edge);\n    });\n    return map(columns, function (cellOption, c) {\n      var columnCell = cellOption.filter(not(CellUtils.hasColspan));\n      return columnCell.fold(function () {\n        var deduced = deduce(backups, c);\n        return fallback(deduced);\n      }, function (cell) {\n        return getWidth(cell, tableSize);\n      });\n    });\n  };\n\n  var getDeduced = function getDeduced(deduced) {\n    return deduced.map(function (d) {\n      return d + 'px';\n    }).getOr('');\n  };\n\n  var getRawWidths = function getRawWidths(warehouse, direction, tableSize) {\n    return getWidthFrom(warehouse, direction, getRawW, getDeduced, tableSize);\n  };\n\n  var getPercentageWidths = function getPercentageWidths(warehouse, direction, tableSize) {\n    return getWidthFrom(warehouse, direction, Sizes.getPercentageWidth, function (deduced) {\n      return deduced.fold(function () {\n        return tableSize.minCellWidth();\n      }, function (cellWidth) {\n        return cellWidth / tableSize.pixelWidth() * 100;\n      });\n    }, tableSize);\n  };\n\n  var getPixelWidths = function getPixelWidths(warehouse, direction, tableSize) {\n    return getWidthFrom(warehouse, direction, Sizes.getPixelWidth, function (deduced) {\n      return deduced.getOrThunk(tableSize.minCellWidth);\n    }, tableSize);\n  };\n\n  var getHeightFrom = function getHeightFrom(warehouse, direction, getHeight, fallback) {\n    var rows = Blocks.rows(warehouse);\n    var backups = map(rows, function (cellOption) {\n      return cellOption.map(direction.edge);\n    });\n    return map(rows, function (cellOption, c) {\n      var rowCell = cellOption.filter(not(CellUtils.hasRowspan));\n      return rowCell.fold(function () {\n        var deduced = deduce(backups, c);\n        return fallback(deduced);\n      }, function (cell) {\n        return getHeight(cell);\n      });\n    });\n  };\n\n  var getPixelHeights = function getPixelHeights(warehouse, direction) {\n    return getHeightFrom(warehouse, direction, Sizes.getHeight, function (deduced) {\n      return deduced.getOrThunk(CellUtils.minHeight);\n    });\n  };\n\n  var getRawHeights = function getRawHeights(warehouse, direction) {\n    return getHeightFrom(warehouse, direction, getRawH, getDeduced);\n  };\n\n  var ColumnSizes = {\n    getRawWidths: getRawWidths,\n    getPixelWidths: getPixelWidths,\n    getPercentageWidths: getPercentageWidths,\n    getPixelHeights: getPixelHeights,\n    getRawHeights: getRawHeights\n  };\n\n  var total = function total(start, end, measures) {\n    var r = 0;\n\n    for (var i = start; i < end; i++) {\n      r += measures[i] !== undefined ? measures[i] : 0;\n    }\n\n    return r;\n  };\n\n  var recalculateWidth = function recalculateWidth(warehouse, widths) {\n    var all = Warehouse.justCells(warehouse);\n    return map(all, function (cell) {\n      var width = total(cell.column(), cell.column() + cell.colspan(), widths);\n      return {\n        element: cell.element,\n        width: constant(width),\n        colspan: cell.colspan\n      };\n    });\n  };\n\n  var recalculateHeight = function recalculateHeight(warehouse, heights) {\n    var all = Warehouse.justCells(warehouse);\n    return map(all, function (cell) {\n      var height = total(cell.row(), cell.row() + cell.rowspan(), heights);\n      return {\n        element: cell.element,\n        height: constant(height),\n        rowspan: cell.rowspan\n      };\n    });\n  };\n\n  var matchRowHeight = function matchRowHeight(warehouse, heights) {\n    return map(warehouse.all(), function (row, i) {\n      return {\n        element: row.element,\n        height: constant(heights[i])\n      };\n    });\n  };\n\n  var Recalculations = {\n    recalculateWidth: recalculateWidth,\n    recalculateHeight: recalculateHeight,\n    matchRowHeight: matchRowHeight\n  };\n\n  var percentageSize = function percentageSize(width, element) {\n    var floatWidth = parseFloat(width);\n    var pixelWidth = get$5(element);\n\n    var getCellDelta = function getCellDelta(delta) {\n      return delta / pixelWidth * 100;\n    };\n\n    var singleColumnWidth = function singleColumnWidth(w, _delta) {\n      return [100 - w];\n    };\n\n    var minCellWidth = function minCellWidth() {\n      return CellUtils.minWidth() / pixelWidth * 100;\n    };\n\n    var setTableWidth = function setTableWidth(table, _newWidths, delta) {\n      var ratio = delta / 100;\n      var change = ratio * floatWidth;\n      Sizes.setPercentageWidth(table, floatWidth + change);\n    };\n\n    return {\n      width: constant(floatWidth),\n      pixelWidth: constant(pixelWidth),\n      getWidths: ColumnSizes.getPercentageWidths,\n      getCellDelta: getCellDelta,\n      singleColumnWidth: singleColumnWidth,\n      minCellWidth: minCellWidth,\n      setElementWidth: Sizes.setPercentageWidth,\n      setTableWidth: setTableWidth\n    };\n  };\n\n  var pixelSize = function pixelSize(width) {\n    var getCellDelta = identity;\n\n    var singleColumnWidth = function singleColumnWidth(w, delta) {\n      var newNext = Math.max(CellUtils.minWidth(), w + delta);\n      return [newNext - w];\n    };\n\n    var setTableWidth = function setTableWidth(table, newWidths, _delta) {\n      var total = foldr(newWidths, function (b, a) {\n        return b + a;\n      }, 0);\n      Sizes.setPixelWidth(table, total);\n    };\n\n    return {\n      width: constant(width),\n      pixelWidth: constant(width),\n      getWidths: ColumnSizes.getPixelWidths,\n      getCellDelta: getCellDelta,\n      singleColumnWidth: singleColumnWidth,\n      minCellWidth: CellUtils.minWidth,\n      setElementWidth: Sizes.setPixelWidth,\n      setTableWidth: setTableWidth\n    };\n  };\n\n  var chooseSize = function chooseSize(element, width) {\n    var percentMatch = Sizes.percentageBasedSizeRegex().exec(width);\n\n    if (percentMatch !== null) {\n      return percentageSize(percentMatch[1], element);\n    }\n\n    var pixelMatch = Sizes.pixelBasedSizeRegex().exec(width);\n\n    if (pixelMatch !== null) {\n      var intWidth = parseInt(pixelMatch[1], 10);\n      return pixelSize(intWidth);\n    }\n\n    var fallbackWidth = get$5(element);\n    return pixelSize(fallbackWidth);\n  };\n\n  var getTableSize = function getTableSize(element) {\n    var width = Sizes.getRawWidth(element);\n    return width.fold(function () {\n      var fallbackWidth = get$5(element);\n      return pixelSize(fallbackWidth);\n    }, function (w) {\n      return chooseSize(element, w);\n    });\n  };\n\n  var TableSize = {\n    getTableSize: getTableSize\n  };\n\n  var getWarehouse$1 = function getWarehouse$1(list) {\n    return Warehouse.generate(list);\n  };\n\n  var sumUp = function sumUp(newSize) {\n    return foldr(newSize, function (b, a) {\n      return b + a;\n    }, 0);\n  };\n\n  var getTableWarehouse = function getTableWarehouse(table) {\n    var list = DetailsList.fromTable(table);\n    return getWarehouse$1(list);\n  };\n\n  var adjustWidth = function adjustWidth(table, delta, index, direction) {\n    var tableSize = TableSize.getTableSize(table);\n    var step = tableSize.getCellDelta(delta);\n    var warehouse = getTableWarehouse(table);\n    var widths = tableSize.getWidths(warehouse, direction, tableSize);\n    var deltas = Deltas.determine(widths, index, step, tableSize);\n    var newWidths = map(deltas, function (dx, i) {\n      return dx + widths[i];\n    });\n    var newSizes = Recalculations.recalculateWidth(warehouse, newWidths);\n    each(newSizes, function (cell) {\n      tableSize.setElementWidth(cell.element(), cell.width());\n    });\n\n    if (index === warehouse.grid().columns() - 1) {\n      tableSize.setTableWidth(table, newWidths, step);\n    }\n  };\n\n  var adjustHeight = function adjustHeight(table, delta, index, direction) {\n    var warehouse = getTableWarehouse(table);\n    var heights = ColumnSizes.getPixelHeights(warehouse, direction);\n    var newHeights = map(heights, function (dy, i) {\n      return index === i ? Math.max(delta + dy, CellUtils.minHeight()) : dy;\n    });\n    var newCellSizes = Recalculations.recalculateHeight(warehouse, newHeights);\n    var newRowSizes = Recalculations.matchRowHeight(warehouse, newHeights);\n    each(newRowSizes, function (row) {\n      Sizes.setHeight(row.element(), row.height());\n    });\n    each(newCellSizes, function (cell) {\n      Sizes.setHeight(cell.element(), cell.height());\n    });\n    var total = sumUp(newHeights);\n    Sizes.setHeight(table, total);\n  };\n\n  var adjustWidthTo = function adjustWidthTo(table, list, direction) {\n    var tableSize = TableSize.getTableSize(table);\n    var warehouse = getWarehouse$1(list);\n    var widths = tableSize.getWidths(warehouse, direction, tableSize);\n    var newSizes = Recalculations.recalculateWidth(warehouse, widths);\n    each(newSizes, function (cell) {\n      tableSize.setElementWidth(cell.element(), cell.width());\n    });\n\n    if (newSizes.length > 0) {\n      tableSize.setTableWidth(table, widths, tableSize.getCellDelta(0));\n    }\n  };\n\n  var Adjustments = {\n    adjustWidth: adjustWidth,\n    adjustHeight: adjustHeight,\n    adjustWidthTo: adjustWidthTo\n  };\n\n  var base = function base(handleUnsupported, required) {\n    return baseWith(handleUnsupported, required, {\n      validate: isFunction,\n      label: 'function'\n    });\n  };\n\n  var baseWith = function baseWith(handleUnsupported, required, pred) {\n    if (required.length === 0) {\n      throw new Error('You must specify at least one required field.');\n    }\n\n    validateStrArr('required', required);\n    checkDupes(required);\n    return function (obj) {\n      var keys$1 = keys(obj);\n      var allReqd = forall(required, function (req) {\n        return contains(keys$1, req);\n      });\n\n      if (!allReqd) {\n        reqMessage(required, keys$1);\n      }\n\n      handleUnsupported(required, keys$1);\n      var invalidKeys = filter(required, function (key) {\n        return !pred.validate(obj[key], key);\n      });\n\n      if (invalidKeys.length > 0) {\n        invalidTypeMessage(invalidKeys, pred.label);\n      }\n\n      return obj;\n    };\n  };\n\n  var handleExact = function handleExact(required, keys) {\n    var unsupported = filter(keys, function (key) {\n      return !contains(required, key);\n    });\n\n    if (unsupported.length > 0) {\n      unsuppMessage(unsupported);\n    }\n  };\n\n  var exactly = function exactly(required) {\n    return base(handleExact, required);\n  };\n\n  var verifyGenerators = exactly(['cell', 'row', 'replace', 'gap']);\n\n  var elementToData = function elementToData(element) {\n    var colspan = has$1(element, 'colspan') ? parseInt(get$1(element, 'colspan'), 10) : 1;\n    var rowspan = has$1(element, 'rowspan') ? parseInt(get$1(element, 'rowspan'), 10) : 1;\n    return {\n      element: constant(element),\n      colspan: constant(colspan),\n      rowspan: constant(rowspan)\n    };\n  };\n\n  var modification = function modification(generators, toData) {\n    if (toData === void 0) {\n      toData = elementToData;\n    }\n\n    verifyGenerators(generators);\n    var position = Cell(Option.none());\n\n    var nu = function nu(data) {\n      return generators.cell(data);\n    };\n\n    var nuFrom = function nuFrom(element) {\n      var data = toData(element);\n      return nu(data);\n    };\n\n    var add = function add(element) {\n      var replacement = nuFrom(element);\n\n      if (position.get().isNone()) {\n        position.set(Option.some(replacement));\n      }\n\n      recent = Option.some({\n        item: element,\n        replacement: replacement\n      });\n      return replacement;\n    };\n\n    var recent = Option.none();\n\n    var getOrInit = function getOrInit(element, comparator) {\n      return recent.fold(function () {\n        return add(element);\n      }, function (p) {\n        return comparator(element, p.item) ? p.replacement : add(element);\n      });\n    };\n\n    return {\n      getOrInit: getOrInit,\n      cursor: position.get\n    };\n  };\n\n  var transform = function transform(scope, tag) {\n    return function (generators) {\n      var position = Cell(Option.none());\n      verifyGenerators(generators);\n      var list = [];\n\n      var find$1 = function find$1(element, comparator) {\n        return find(list, function (x) {\n          return comparator(x.item, element);\n        });\n      };\n\n      var makeNew = function makeNew(element) {\n        var attrs = {\n          scope: scope\n        };\n        var cell = generators.replace(element, tag, attrs);\n        list.push({\n          item: element,\n          sub: cell\n        });\n\n        if (position.get().isNone()) {\n          position.set(Option.some(cell));\n        }\n\n        return cell;\n      };\n\n      var replaceOrInit = function replaceOrInit(element, comparator) {\n        return find$1(element, comparator).fold(function () {\n          return makeNew(element);\n        }, function (p) {\n          return comparator(element, p.item) ? p.sub : makeNew(element);\n        });\n      };\n\n      return {\n        replaceOrInit: replaceOrInit,\n        cursor: position.get\n      };\n    };\n  };\n\n  var merging = function merging(generators) {\n    verifyGenerators(generators);\n    var position = Cell(Option.none());\n\n    var combine = function combine(cell) {\n      if (position.get().isNone()) {\n        position.set(Option.some(cell));\n      }\n\n      return function () {\n        var raw = generators.cell({\n          element: constant(cell),\n          colspan: constant(1),\n          rowspan: constant(1)\n        });\n        remove$1(raw, 'width');\n        remove$1(cell, 'width');\n        return raw;\n      };\n    };\n\n    return {\n      combine: combine,\n      cursor: position.get\n    };\n  };\n\n  var Generators = {\n    modification: modification,\n    transform: transform,\n    merging: merging\n  };\n  var blockList = ['body', 'p', 'div', 'article', 'aside', 'figcaption', 'figure', 'footer', 'header', 'nav', 'section', 'ol', 'ul', 'table', 'thead', 'tfoot', 'tbody', 'caption', 'tr', 'td', 'th', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'address'];\n\n  var isList = function isList(universe, item) {\n    var tagName = universe.property().name(item);\n    return contains(['ol', 'ul'], tagName);\n  };\n\n  var isBlock = function isBlock(universe, item) {\n    var tagName = universe.property().name(item);\n    return contains(blockList, tagName);\n  };\n\n  var isFormatting = function isFormatting(universe, item) {\n    var tagName = universe.property().name(item);\n    return contains(['address', 'pre', 'p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6'], tagName);\n  };\n\n  var isHeading = function isHeading(universe, item) {\n    var tagName = universe.property().name(item);\n    return contains(['h1', 'h2', 'h3', 'h4', 'h5', 'h6'], tagName);\n  };\n\n  var isContainer = function isContainer(universe, item) {\n    return contains(['div', 'li', 'td', 'th', 'blockquote', 'body', 'caption'], universe.property().name(item));\n  };\n\n  var isEmptyTag = function isEmptyTag(universe, item) {\n    return contains(['br', 'img', 'hr', 'input'], universe.property().name(item));\n  };\n\n  var isFrame = function isFrame(universe, item) {\n    return universe.property().name(item) === 'iframe';\n  };\n\n  var isInline = function isInline(universe, item) {\n    return !(isBlock(universe, item) || isEmptyTag(universe, item)) && universe.property().name(item) !== 'li';\n  };\n\n  var Structure = {\n    isBlock: isBlock,\n    isList: isList,\n    isFormatting: isFormatting,\n    isHeading: isHeading,\n    isContainer: isContainer,\n    isEmptyTag: isEmptyTag,\n    isFrame: isFrame,\n    isInline: isInline\n  };\n  var universe$1 = DomUniverse();\n\n  var isBlock$1 = function isBlock$1(element) {\n    return Structure.isBlock(universe$1, element);\n  };\n\n  var isList$1 = function isList$1(element) {\n    return Structure.isList(universe$1, element);\n  };\n\n  var isFormatting$1 = function isFormatting$1(element) {\n    return Structure.isFormatting(universe$1, element);\n  };\n\n  var isHeading$1 = function isHeading$1(element) {\n    return Structure.isHeading(universe$1, element);\n  };\n\n  var isContainer$1 = function isContainer$1(element) {\n    return Structure.isContainer(universe$1, element);\n  };\n\n  var isEmptyTag$1 = function isEmptyTag$1(element) {\n    return Structure.isEmptyTag(universe$1, element);\n  };\n\n  var isFrame$1 = function isFrame$1(element) {\n    return Structure.isFrame(universe$1, element);\n  };\n\n  var isInline$1 = function isInline$1(element) {\n    return Structure.isInline(universe$1, element);\n  };\n\n  var DomStructure = {\n    isBlock: isBlock$1,\n    isList: isList$1,\n    isFormatting: isFormatting$1,\n    isHeading: isHeading$1,\n    isContainer: isContainer$1,\n    isEmptyTag: isEmptyTag$1,\n    isFrame: isFrame$1,\n    isInline: isInline$1\n  };\n\n  var merge$2 = function merge$2(cells) {\n    var isBr = function isBr(el) {\n      return name(el) === 'br';\n    };\n\n    var advancedBr = function advancedBr(children) {\n      return forall(children, function (c) {\n        return isBr(c) || isText(c) && get$3(c).trim().length === 0;\n      });\n    };\n\n    var isListItem = function isListItem(el) {\n      return name(el) === 'li' || ancestor(el, DomStructure.isList).isSome();\n    };\n\n    var siblingIsBlock = function siblingIsBlock(el) {\n      return nextSibling(el).map(function (rightSibling) {\n        if (DomStructure.isBlock(rightSibling)) {\n          return true;\n        }\n\n        if (DomStructure.isEmptyTag(rightSibling)) {\n          return name(rightSibling) === 'img' ? false : true;\n        }\n\n        return false;\n      }).getOr(false);\n    };\n\n    var markCell = function markCell(cell) {\n      return last$1(cell).bind(function (rightEdge) {\n        var rightSiblingIsBlock = siblingIsBlock(rightEdge);\n        return parent(rightEdge).map(function (parent) {\n          return rightSiblingIsBlock === true || isListItem(parent) || isBr(rightEdge) || DomStructure.isBlock(parent) && !eq(cell, parent) ? [] : [Element.fromTag('br')];\n        });\n      }).getOr([]);\n    };\n\n    var markContent = function markContent() {\n      var content = bind(cells, function (cell) {\n        var children$1 = children(cell);\n        return advancedBr(children$1) ? [] : children$1.concat(markCell(cell));\n      });\n      return content.length === 0 ? [Element.fromTag('br')] : content;\n    };\n\n    var contents = markContent();\n    empty(cells[0]);\n    append$1(cells[0], contents);\n  };\n\n  var TableContent = {\n    merge: merge$2\n  };\n\n  var prune = function prune(table) {\n    var cells = TableLookup.cells(table);\n\n    if (cells.length === 0) {\n      remove$2(table);\n    }\n  };\n\n  var outcome = Immutable('grid', 'cursor');\n\n  var elementFromGrid = function elementFromGrid(grid, row, column) {\n    return findIn(grid, row, column).orThunk(function () {\n      return findIn(grid, 0, 0);\n    });\n  };\n\n  var findIn = function findIn(grid, row, column) {\n    return Option.from(grid[row]).bind(function (r) {\n      return Option.from(r.cells()[column]).bind(function (c) {\n        return Option.from(c.element());\n      });\n    });\n  };\n\n  var bundle = function bundle(grid, row, column) {\n    return outcome(grid, findIn(grid, row, column));\n  };\n\n  var uniqueRows = function uniqueRows(details) {\n    return foldl(details, function (rest, detail) {\n      return exists(rest, function (currentDetail) {\n        return currentDetail.row() === detail.row();\n      }) ? rest : rest.concat([detail]);\n    }, []).sort(function (detailA, detailB) {\n      return detailA.row() - detailB.row();\n    });\n  };\n\n  var uniqueColumns = function uniqueColumns(details) {\n    return foldl(details, function (rest, detail) {\n      return exists(rest, function (currentDetail) {\n        return currentDetail.column() === detail.column();\n      }) ? rest : rest.concat([detail]);\n    }, []).sort(function (detailA, detailB) {\n      return detailA.column() - detailB.column();\n    });\n  };\n\n  var insertRowBefore = function insertRowBefore(grid, detail, comparator, genWrappers) {\n    var example = detail.row();\n    var targetIndex = detail.row();\n    var newGrid = ModificationOperations.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n    return bundle(newGrid, targetIndex, detail.column());\n  };\n\n  var insertRowsBefore = function insertRowsBefore(grid, details, comparator, genWrappers) {\n    var example = details[0].row();\n    var targetIndex = details[0].row();\n    var rows = uniqueRows(details);\n    var newGrid = foldl(rows, function (newG, _row) {\n      return ModificationOperations.insertRowAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n    }, grid);\n    return bundle(newGrid, targetIndex, details[0].column());\n  };\n\n  var insertRowAfter = function insertRowAfter(grid, detail, comparator, genWrappers) {\n    var example = detail.row();\n    var targetIndex = detail.row() + detail.rowspan();\n    var newGrid = ModificationOperations.insertRowAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n    return bundle(newGrid, targetIndex, detail.column());\n  };\n\n  var insertRowsAfter = function insertRowsAfter(grid, details, comparator, genWrappers) {\n    var rows = uniqueRows(details);\n    var example = rows[rows.length - 1].row();\n    var targetIndex = rows[rows.length - 1].row() + rows[rows.length - 1].rowspan();\n    var newGrid = foldl(rows, function (newG, _row) {\n      return ModificationOperations.insertRowAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n    }, grid);\n    return bundle(newGrid, targetIndex, details[0].column());\n  };\n\n  var insertColumnBefore = function insertColumnBefore(grid, detail, comparator, genWrappers) {\n    var example = detail.column();\n    var targetIndex = detail.column();\n    var newGrid = ModificationOperations.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n    return bundle(newGrid, detail.row(), targetIndex);\n  };\n\n  var insertColumnsBefore = function insertColumnsBefore(grid, details, comparator, genWrappers) {\n    var columns = uniqueColumns(details);\n    var example = columns[0].column();\n    var targetIndex = columns[0].column();\n    var newGrid = foldl(columns, function (newG, _row) {\n      return ModificationOperations.insertColumnAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n    }, grid);\n    return bundle(newGrid, details[0].row(), targetIndex);\n  };\n\n  var insertColumnAfter = function insertColumnAfter(grid, detail, comparator, genWrappers) {\n    var example = detail.column();\n    var targetIndex = detail.column() + detail.colspan();\n    var newGrid = ModificationOperations.insertColumnAt(grid, targetIndex, example, comparator, genWrappers.getOrInit);\n    return bundle(newGrid, detail.row(), targetIndex);\n  };\n\n  var insertColumnsAfter = function insertColumnsAfter(grid, details, comparator, genWrappers) {\n    var example = details[details.length - 1].column();\n    var targetIndex = details[details.length - 1].column() + details[details.length - 1].colspan();\n    var columns = uniqueColumns(details);\n    var newGrid = foldl(columns, function (newG, _row) {\n      return ModificationOperations.insertColumnAt(newG, targetIndex, example, comparator, genWrappers.getOrInit);\n    }, grid);\n    return bundle(newGrid, details[0].row(), targetIndex);\n  };\n\n  var makeRowHeader = function makeRowHeader(grid, detail, comparator, genWrappers) {\n    var newGrid = TransformOperations.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, detail.row(), detail.column());\n  };\n\n  var makeColumnHeader = function makeColumnHeader(grid, detail, comparator, genWrappers) {\n    var newGrid = TransformOperations.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, detail.row(), detail.column());\n  };\n\n  var unmakeRowHeader = function unmakeRowHeader(grid, detail, comparator, genWrappers) {\n    var newGrid = TransformOperations.replaceRow(grid, detail.row(), comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, detail.row(), detail.column());\n  };\n\n  var unmakeColumnHeader = function unmakeColumnHeader(grid, detail, comparator, genWrappers) {\n    var newGrid = TransformOperations.replaceColumn(grid, detail.column(), comparator, genWrappers.replaceOrInit);\n    return bundle(newGrid, detail.row(), detail.column());\n  };\n\n  var splitCellIntoColumns$1 = function splitCellIntoColumns$1(grid, detail, comparator, genWrappers) {\n    var newGrid = ModificationOperations.splitCellIntoColumns(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n    return bundle(newGrid, detail.row(), detail.column());\n  };\n\n  var splitCellIntoRows$1 = function splitCellIntoRows$1(grid, detail, comparator, genWrappers) {\n    var newGrid = ModificationOperations.splitCellIntoRows(grid, detail.row(), detail.column(), comparator, genWrappers.getOrInit);\n    return bundle(newGrid, detail.row(), detail.column());\n  };\n\n  var eraseColumns = function eraseColumns(grid, details, _comparator, _genWrappers) {\n    var columns = uniqueColumns(details);\n    var newGrid = ModificationOperations.deleteColumnsAt(grid, columns[0].column(), columns[columns.length - 1].column());\n    var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n    return outcome(newGrid, cursor);\n  };\n\n  var eraseRows = function eraseRows(grid, details, _comparator, _genWrappers) {\n    var rows = uniqueRows(details);\n    var newGrid = ModificationOperations.deleteRowsAt(grid, rows[0].row(), rows[rows.length - 1].row());\n    var cursor = elementFromGrid(newGrid, details[0].row(), details[0].column());\n    return outcome(newGrid, cursor);\n  };\n\n  var mergeCells = function mergeCells(grid, mergable, comparator, _genWrappers) {\n    var cells = mergable.cells();\n    TableContent.merge(cells);\n    var newGrid = MergingOperations.merge(grid, mergable.bounds(), comparator, constant(cells[0]));\n    return outcome(newGrid, Option.from(cells[0]));\n  };\n\n  var unmergeCells = function unmergeCells(grid, unmergable, comparator, genWrappers) {\n    var newGrid = foldr(unmergable, function (b, cell) {\n      return MergingOperations.unmerge(b, cell, comparator, genWrappers.combine(cell));\n    }, grid);\n    return outcome(newGrid, Option.from(unmergable[0]));\n  };\n\n  var pasteCells = function pasteCells(grid, pasteDetails, comparator, _genWrappers) {\n    var gridify = function gridify(table, generators) {\n      var list = DetailsList.fromTable(table);\n      var wh = Warehouse.generate(list);\n      return Transitions.toGrid(wh, generators, true);\n    };\n\n    var gridB = gridify(pasteDetails.clipboard(), pasteDetails.generators());\n    var startAddress = address(pasteDetails.row(), pasteDetails.column());\n    var mergedGrid = TableMerge.merge(startAddress, grid, gridB, pasteDetails.generators(), comparator);\n    return mergedGrid.fold(function () {\n      return outcome(grid, Option.some(pasteDetails.element()));\n    }, function (nuGrid) {\n      var cursor = elementFromGrid(nuGrid, pasteDetails.row(), pasteDetails.column());\n      return outcome(nuGrid, cursor);\n    });\n  };\n\n  var gridifyRows = function gridifyRows(rows, generators, example) {\n    var pasteDetails = DetailsList.fromPastedRows(rows, example);\n    var wh = Warehouse.generate(pasteDetails);\n    return Transitions.toGrid(wh, generators, true);\n  };\n\n  var pasteRowsBefore = function pasteRowsBefore(grid, pasteDetails, comparator, _genWrappers) {\n    var example = grid[pasteDetails.cells[0].row()];\n    var index = pasteDetails.cells[0].row();\n    var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n    var mergedGrid = TableMerge.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n    var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n    return outcome(mergedGrid, cursor);\n  };\n\n  var pasteRowsAfter = function pasteRowsAfter(grid, pasteDetails, comparator, _genWrappers) {\n    var example = grid[pasteDetails.cells[0].row()];\n    var index = pasteDetails.cells[pasteDetails.cells.length - 1].row() + pasteDetails.cells[pasteDetails.cells.length - 1].rowspan();\n    var gridB = gridifyRows(pasteDetails.clipboard(), pasteDetails.generators(), example);\n    var mergedGrid = TableMerge.insert(index, grid, gridB, pasteDetails.generators(), comparator);\n    var cursor = elementFromGrid(mergedGrid, pasteDetails.cells[0].row(), pasteDetails.cells[0].column());\n    return outcome(mergedGrid, cursor);\n  };\n\n  var resize = Adjustments.adjustWidthTo;\n  var TableOperations = {\n    insertRowBefore: run(insertRowBefore, onCell, noop, noop, Generators.modification),\n    insertRowsBefore: run(insertRowsBefore, onCells, noop, noop, Generators.modification),\n    insertRowAfter: run(insertRowAfter, onCell, noop, noop, Generators.modification),\n    insertRowsAfter: run(insertRowsAfter, onCells, noop, noop, Generators.modification),\n    insertColumnBefore: run(insertColumnBefore, onCell, resize, noop, Generators.modification),\n    insertColumnsBefore: run(insertColumnsBefore, onCells, resize, noop, Generators.modification),\n    insertColumnAfter: run(insertColumnAfter, onCell, resize, noop, Generators.modification),\n    insertColumnsAfter: run(insertColumnsAfter, onCells, resize, noop, Generators.modification),\n    splitCellIntoColumns: run(splitCellIntoColumns$1, onCell, resize, noop, Generators.modification),\n    splitCellIntoRows: run(splitCellIntoRows$1, onCell, noop, noop, Generators.modification),\n    eraseColumns: run(eraseColumns, onCells, resize, prune, Generators.modification),\n    eraseRows: run(eraseRows, onCells, noop, prune, Generators.modification),\n    makeColumnHeader: run(makeColumnHeader, onCell, noop, noop, Generators.transform('row', 'th')),\n    unmakeColumnHeader: run(unmakeColumnHeader, onCell, noop, noop, Generators.transform(null, 'td')),\n    makeRowHeader: run(makeRowHeader, onCell, noop, noop, Generators.transform('col', 'th')),\n    unmakeRowHeader: run(unmakeRowHeader, onCell, noop, noop, Generators.transform(null, 'td')),\n    mergeCells: run(mergeCells, onMergable, noop, noop, Generators.merging),\n    unmergeCells: run(unmergeCells, onUnmergable, resize, noop, Generators.merging),\n    pasteCells: run(pasteCells, onPaste, resize, noop, Generators.modification),\n    pasteRowsBefore: run(pasteRowsBefore, onPasteRows, noop, noop, Generators.modification),\n    pasteRowsAfter: run(pasteRowsAfter, onPasteRows, noop, noop, Generators.modification)\n  };\n\n  var getBody$1 = function getBody$1(editor) {\n    return Element.fromDom(editor.getBody());\n  };\n\n  var getPixelWidth$1 = function getPixelWidth$1(elm) {\n    return elm.getBoundingClientRect().width;\n  };\n\n  var getPixelHeight = function getPixelHeight(elm) {\n    return elm.getBoundingClientRect().height;\n  };\n\n  var getIsRoot = function getIsRoot(editor) {\n    return function (element) {\n      return eq(element, getBody$1(editor));\n    };\n  };\n\n  var removePxSuffix = function removePxSuffix(size) {\n    return size ? size.replace(/px$/, '') : '';\n  };\n\n  var addSizeSuffix = function addSizeSuffix(size) {\n    if (/^[0-9]+$/.test(size)) {\n      size += 'px';\n    }\n\n    return size;\n  };\n\n  var removeDataStyle = function removeDataStyle(table) {\n    var dataStyleCells = descendants$1(table, 'td[data-mce-style],th[data-mce-style]');\n    remove(table, 'data-mce-style');\n    each(dataStyleCells, function (cell) {\n      remove(cell, 'data-mce-style');\n    });\n  };\n\n  var getDirection = function getDirection(element) {\n    return get$2(element, 'direction') === 'rtl' ? 'rtl' : 'ltr';\n  };\n\n  var ltr$1 = {\n    isRtl: constant(false)\n  };\n  var rtl$1 = {\n    isRtl: constant(true)\n  };\n\n  var directionAt = function directionAt(element) {\n    var dir = getDirection(element);\n    return dir === 'rtl' ? rtl$1 : ltr$1;\n  };\n\n  var Direction = {\n    directionAt: directionAt\n  };\n  var defaultTableToolbar = 'tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol';\n  var defaultStyles = {\n    'border-collapse': 'collapse',\n    'width': '100%'\n  };\n  var defaultAttributes = {\n    border: '1'\n  };\n\n  var getDefaultAttributes = function getDefaultAttributes(editor) {\n    return editor.getParam('table_default_attributes', defaultAttributes, 'object');\n  };\n\n  var getDefaultStyles = function getDefaultStyles(editor) {\n    return editor.getParam('table_default_styles', defaultStyles, 'object');\n  };\n\n  var hasTableResizeBars = function hasTableResizeBars(editor) {\n    return editor.getParam('table_resize_bars', true, 'boolean');\n  };\n\n  var hasTabNavigation = function hasTabNavigation(editor) {\n    return editor.getParam('table_tab_navigation', true, 'boolean');\n  };\n\n  var hasAdvancedCellTab = function hasAdvancedCellTab(editor) {\n    return editor.getParam('table_cell_advtab', true, 'boolean');\n  };\n\n  var hasAdvancedRowTab = function hasAdvancedRowTab(editor) {\n    return editor.getParam('table_row_advtab', true, 'boolean');\n  };\n\n  var hasAdvancedTableTab = function hasAdvancedTableTab(editor) {\n    return editor.getParam('table_advtab', true, 'boolean');\n  };\n\n  var hasAppearanceOptions = function hasAppearanceOptions(editor) {\n    return editor.getParam('table_appearance_options', true, 'boolean');\n  };\n\n  var hasTableGrid = function hasTableGrid(editor) {\n    return editor.getParam('table_grid', true, 'boolean');\n  };\n\n  var shouldStyleWithCss = function shouldStyleWithCss(editor) {\n    return editor.getParam('table_style_by_css', false, 'boolean');\n  };\n\n  var getCellClassList = function getCellClassList(editor) {\n    return editor.getParam('table_cell_class_list', [], 'array');\n  };\n\n  var getRowClassList = function getRowClassList(editor) {\n    return editor.getParam('table_row_class_list', [], 'array');\n  };\n\n  var getTableClassList = function getTableClassList(editor) {\n    return editor.getParam('table_class_list', [], 'array');\n  };\n\n  var isPercentagesForced = function isPercentagesForced(editor) {\n    return editor.getParam('table_responsive_width') === true;\n  };\n\n  var isPixelsForced = function isPixelsForced(editor) {\n    return editor.getParam('table_responsive_width') === false;\n  };\n\n  var getToolbar = function getToolbar(editor) {\n    return editor.getParam('table_toolbar', defaultTableToolbar);\n  };\n\n  var getCloneElements = function getCloneElements(editor) {\n    var cloneElements = editor.getParam('table_clone_elements');\n\n    if (isString(cloneElements)) {\n      return Option.some(cloneElements.split(/[ ,]/));\n    } else if (Array.isArray(cloneElements)) {\n      return Option.some(cloneElements);\n    } else {\n      return Option.none();\n    }\n  };\n\n  var hasObjectResizing = function hasObjectResizing(editor) {\n    var objectResizing = editor.getParam('object_resizing', true);\n    return isString(objectResizing) ? objectResizing === 'table' : objectResizing;\n  };\n\n  var fireNewRow = function fireNewRow(editor, row) {\n    return editor.fire('newrow', {\n      node: row\n    });\n  };\n\n  var fireNewCell = function fireNewCell(editor, cell) {\n    return editor.fire('newcell', {\n      node: cell\n    });\n  };\n\n  var fireObjectResizeStart = function fireObjectResizeStart(editor, target, width, height) {\n    editor.fire('ObjectResizeStart', {\n      target: target,\n      width: width,\n      height: height\n    });\n  };\n\n  var fireObjectResized = function fireObjectResized(editor, target, width, height) {\n    editor.fire('ObjectResized', {\n      target: target,\n      width: width,\n      height: height\n    });\n  };\n\n  var TableActions = function TableActions(editor, lazyWire) {\n    var isTableBody = function isTableBody(editor) {\n      return name(getBody$1(editor)) === 'table';\n    };\n\n    var lastRowGuard = function lastRowGuard(table) {\n      var size = TableGridSize.getGridSize(table);\n      return isTableBody(editor) === false || size.rows() > 1;\n    };\n\n    var lastColumnGuard = function lastColumnGuard(table) {\n      var size = TableGridSize.getGridSize(table);\n      return isTableBody(editor) === false || size.columns() > 1;\n    };\n\n    var cloneFormats = getCloneElements(editor);\n\n    var execute = function execute(operation, guard, mutate, lazyWire) {\n      return function (table, target) {\n        removeDataStyle(table);\n        var wire = lazyWire();\n        var doc = Element.fromDom(editor.getDoc());\n        var direction = TableDirection(Direction.directionAt);\n        var generators = TableFill.cellOperations(mutate, doc, cloneFormats);\n        return guard(table) ? operation(wire, table, target, generators, direction).bind(function (result) {\n          each(result.newRows(), function (row) {\n            fireNewRow(editor, row.dom());\n          });\n          each(result.newCells(), function (cell) {\n            fireNewCell(editor, cell.dom());\n          });\n          return result.cursor().map(function (cell) {\n            var rng = editor.dom.createRng();\n            rng.setStart(cell.dom(), 0);\n            rng.setEnd(cell.dom(), 0);\n            return rng;\n          });\n        }) : Option.none();\n      };\n    };\n\n    var deleteRow = execute(TableOperations.eraseRows, lastRowGuard, noop, lazyWire);\n    var deleteColumn = execute(TableOperations.eraseColumns, lastColumnGuard, noop, lazyWire);\n    var insertRowsBefore = execute(TableOperations.insertRowsBefore, always, noop, lazyWire);\n    var insertRowsAfter = execute(TableOperations.insertRowsAfter, always, noop, lazyWire);\n    var insertColumnsBefore = execute(TableOperations.insertColumnsBefore, always, CellMutations.halve, lazyWire);\n    var insertColumnsAfter = execute(TableOperations.insertColumnsAfter, always, CellMutations.halve, lazyWire);\n    var mergeCells = execute(TableOperations.mergeCells, always, noop, lazyWire);\n    var unmergeCells = execute(TableOperations.unmergeCells, always, noop, lazyWire);\n    var pasteRowsBefore = execute(TableOperations.pasteRowsBefore, always, noop, lazyWire);\n    var pasteRowsAfter = execute(TableOperations.pasteRowsAfter, always, noop, lazyWire);\n    var pasteCells = execute(TableOperations.pasteCells, always, noop, lazyWire);\n    return {\n      deleteRow: deleteRow,\n      deleteColumn: deleteColumn,\n      insertRowsBefore: insertRowsBefore,\n      insertRowsAfter: insertRowsAfter,\n      insertColumnsBefore: insertColumnsBefore,\n      insertColumnsAfter: insertColumnsAfter,\n      mergeCells: mergeCells,\n      unmergeCells: unmergeCells,\n      pasteRowsBefore: pasteRowsBefore,\n      pasteRowsAfter: pasteRowsAfter,\n      pasteCells: pasteCells\n    };\n  };\n\n  var copyRows = function copyRows(table, target, generators) {\n    var list = DetailsList.fromTable(table);\n    var house = Warehouse.generate(list);\n    var details = onCells(house, target);\n    return details.map(function (selectedCells) {\n      var grid = Transitions.toGrid(house, generators, false);\n      var slicedGrid = grid.slice(selectedCells[0].row(), selectedCells[selectedCells.length - 1].row() + selectedCells[selectedCells.length - 1].rowspan());\n      var slicedDetails = toDetailList(slicedGrid, generators);\n      return Redraw.copy(slicedDetails);\n    });\n  };\n\n  var CopyRows = {\n    copyRows: copyRows\n  };\n  var global$1 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var getTDTHOverallStyle = function getTDTHOverallStyle(dom, elm, name) {\n    var cells = dom.select('td,th', elm);\n    var firstChildStyle;\n\n    var checkChildren = function checkChildren(firstChildStyle, elms) {\n      for (var i = 0; i < elms.length; i++) {\n        var currentStyle = dom.getStyle(elms[i], name);\n\n        if (typeof firstChildStyle === 'undefined') {\n          firstChildStyle = currentStyle;\n        }\n\n        if (firstChildStyle !== currentStyle) {\n          return '';\n        }\n      }\n\n      return firstChildStyle;\n    };\n\n    firstChildStyle = checkChildren(firstChildStyle, cells);\n    return firstChildStyle;\n  };\n\n  var applyAlign = function applyAlign(editor, elm, name) {\n    if (name) {\n      editor.formatter.apply('align' + name, {}, elm);\n    }\n  };\n\n  var applyVAlign = function applyVAlign(editor, elm, name) {\n    if (name) {\n      editor.formatter.apply('valign' + name, {}, elm);\n    }\n  };\n\n  var unApplyAlign = function unApplyAlign(editor, elm) {\n    global$1.each('left center right'.split(' '), function (name) {\n      editor.formatter.remove('align' + name, {}, elm);\n    });\n  };\n\n  var unApplyVAlign = function unApplyVAlign(editor, elm) {\n    global$1.each('top middle bottom'.split(' '), function (name) {\n      editor.formatter.remove('valign' + name, {}, elm);\n    });\n  };\n\n  var Styles$1 = {\n    applyAlign: applyAlign,\n    applyVAlign: applyVAlign,\n    unApplyAlign: unApplyAlign,\n    unApplyVAlign: unApplyVAlign,\n    getTDTHOverallStyle: getTDTHOverallStyle\n  };\n\n  var buildListItems = function buildListItems(inputList, itemCallback, startItems) {\n    var appendItems = function appendItems(values, output) {\n      output = output || [];\n      global$1.each(values, function (item) {\n        var menuItem = {\n          text: item.text || item.title\n        };\n\n        if (item.menu) {\n          menuItem.menu = appendItems(item.menu);\n        } else {\n          menuItem.value = item.value;\n\n          if (itemCallback) {\n            itemCallback(menuItem);\n          }\n        }\n\n        output.push(menuItem);\n      });\n      return output;\n    };\n\n    return appendItems(inputList, startItems || []);\n  };\n\n  var extractAdvancedStyles = function extractAdvancedStyles(dom, elm) {\n    var rgbToHex = function rgbToHex(value) {\n      return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n    };\n\n    var borderStyle = getRaw(Element.fromDom(elm), 'border-style').getOr('');\n    var borderColor = getRaw(Element.fromDom(elm), 'border-color').map(rgbToHex).getOr('');\n    var bgColor = getRaw(Element.fromDom(elm), 'background-color').map(rgbToHex).getOr('');\n    return {\n      borderstyle: borderStyle,\n      bordercolor: borderColor,\n      backgroundcolor: bgColor\n    };\n  };\n\n  var getSharedValues = function getSharedValues(data) {\n    var baseData = data[0];\n    var comparisonData = data.slice(1);\n    var keys$1 = keys(baseData);\n    each(comparisonData, function (items) {\n      each(keys$1, function (key) {\n        each$1(items, function (itemValue, itemKey, _) {\n          var comparisonValue = baseData[key];\n\n          if (comparisonValue !== '' && key === itemKey) {\n            if (comparisonValue !== itemValue) {\n              baseData[key] = '';\n            }\n          }\n        });\n      });\n    });\n    return baseData;\n  };\n\n  var getAdvancedTab = function getAdvancedTab() {\n    var items = [{\n      name: 'borderstyle',\n      type: 'selectbox',\n      label: 'Border style',\n      items: [{\n        text: 'Select...',\n        value: ''\n      }, {\n        text: 'Solid',\n        value: 'solid'\n      }, {\n        text: 'Dotted',\n        value: 'dotted'\n      }, {\n        text: 'Dashed',\n        value: 'dashed'\n      }, {\n        text: 'Double',\n        value: 'double'\n      }, {\n        text: 'Groove',\n        value: 'groove'\n      }, {\n        text: 'Ridge',\n        value: 'ridge'\n      }, {\n        text: 'Inset',\n        value: 'inset'\n      }, {\n        text: 'Outset',\n        value: 'outset'\n      }, {\n        text: 'None',\n        value: 'none'\n      }, {\n        text: 'Hidden',\n        value: 'hidden'\n      }]\n    }, {\n      name: 'bordercolor',\n      type: 'colorinput',\n      label: 'Border color'\n    }, {\n      name: 'backgroundcolor',\n      type: 'colorinput',\n      label: 'Background color'\n    }];\n    return {\n      title: 'Advanced',\n      name: 'advanced',\n      items: items\n    };\n  };\n\n  var getAlignment = function getAlignment(alignments, formatName, dataName, editor, elm) {\n    var alignmentData = {};\n    global$1.each(alignments.split(' '), function (name) {\n      if (editor.formatter.matchNode(elm, formatName + name)) {\n        alignmentData[dataName] = name;\n      }\n    });\n\n    if (!alignmentData[dataName]) {\n      alignmentData[dataName] = '';\n    }\n\n    return alignmentData;\n  };\n\n  var getHAlignment = curry(getAlignment, 'left center right');\n  var getVAlignment = curry(getAlignment, 'top middle bottom');\n\n  var extractDataFromSettings = function extractDataFromSettings(editor, hasAdvTableTab) {\n    var style = getDefaultStyles(editor);\n    var attrs = getDefaultAttributes(editor);\n\n    var extractAdvancedStyleData = function extractAdvancedStyleData(dom) {\n      var rgbToHex = function rgbToHex(value) {\n        return startsWith(value, 'rgb') ? dom.toHex(value) : value;\n      };\n\n      var borderStyle = get(style, 'border-style').getOr('');\n      var borderColor = get(style, 'border-color').getOr('');\n      var bgColor = get(style, 'background-color').getOr('');\n      return {\n        borderstyle: borderStyle,\n        bordercolor: rgbToHex(borderColor),\n        backgroundcolor: rgbToHex(bgColor)\n      };\n    };\n\n    var defaultData = {\n      height: '',\n      width: '100%',\n      cellspacing: '',\n      cellpadding: '',\n      caption: false,\n      \"class\": '',\n      align: '',\n      border: ''\n    };\n\n    var getBorder = function getBorder() {\n      var borderWidth = style['border-width'];\n\n      if (shouldStyleWithCss(editor) && borderWidth) {\n        return {\n          border: borderWidth\n        };\n      }\n\n      return get(attrs, 'border').fold(function () {\n        return {};\n      }, function (border) {\n        return {\n          border: border\n        };\n      });\n    };\n\n    var dom = editor.dom;\n    var advStyle = hasAdvTableTab ? extractAdvancedStyleData(dom) : {};\n\n    var getCellPaddingCellSpacing = function getCellPaddingCellSpacing() {\n      var spacing = get(style, 'border-spacing').or(get(attrs, 'cellspacing')).fold(function () {\n        return {};\n      }, function (cellspacing) {\n        return {\n          cellspacing: cellspacing\n        };\n      });\n      var padding = get(style, 'border-padding').or(get(attrs, 'cellpadding')).fold(function () {\n        return {};\n      }, function (cellpadding) {\n        return {\n          cellpadding: cellpadding\n        };\n      });\n      return _assign({}, spacing, padding);\n    };\n\n    var data = _assign({}, defaultData, style, attrs, advStyle, getBorder(), getCellPaddingCellSpacing());\n\n    return data;\n  };\n\n  var extractDataFromTableElement = function extractDataFromTableElement(editor, elm, hasAdvTableTab) {\n    var getBorder = function getBorder(dom, elm) {\n      var optBorderWidth = getRaw(Element.fromDom(elm), 'border-width');\n\n      if (shouldStyleWithCss(editor) && optBorderWidth.isSome()) {\n        return optBorderWidth.getOr('');\n      }\n\n      return dom.getAttrib(elm, 'border') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'border-width') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'border');\n    };\n\n    var dom = editor.dom;\n\n    var data = _assign({\n      width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n      height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n      cellspacing: dom.getStyle(elm, 'border-spacing') || dom.getAttrib(elm, 'cellspacing'),\n      cellpadding: dom.getAttrib(elm, 'cellpadding') || Styles$1.getTDTHOverallStyle(editor.dom, elm, 'padding'),\n      border: getBorder(dom, elm),\n      caption: !!dom.select('caption', elm)[0],\n      \"class\": dom.getAttrib(elm, 'class', '')\n    }, getHAlignment('align', 'align', editor, elm), hasAdvTableTab ? extractAdvancedStyles(dom, elm) : {});\n\n    return data;\n  };\n\n  var extractDataFromRowElement = function extractDataFromRowElement(editor, elm, hasAdvancedRowTab) {\n    var dom = editor.dom;\n\n    var data = _assign({\n      height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n      scope: dom.getAttrib(elm, 'scope'),\n      \"class\": dom.getAttrib(elm, 'class', ''),\n      align: '',\n      type: elm.parentNode.nodeName.toLowerCase()\n    }, getHAlignment('align', 'align', editor, elm), hasAdvancedRowTab ? extractAdvancedStyles(dom, elm) : {});\n\n    return data;\n  };\n\n  var extractDataFromCellElement = function extractDataFromCellElement(editor, elm, hasAdvancedCellTab) {\n    var dom = editor.dom;\n\n    var data = _assign({\n      width: dom.getStyle(elm, 'width') || dom.getAttrib(elm, 'width'),\n      height: dom.getStyle(elm, 'height') || dom.getAttrib(elm, 'height'),\n      scope: dom.getAttrib(elm, 'scope'),\n      celltype: elm.nodeName.toLowerCase(),\n      \"class\": dom.getAttrib(elm, 'class', '')\n    }, getHAlignment('align', 'halign', editor, elm), getVAlignment('valign', 'valign', editor, elm), hasAdvancedCellTab ? extractAdvancedStyles(dom, elm) : {});\n\n    return data;\n  };\n\n  var Helpers = {\n    buildListItems: buildListItems,\n    extractAdvancedStyles: extractAdvancedStyles,\n    getSharedValues: getSharedValues,\n    getAdvancedTab: getAdvancedTab,\n    extractDataFromTableElement: extractDataFromTableElement,\n    extractDataFromRowElement: extractDataFromRowElement,\n    extractDataFromCellElement: extractDataFromCellElement,\n    extractDataFromSettings: extractDataFromSettings\n  };\n\n  var getClassList = function getClassList(editor) {\n    var rowClassList = getCellClassList(editor);\n    var classes = Helpers.buildListItems(rowClassList, function (item) {\n      if (item.value) {\n        item.textStyle = function () {\n          return editor.formatter.getCssText({\n            block: 'tr',\n            classes: [item.value]\n          });\n        };\n      }\n    });\n\n    if (rowClassList.length > 0) {\n      return Option.some({\n        name: 'class',\n        type: 'selectbox',\n        label: 'Class',\n        items: classes\n      });\n    }\n\n    return Option.none();\n  };\n\n  var children$3 = [{\n    name: 'width',\n    type: 'input',\n    label: 'Width'\n  }, {\n    name: 'height',\n    type: 'input',\n    label: 'Height'\n  }, {\n    name: 'celltype',\n    type: 'selectbox',\n    label: 'Cell type',\n    items: [{\n      text: 'Cell',\n      value: 'td'\n    }, {\n      text: 'Header cell',\n      value: 'th'\n    }]\n  }, {\n    name: 'scope',\n    type: 'selectbox',\n    label: 'Scope',\n    items: [{\n      text: 'None',\n      value: ''\n    }, {\n      text: 'Row',\n      value: 'row'\n    }, {\n      text: 'Column',\n      value: 'col'\n    }, {\n      text: 'Row group',\n      value: 'rowgroup'\n    }, {\n      text: 'Column group',\n      value: 'colgroup'\n    }]\n  }, {\n    name: 'halign',\n    type: 'selectbox',\n    label: 'H Align',\n    items: [{\n      text: 'None',\n      value: ''\n    }, {\n      text: 'Left',\n      value: 'left'\n    }, {\n      text: 'Center',\n      value: 'center'\n    }, {\n      text: 'Right',\n      value: 'right'\n    }]\n  }, {\n    name: 'valign',\n    type: 'selectbox',\n    label: 'V Align',\n    items: [{\n      text: 'None',\n      value: ''\n    }, {\n      text: 'Top',\n      value: 'top'\n    }, {\n      text: 'Middle',\n      value: 'middle'\n    }, {\n      text: 'Bottom',\n      value: 'bottom'\n    }]\n  }];\n\n  var getItems = function getItems(editor) {\n    return getClassList(editor).fold(function () {\n      return children$3;\n    }, function (classlist) {\n      return children$3.concat(classlist);\n    });\n  };\n\n  var CellDialogGeneralTab = {\n    getItems: getItems\n  };\n\n  var normal = function normal(dom, node) {\n    var setAttrib = function setAttrib(attr, value) {\n      dom.setAttrib(node, attr, value);\n    };\n\n    var setStyle = function setStyle(prop, value) {\n      dom.setStyle(node, prop, value);\n    };\n\n    return {\n      setAttrib: setAttrib,\n      setStyle: setStyle\n    };\n  };\n\n  var ifTruthy = function ifTruthy(dom, node) {\n    var setAttrib = function setAttrib(attr, value) {\n      if (value) {\n        dom.setAttrib(node, attr, value);\n      }\n    };\n\n    var setStyle = function setStyle(prop, value) {\n      if (value) {\n        dom.setStyle(node, prop, value);\n      }\n    };\n\n    return {\n      setAttrib: setAttrib,\n      setStyle: setStyle\n    };\n  };\n\n  var DomModifier = {\n    normal: normal,\n    ifTruthy: ifTruthy\n  };\n\n  var updateSimpleProps = function updateSimpleProps(modifiers, data) {\n    modifiers.setAttrib('scope', data.scope);\n    modifiers.setAttrib('class', data[\"class\"]);\n    modifiers.setStyle('width', addSizeSuffix(data.width));\n    modifiers.setStyle('height', addSizeSuffix(data.height));\n  };\n\n  var updateAdvancedProps = function updateAdvancedProps(modifiers, data) {\n    modifiers.setStyle('background-color', data.backgroundcolor);\n    modifiers.setStyle('border-color', data.bordercolor);\n    modifiers.setStyle('border-style', data.borderstyle);\n  };\n\n  var applyToSingle = function applyToSingle(editor, cells, data) {\n    var dom = editor.dom;\n    var cellElm = data.celltype && cells[0].nodeName.toLowerCase() !== data.celltype ? dom.rename(cells[0], data.celltype) : cells[0];\n    var modifiers = DomModifier.normal(dom, cellElm);\n    updateSimpleProps(modifiers, data);\n\n    if (hasAdvancedCellTab(editor)) {\n      updateAdvancedProps(modifiers, data);\n    }\n\n    Styles$1.unApplyAlign(editor, cellElm);\n    Styles$1.unApplyVAlign(editor, cellElm);\n\n    if (data.halign) {\n      Styles$1.applyAlign(editor, cellElm, data.halign);\n    }\n\n    if (data.valign) {\n      Styles$1.applyVAlign(editor, cellElm, data.valign);\n    }\n  };\n\n  var applyToMultiple = function applyToMultiple(editor, cells, data) {\n    var dom = editor.dom;\n    global$1.each(cells, function (cellElm) {\n      if (data.celltype && cellElm.nodeName.toLowerCase() !== data.celltype) {\n        cellElm = dom.rename(cellElm, data.celltype);\n      }\n\n      var modifiers = DomModifier.ifTruthy(dom, cellElm);\n      updateSimpleProps(modifiers, data);\n\n      if (hasAdvancedCellTab(editor)) {\n        updateAdvancedProps(modifiers, data);\n      }\n\n      if (data.halign) {\n        Styles$1.applyAlign(editor, cellElm, data.halign);\n      }\n\n      if (data.valign) {\n        Styles$1.applyVAlign(editor, cellElm, data.valign);\n      }\n    });\n  };\n\n  var onSubmitCellForm = function onSubmitCellForm(editor, cells, api) {\n    var data = api.getData();\n    api.close();\n    editor.undoManager.transact(function () {\n      var applicator = cells.length === 1 ? applyToSingle : applyToMultiple;\n      applicator(editor, cells, data);\n      editor.focus();\n    });\n  };\n\n  var open = function open(editor) {\n    var cellElm,\n        cells = [];\n    cells = editor.dom.select('td[data-mce-selected],th[data-mce-selected]');\n    cellElm = editor.dom.getParent(editor.selection.getStart(), 'td,th');\n\n    if (!cells.length && cellElm) {\n      cells.push(cellElm);\n    }\n\n    cellElm = cellElm || cells[0];\n\n    if (!cellElm) {\n      return;\n    }\n\n    var cellsData = global$1.map(cells, function (cellElm) {\n      return Helpers.extractDataFromCellElement(editor, cellElm, hasAdvancedCellTab(editor));\n    });\n    var data = Helpers.getSharedValues(cellsData);\n    var dialogTabPanel = {\n      type: 'tabpanel',\n      tabs: [{\n        title: 'General',\n        name: 'general',\n        items: CellDialogGeneralTab.getItems(editor)\n      }, Helpers.getAdvancedTab()]\n    };\n    var dialogPanel = {\n      type: 'panel',\n      items: [{\n        type: 'grid',\n        columns: 2,\n        items: CellDialogGeneralTab.getItems(editor)\n      }]\n    };\n    editor.windowManager.open({\n      title: 'Cell Properties',\n      size: 'normal',\n      body: hasAdvancedCellTab(editor) ? dialogTabPanel : dialogPanel,\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: data,\n      onSubmit: curry(onSubmitCellForm, editor, cells)\n    });\n  };\n\n  var CellDialog = {\n    open: open\n  };\n\n  var getClassList$1 = function getClassList$1(editor) {\n    var rowClassList = getRowClassList(editor);\n    var classes = Helpers.buildListItems(rowClassList, function (item) {\n      if (item.value) {\n        item.textStyle = function () {\n          return editor.formatter.getCssText({\n            block: 'tr',\n            classes: [item.value]\n          });\n        };\n      }\n    });\n\n    if (rowClassList.length > 0) {\n      return Option.some({\n        name: 'class',\n        type: 'selectbox',\n        label: 'Class',\n        items: classes\n      });\n    }\n\n    return Option.none();\n  };\n\n  var formChildren = [{\n    type: 'selectbox',\n    name: 'type',\n    label: 'Row type',\n    items: [{\n      text: 'Header',\n      value: 'thead'\n    }, {\n      text: 'Body',\n      value: 'tbody'\n    }, {\n      text: 'Footer',\n      value: 'tfoot'\n    }]\n  }, {\n    type: 'selectbox',\n    name: 'align',\n    label: 'Alignment',\n    items: [{\n      text: 'None',\n      value: ''\n    }, {\n      text: 'Left',\n      value: 'left'\n    }, {\n      text: 'Center',\n      value: 'center'\n    }, {\n      text: 'Right',\n      value: 'right'\n    }]\n  }, {\n    label: 'Height',\n    name: 'height',\n    type: 'input'\n  }];\n\n  var getItems$1 = function getItems$1(editor) {\n    return getClassList$1(editor).fold(function () {\n      return formChildren;\n    }, function (classes) {\n      return formChildren.concat(classes);\n    });\n  };\n\n  var RowDialogGeneralTab = {\n    getItems: getItems$1\n  };\n\n  var switchRowType = function switchRowType(dom, rowElm, toType) {\n    var tableElm = dom.getParent(rowElm, 'table');\n    var oldParentElm = rowElm.parentNode;\n    var parentElm = dom.select(toType, tableElm)[0];\n\n    if (!parentElm) {\n      parentElm = dom.create(toType);\n\n      if (tableElm.firstChild) {\n        if (tableElm.firstChild.nodeName === 'CAPTION') {\n          dom.insertAfter(parentElm, tableElm.firstChild);\n        } else {\n          tableElm.insertBefore(parentElm, tableElm.firstChild);\n        }\n      } else {\n        tableElm.appendChild(parentElm);\n      }\n    }\n\n    parentElm.appendChild(rowElm);\n\n    if (!oldParentElm.hasChildNodes()) {\n      dom.remove(oldParentElm);\n    }\n  };\n\n  var updateAdvancedProps$1 = function updateAdvancedProps$1(modifier, data) {\n    modifier.setStyle('background-color', data.backgroundcolor);\n    modifier.setStyle('border-color', data.bordercolor);\n    modifier.setStyle('border-style', data.borderstyle);\n  };\n\n  var onSubmitRowForm = function onSubmitRowForm(editor, rows, oldData, api) {\n    var dom = editor.dom;\n    var data = api.getData();\n    api.close();\n    var createModifier = rows.length === 1 ? DomModifier.normal : DomModifier.ifTruthy;\n    editor.undoManager.transact(function () {\n      global$1.each(rows, function (rowElm) {\n        if (data.type !== rowElm.parentNode.nodeName.toLowerCase()) {\n          switchRowType(editor.dom, rowElm, data.type);\n        }\n\n        var modifier = createModifier(dom, rowElm);\n        modifier.setAttrib('scope', data.scope);\n        modifier.setAttrib('class', data[\"class\"]);\n        modifier.setStyle('height', addSizeSuffix(data.height));\n\n        if (hasAdvancedRowTab(editor)) {\n          updateAdvancedProps$1(modifier, data);\n        }\n\n        if (data.align !== oldData.align) {\n          Styles$1.unApplyAlign(editor, rowElm);\n          Styles$1.applyAlign(editor, rowElm, data.align);\n        }\n      });\n      editor.focus();\n    });\n  };\n\n  var open$1 = function open$1(editor) {\n    var dom = editor.dom;\n    var tableElm, cellElm, rowElm;\n    var rows = [];\n    tableElm = dom.getParent(editor.selection.getStart(), 'table');\n\n    if (!tableElm) {\n      return;\n    }\n\n    cellElm = dom.getParent(editor.selection.getStart(), 'td,th');\n    global$1.each(tableElm.rows, function (row) {\n      global$1.each(row.cells, function (cell) {\n        if ((dom.getAttrib(cell, 'data-mce-selected') || cell === cellElm) && rows.indexOf(row) < 0) {\n          rows.push(row);\n          return false;\n        }\n      });\n    });\n    rowElm = rows[0];\n\n    if (!rowElm) {\n      return;\n    }\n\n    var rowsData = global$1.map(rows, function (rowElm) {\n      return Helpers.extractDataFromRowElement(editor, rowElm, hasAdvancedRowTab(editor));\n    });\n    var data = Helpers.getSharedValues(rowsData);\n    var dialogTabPanel = {\n      type: 'tabpanel',\n      tabs: [{\n        title: 'General',\n        name: 'general',\n        items: RowDialogGeneralTab.getItems(editor)\n      }, Helpers.getAdvancedTab()]\n    };\n    var dialogPanel = {\n      type: 'panel',\n      items: [{\n        type: 'grid',\n        columns: 2,\n        items: RowDialogGeneralTab.getItems(editor)\n      }]\n    };\n    editor.windowManager.open({\n      title: 'Row Properties',\n      size: 'normal',\n      body: hasAdvancedRowTab(editor) ? dialogTabPanel : dialogPanel,\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: data,\n      onSubmit: curry(onSubmitRowForm, editor, rows, data)\n    });\n  };\n\n  var RowDialog = {\n    open: open$1\n  };\n  var hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n  var shallow$1 = function shallow$1(old, nu) {\n    return nu;\n  };\n\n  var baseMerge = function baseMerge(merger) {\n    return function () {\n      var objects = new Array(arguments.length);\n\n      for (var i = 0; i < objects.length; i++) {\n        objects[i] = arguments[i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (hasOwnProperty$1.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var merge$3 = baseMerge(shallow$1);\n  var global$2 = tinymce.util.Tools.resolve('tinymce.Env');\n  var DefaultRenderOptions = {\n    styles: {\n      'border-collapse': 'collapse',\n      'width': '100%'\n    },\n    attributes: {\n      border: '1'\n    },\n    percentages: true\n  };\n\n  var makeTable = function makeTable() {\n    return Element.fromTag('table');\n  };\n\n  var tableBody = function tableBody() {\n    return Element.fromTag('tbody');\n  };\n\n  var tableRow = function tableRow() {\n    return Element.fromTag('tr');\n  };\n\n  var tableHeaderCell = function tableHeaderCell() {\n    return Element.fromTag('th');\n  };\n\n  var tableCell = function tableCell() {\n    return Element.fromTag('td');\n  };\n\n  var render$1 = function render$1(rows, columns, rowHeaders, columnHeaders, renderOpts) {\n    if (renderOpts === void 0) {\n      renderOpts = DefaultRenderOptions;\n    }\n\n    var table = makeTable();\n    setAll$1(table, renderOpts.styles);\n    setAll(table, renderOpts.attributes);\n    var tbody = tableBody();\n    append(table, tbody);\n    var trs = [];\n\n    for (var i = 0; i < rows; i++) {\n      var tr = tableRow();\n\n      for (var j = 0; j < columns; j++) {\n        var td = i < rowHeaders || j < columnHeaders ? tableHeaderCell() : tableCell();\n\n        if (j < columnHeaders) {\n          set(td, 'scope', 'row');\n        }\n\n        if (i < rowHeaders) {\n          set(td, 'scope', 'col');\n        }\n\n        append(td, Element.fromTag('br'));\n\n        if (renderOpts.percentages) {\n          set$1(td, 'width', 100 / columns + '%');\n        }\n\n        append(tr, td);\n      }\n\n      trs.push(tr);\n    }\n\n    append$1(tbody, trs);\n    return table;\n  };\n\n  var get$8 = function get$8(element) {\n    return element.dom().innerHTML;\n  };\n\n  var getOuter$2 = function getOuter$2(element) {\n    var container = Element.fromTag('div');\n    var clone = Element.fromDom(element.dom().cloneNode(true));\n    append(container, clone);\n    return get$8(container);\n  };\n\n  var placeCaretInCell = function placeCaretInCell(editor, cell) {\n    editor.selection.select(cell.dom(), true);\n    editor.selection.collapse(true);\n  };\n\n  var selectFirstCellInTable = function selectFirstCellInTable(editor, tableElm) {\n    descendant$1(tableElm, 'td,th').each(curry(placeCaretInCell, editor));\n  };\n\n  var fireEvents = function fireEvents(editor, table) {\n    each(descendants$1(table, 'tr'), function (row) {\n      fireNewRow(editor, row.dom());\n      each(descendants$1(row, 'th,td'), function (cell) {\n        fireNewCell(editor, cell.dom());\n      });\n    });\n  };\n\n  var isPercentage = function isPercentage(width) {\n    return isString(width) && width.indexOf('%') !== -1;\n  };\n\n  var insert$1 = function insert$1(editor, columns, rows) {\n    var defaultStyles = getDefaultStyles(editor);\n    var options = {\n      styles: defaultStyles,\n      attributes: getDefaultAttributes(editor),\n      percentages: isPercentage(defaultStyles.width) && !isPixelsForced(editor)\n    };\n    var table = render$1(rows, columns, 0, 0, options);\n    set(table, 'data-mce-id', '__mce');\n    var html = getOuter$2(table);\n    editor.insertContent(html);\n    return descendant$1(getBody$1(editor), 'table[data-mce-id=\"__mce\"]').map(function (table) {\n      if (isPixelsForced(editor)) {\n        set$1(table, 'width', get$2(table, 'width'));\n      }\n\n      remove(table, 'data-mce-id');\n      fireEvents(editor, table);\n      selectFirstCellInTable(editor, table);\n      return table.dom();\n    }).getOr(null);\n  };\n\n  var InsertTable = {\n    insert: insert$1\n  };\n\n  var getItems$2 = function getItems$2(editor, hasClasses, insertNewTable) {\n    var rowColCountItems = !insertNewTable ? [] : [{\n      type: 'input',\n      name: 'cols',\n      label: 'Cols'\n    }, {\n      type: 'input',\n      name: 'rows',\n      label: 'Rows'\n    }];\n    var alwaysItems = [{\n      type: 'input',\n      name: 'width',\n      label: 'Width'\n    }, {\n      type: 'input',\n      name: 'height',\n      label: 'Height'\n    }];\n    var appearanceItems = hasAppearanceOptions(editor) ? [{\n      type: 'input',\n      name: 'cellspacing',\n      label: 'Cell spacing'\n    }, {\n      type: 'input',\n      name: 'cellpadding',\n      label: 'Cell padding'\n    }, {\n      type: 'input',\n      name: 'border',\n      label: 'Border width'\n    }, {\n      type: 'label',\n      label: 'Caption',\n      items: [{\n        type: 'checkbox',\n        name: 'caption',\n        label: 'Show caption'\n      }]\n    }] : [];\n    var alignmentItem = [{\n      type: 'selectbox',\n      name: 'align',\n      label: 'Alignment',\n      items: [{\n        text: 'None',\n        value: ''\n      }, {\n        text: 'Left',\n        value: 'left'\n      }, {\n        text: 'Center',\n        value: 'center'\n      }, {\n        text: 'Right',\n        value: 'right'\n      }]\n    }];\n    var classListItem = hasClasses ? [{\n      type: 'selectbox',\n      name: 'class',\n      label: 'Class',\n      items: Helpers.buildListItems(getTableClassList(editor), function (item) {\n        if (item.value) {\n          item.textStyle = function () {\n            return editor.formatter.getCssText({\n              block: 'table',\n              classes: [item.value]\n            });\n          };\n        }\n      })\n    }] : [];\n    return rowColCountItems.concat(alwaysItems).concat(appearanceItems).concat(alignmentItem).concat(classListItem);\n  };\n\n  var TableDialogGeneralTab = {\n    getItems: getItems$2\n  };\n\n  var styleTDTH = function styleTDTH(dom, elm, name, value) {\n    if (elm.tagName === 'TD' || elm.tagName === 'TH') {\n      if (isString(name)) {\n        dom.setStyle(elm, name, value);\n      } else {\n        dom.setStyle(elm, name);\n      }\n    } else {\n      if (elm.children) {\n        for (var i = 0; i < elm.children.length; i++) {\n          styleTDTH(dom, elm.children[i], name, value);\n        }\n      }\n    }\n  };\n\n  var applyDataToElement = function applyDataToElement(editor, tableElm, data) {\n    var dom = editor.dom;\n    var attrs = {};\n    var styles = {};\n    attrs[\"class\"] = data[\"class\"];\n    styles.height = addSizeSuffix(data.height);\n\n    if (dom.getAttrib(tableElm, 'width') && !shouldStyleWithCss(editor)) {\n      attrs.width = removePxSuffix(data.width);\n    } else {\n      styles.width = addSizeSuffix(data.width);\n    }\n\n    if (shouldStyleWithCss(editor)) {\n      styles['border-width'] = addSizeSuffix(data.border);\n      styles['border-spacing'] = addSizeSuffix(data.cellspacing);\n    } else {\n      attrs.border = data.border;\n      attrs.cellpadding = data.cellpadding;\n      attrs.cellspacing = data.cellspacing;\n    }\n\n    if (shouldStyleWithCss(editor) && tableElm.children) {\n      for (var i = 0; i < tableElm.children.length; i++) {\n        styleTDTH(dom, tableElm.children[i], {\n          'border-width': addSizeSuffix(data.border),\n          'padding': addSizeSuffix(data.cellpadding)\n        });\n\n        if (hasAdvancedTableTab(editor)) {\n          styleTDTH(dom, tableElm.children[i], {\n            'border-color': data.bordercolor\n          });\n        }\n      }\n    }\n\n    if (hasAdvancedTableTab(editor)) {\n      styles['background-color'] = data.backgroundcolor;\n      styles['border-color'] = data.bordercolor;\n      styles['border-style'] = data.borderstyle;\n    }\n\n    attrs.style = dom.serializeStyle(merge$3(getDefaultStyles(editor), styles));\n    dom.setAttribs(tableElm, merge$3(getDefaultAttributes(editor), attrs));\n  };\n\n  var onSubmitTableForm = function onSubmitTableForm(editor, tableElm, api) {\n    var dom = editor.dom;\n    var captionElm;\n    var data = api.getData();\n    api.close();\n\n    if (data[\"class\"] === '') {\n      delete data[\"class\"];\n    }\n\n    editor.undoManager.transact(function () {\n      if (!tableElm) {\n        var cols = parseInt(data.cols, 10) || 1;\n        var rows = parseInt(data.rows, 10) || 1;\n        tableElm = InsertTable.insert(editor, cols, rows);\n      }\n\n      applyDataToElement(editor, tableElm, data);\n      captionElm = dom.select('caption', tableElm)[0];\n\n      if (captionElm && !data.caption) {\n        dom.remove(captionElm);\n      }\n\n      if (!captionElm && data.caption) {\n        captionElm = dom.create('caption');\n        captionElm.innerHTML = !global$2.ie ? '<br data-mce-bogus=\"1\"/>' : '\\xA0';\n        tableElm.insertBefore(captionElm, tableElm.firstChild);\n      }\n\n      if (data.align === '') {\n        Styles$1.unApplyAlign(editor, tableElm);\n      } else {\n        Styles$1.applyAlign(editor, tableElm, data.align);\n      }\n\n      editor.focus();\n      editor.addVisual();\n    });\n  };\n\n  var open$2 = function open$2(editor, insertNewTable) {\n    var dom = editor.dom;\n    var tableElm;\n    var data = Helpers.extractDataFromSettings(editor, hasAdvancedTableTab(editor));\n\n    if (insertNewTable === false) {\n      tableElm = dom.getParent(editor.selection.getStart(), 'table');\n\n      if (tableElm) {\n        data = Helpers.extractDataFromTableElement(editor, tableElm, hasAdvancedTableTab(editor));\n      } else {\n        if (hasAdvancedTableTab(editor)) {\n          data.borderstyle = '';\n          data.bordercolor = '';\n          data.backgroundcolor = '';\n        }\n      }\n    } else {\n      data.cols = '1';\n      data.rows = '1';\n\n      if (hasAdvancedTableTab(editor)) {\n        data.borderstyle = '';\n        data.bordercolor = '';\n        data.backgroundcolor = '';\n      }\n    }\n\n    var hasClasses = getTableClassList(editor).length > 0;\n\n    if (hasClasses) {\n      if (data[\"class\"]) {\n        data[\"class\"] = data[\"class\"].replace(/\\s*mce\\-item\\-table\\s*/g, '');\n      }\n    }\n\n    var generalPanel = {\n      type: 'grid',\n      columns: 2,\n      items: TableDialogGeneralTab.getItems(editor, hasClasses, insertNewTable)\n    };\n\n    var nonAdvancedForm = function nonAdvancedForm() {\n      return {\n        type: 'panel',\n        items: [generalPanel]\n      };\n    };\n\n    var advancedForm = function advancedForm() {\n      return {\n        type: 'tabpanel',\n        tabs: [{\n          title: 'General',\n          name: 'general',\n          items: [generalPanel]\n        }, Helpers.getAdvancedTab()]\n      };\n    };\n\n    var dialogBody = hasAdvancedTableTab(editor) ? advancedForm() : nonAdvancedForm();\n    editor.windowManager.open({\n      title: 'Table Properties',\n      size: 'normal',\n      body: dialogBody,\n      onSubmit: curry(onSubmitTableForm, editor, tableElm),\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: data\n    });\n  };\n\n  var TableDialog = {\n    open: open$2\n  };\n\n  var getSelectionStartFromSelector = function getSelectionStartFromSelector(selector) {\n    return function (editor) {\n      return Option.from(editor.dom.getParent(editor.selection.getStart(), selector)).map(Element.fromDom);\n    };\n  };\n\n  var getSelectionStartCell = getSelectionStartFromSelector('th,td');\n  var getSelectionStartCellOrCaption = getSelectionStartFromSelector('th,td,caption');\n  var each$3 = global$1.each;\n\n  var registerCommands = function registerCommands(editor, actions, cellSelection, selections, clipboardRows) {\n    var isRoot = getIsRoot(editor);\n\n    var eraseTable = function eraseTable() {\n      getSelectionStartCellOrCaption(editor).each(function (cellOrCaption) {\n        var tableOpt = TableLookup.table(cellOrCaption, isRoot);\n        tableOpt.filter(not(isRoot)).each(function (table) {\n          var cursor = Element.fromText('');\n          after(table, cursor);\n          remove$2(table);\n\n          if (editor.dom.isEmpty(editor.getBody())) {\n            editor.setContent('');\n            editor.selection.setCursorLocation();\n          } else {\n            var rng = editor.dom.createRng();\n            rng.setStart(cursor.dom(), 0);\n            rng.setEnd(cursor.dom(), 0);\n            editor.selection.setRng(rng);\n            editor.nodeChanged();\n          }\n        });\n      });\n    };\n\n    var getTableFromCell = function getTableFromCell(cell) {\n      return TableLookup.table(cell, isRoot);\n    };\n\n    var getSize = function getSize(table) {\n      return {\n        width: getPixelWidth$1(table.dom()),\n        height: getPixelWidth$1(table.dom())\n      };\n    };\n\n    var resizeChange = function resizeChange(editor, oldSize, table) {\n      var newSize = getSize(table);\n\n      if (oldSize.width !== newSize.width || oldSize.height !== newSize.height) {\n        fireObjectResizeStart(editor, table.dom(), oldSize.width, oldSize.height);\n        fireObjectResized(editor, table.dom(), newSize.width, newSize.height);\n      }\n    };\n\n    var actOnSelection = function actOnSelection(execute) {\n      getSelectionStartCell(editor).each(function (cell) {\n        getTableFromCell(cell).each(function (table) {\n          var targets = TableTargets.forMenu(selections, table, cell);\n          var beforeSize = getSize(table);\n          execute(table, targets).each(function (rng) {\n            resizeChange(editor, beforeSize, table);\n            editor.selection.setRng(rng);\n            editor.focus();\n            cellSelection.clear(table);\n            removeDataStyle(table);\n          });\n        });\n      });\n    };\n\n    var copyRowSelection = function copyRowSelection(execute) {\n      return getSelectionStartCell(editor).map(function (cell) {\n        return getTableFromCell(cell).bind(function (table) {\n          var doc = Element.fromDom(editor.getDoc());\n          var targets = TableTargets.forMenu(selections, table, cell);\n          var generators = TableFill.cellOperations(noop, doc, Option.none());\n          return CopyRows.copyRows(table, targets, generators);\n        });\n      });\n    };\n\n    var pasteOnSelection = function pasteOnSelection(execute) {\n      clipboardRows.get().each(function (rows) {\n        var clonedRows = map(rows, function (row) {\n          return deep(row);\n        });\n        getSelectionStartCell(editor).each(function (cell) {\n          getTableFromCell(cell).each(function (table) {\n            var doc = Element.fromDom(editor.getDoc());\n            var generators = TableFill.paste(doc);\n            var targets = TableTargets.pasteRows(selections, table, cell, clonedRows, generators);\n            execute(table, targets).each(function (rng) {\n              editor.selection.setRng(rng);\n              editor.focus();\n              cellSelection.clear(table);\n            });\n          });\n        });\n      });\n    };\n\n    each$3({\n      mceTableSplitCells: function mceTableSplitCells() {\n        actOnSelection(actions.unmergeCells);\n      },\n      mceTableMergeCells: function mceTableMergeCells() {\n        actOnSelection(actions.mergeCells);\n      },\n      mceTableInsertRowBefore: function mceTableInsertRowBefore() {\n        actOnSelection(actions.insertRowsBefore);\n      },\n      mceTableInsertRowAfter: function mceTableInsertRowAfter() {\n        actOnSelection(actions.insertRowsAfter);\n      },\n      mceTableInsertColBefore: function mceTableInsertColBefore() {\n        actOnSelection(actions.insertColumnsBefore);\n      },\n      mceTableInsertColAfter: function mceTableInsertColAfter() {\n        actOnSelection(actions.insertColumnsAfter);\n      },\n      mceTableDeleteCol: function mceTableDeleteCol() {\n        actOnSelection(actions.deleteColumn);\n      },\n      mceTableDeleteRow: function mceTableDeleteRow() {\n        actOnSelection(actions.deleteRow);\n      },\n      mceTableCutRow: function mceTableCutRow(grid) {\n        copyRowSelection().each(function (selection) {\n          clipboardRows.set(selection);\n          actOnSelection(actions.deleteRow);\n        });\n      },\n      mceTableCopyRow: function mceTableCopyRow(grid) {\n        copyRowSelection().each(function (selection) {\n          clipboardRows.set(selection);\n        });\n      },\n      mceTablePasteRowBefore: function mceTablePasteRowBefore(grid) {\n        pasteOnSelection(actions.pasteRowsBefore);\n      },\n      mceTablePasteRowAfter: function mceTablePasteRowAfter(grid) {\n        pasteOnSelection(actions.pasteRowsAfter);\n      },\n      mceTableDelete: eraseTable\n    }, function (func, name) {\n      editor.addCommand(name, func);\n    });\n    each$3({\n      mceInsertTable: curry(TableDialog.open, editor, true),\n      mceTableProps: curry(TableDialog.open, editor, false),\n      mceTableRowProps: curry(RowDialog.open, editor),\n      mceTableCellProps: curry(CellDialog.open, editor)\n    }, function (func, name) {\n      editor.addCommand(name, function () {\n        func();\n      });\n    });\n  };\n\n  var Commands = {\n    registerCommands: registerCommands\n  };\n\n  var only = function only(element) {\n    var parent = Option.from(element.dom().documentElement).map(Element.fromDom).getOr(element);\n    return {\n      parent: constant(parent),\n      view: constant(element),\n      origin: constant(Position(0, 0))\n    };\n  };\n\n  var detached = function detached(editable, chrome) {\n    var origin = function origin() {\n      return absolute(chrome);\n    };\n\n    return {\n      parent: constant(chrome),\n      view: constant(editable),\n      origin: origin\n    };\n  };\n\n  var body$1 = function body$1(editable, chrome) {\n    return {\n      parent: constant(chrome),\n      view: constant(editable),\n      origin: constant(Position(0, 0))\n    };\n  };\n\n  var ResizeWire = {\n    only: only,\n    detached: detached,\n    body: body$1\n  };\n\n  var Event = function Event(fields) {\n    var struct = Immutable.apply(null, fields);\n    var handlers = [];\n\n    var bind = function bind(handler) {\n      if (handler === undefined) {\n        throw new Error('Event bind error: undefined handler');\n      }\n\n      handlers.push(handler);\n    };\n\n    var unbind = function unbind(handler) {\n      handlers = filter(handlers, function (h) {\n        return h !== handler;\n      });\n    };\n\n    var trigger = function trigger() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      var event = struct.apply(null, args);\n      each(handlers, function (handler) {\n        handler(event);\n      });\n    };\n\n    return {\n      bind: bind,\n      unbind: unbind,\n      trigger: trigger\n    };\n  };\n\n  var create$1 = function create$1(typeDefs) {\n    var registry = map$1(typeDefs, function (event) {\n      return {\n        bind: event.bind,\n        unbind: event.unbind\n      };\n    });\n    var trigger = map$1(typeDefs, function (event) {\n      return event.trigger;\n    });\n    return {\n      registry: registry,\n      trigger: trigger\n    };\n  };\n\n  var Events = {\n    create: create$1\n  };\n\n  var mkEvent = function mkEvent(target, x, y, stop, prevent, kill, raw) {\n    return {\n      target: constant(target),\n      x: constant(x),\n      y: constant(y),\n      stop: stop,\n      prevent: prevent,\n      kill: kill,\n      raw: constant(raw)\n    };\n  };\n\n  var handle = function handle(filter, handler) {\n    return function (rawEvent) {\n      if (!filter(rawEvent)) {\n        return;\n      }\n\n      var target = Element.fromDom(rawEvent.target);\n\n      var stop = function stop() {\n        rawEvent.stopPropagation();\n      };\n\n      var prevent = function prevent() {\n        rawEvent.preventDefault();\n      };\n\n      var kill = compose(prevent, stop);\n      var evt = mkEvent(target, rawEvent.clientX, rawEvent.clientY, stop, prevent, kill, rawEvent);\n      handler(evt);\n    };\n  };\n\n  var binder = function binder(element, event, filter, handler, useCapture) {\n    var wrapped = handle(filter, handler);\n    element.dom().addEventListener(event, wrapped, useCapture);\n    return {\n      unbind: curry(unbind, element, event, wrapped, useCapture)\n    };\n  };\n\n  var bind$1 = function bind$1(element, event, filter, handler) {\n    return binder(element, event, filter, handler, false);\n  };\n\n  var unbind = function unbind(element, event, handler, useCapture) {\n    element.dom().removeEventListener(event, handler, useCapture);\n  };\n\n  var filter$1 = constant(true);\n\n  var bind$2 = function bind$2(element, event, handler) {\n    return bind$1(element, event, filter$1, handler);\n  };\n\n  var styles$1 = css('ephox-dragster');\n  var Styles$2 = {\n    resolve: styles$1.resolve\n  };\n\n  var Blocker = function Blocker(options) {\n    var settings = merge$3({\n      layerClass: Styles$2.resolve('blocker')\n    }, options);\n    var div = Element.fromTag('div');\n    set(div, 'role', 'presentation');\n    setAll$1(div, {\n      position: 'fixed',\n      left: '0px',\n      top: '0px',\n      width: '100%',\n      height: '100%'\n    });\n    add$2(div, Styles$2.resolve('blocker'));\n    add$2(div, settings.layerClass);\n\n    var element = function element() {\n      return div;\n    };\n\n    var destroy = function destroy() {\n      remove$2(div);\n    };\n\n    return {\n      element: element,\n      destroy: destroy\n    };\n  };\n\n  var DragMode = exactly(['compare', 'extract', 'mutate', 'sink']);\n  var DragSink = exactly(['element', 'start', 'stop', 'destroy']);\n  var DragApi = exactly(['forceDrop', 'drop', 'move', 'delayDrop']);\n\n  var compare = function compare(old, nu) {\n    return Position(nu.left() - old.left(), nu.top() - old.top());\n  };\n\n  var extract$1 = function extract$1(event) {\n    return Option.some(Position(event.x(), event.y()));\n  };\n\n  var mutate = function mutate(mutation, info) {\n    mutation.mutate(info.left(), info.top());\n  };\n\n  var sink = function sink(dragApi, settings) {\n    var blocker = Blocker(settings);\n    var mdown = bind$2(blocker.element(), 'mousedown', dragApi.forceDrop);\n    var mup = bind$2(blocker.element(), 'mouseup', dragApi.drop);\n    var mmove = bind$2(blocker.element(), 'mousemove', dragApi.move);\n    var mout = bind$2(blocker.element(), 'mouseout', dragApi.delayDrop);\n\n    var destroy = function destroy() {\n      blocker.destroy();\n      mup.unbind();\n      mmove.unbind();\n      mout.unbind();\n      mdown.unbind();\n    };\n\n    var start = function start(parent) {\n      append(parent, blocker.element());\n    };\n\n    var stop = function stop() {\n      remove$2(blocker.element());\n    };\n\n    return DragSink({\n      element: blocker.element,\n      start: start,\n      stop: stop,\n      destroy: destroy\n    });\n  };\n\n  var MouseDrag = DragMode({\n    compare: compare,\n    extract: extract$1,\n    sink: sink,\n    mutate: mutate\n  });\n\n  var last$2 = function last$2(fn, rate) {\n    var timer = null;\n\n    var cancel = function cancel() {\n      if (timer !== null) {\n        domGlobals.clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function throttle() {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (timer !== null) {\n        domGlobals.clearTimeout(timer);\n      }\n\n      timer = domGlobals.setTimeout(function () {\n        fn.apply(null, args);\n        timer = null;\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  function InDrag() {\n    var previous = Option.none();\n\n    var reset = function reset() {\n      previous = Option.none();\n    };\n\n    var update = function update(mode, nu) {\n      var result = previous.map(function (old) {\n        return mode.compare(old, nu);\n      });\n      previous = Option.some(nu);\n      return result;\n    };\n\n    var onEvent = function onEvent(event, mode) {\n      var dataOption = mode.extract(event);\n      dataOption.each(function (data) {\n        var offset = update(mode, data);\n        offset.each(function (d) {\n          events.trigger.move(d);\n        });\n      });\n    };\n\n    var events = Events.create({\n      move: Event(['info'])\n    });\n    return {\n      onEvent: onEvent,\n      reset: reset,\n      events: events.registry\n    };\n  }\n\n  function NoDrag() {\n    return {\n      onEvent: noop,\n      reset: noop\n    };\n  }\n\n  function Movement() {\n    var noDragState = NoDrag();\n    var inDragState = InDrag();\n    var dragState = noDragState;\n\n    var on = function on() {\n      dragState.reset();\n      dragState = inDragState;\n    };\n\n    var off = function off() {\n      dragState.reset();\n      dragState = noDragState;\n    };\n\n    var onEvent = function onEvent(event, mode) {\n      dragState.onEvent(event, mode);\n    };\n\n    var isOn = function isOn() {\n      return dragState === inDragState;\n    };\n\n    return {\n      on: on,\n      off: off,\n      isOn: isOn,\n      onEvent: onEvent,\n      events: inDragState.events\n    };\n  }\n\n  var setup = function setup(mutation, mode, settings) {\n    var active = false;\n    var events = Events.create({\n      start: Event([]),\n      stop: Event([])\n    });\n    var movement = Movement();\n\n    var drop = function drop() {\n      sink.stop();\n\n      if (movement.isOn()) {\n        movement.off();\n        events.trigger.stop();\n      }\n    };\n\n    var throttledDrop = last$2(drop, 200);\n\n    var go = function go(parent) {\n      sink.start(parent);\n      movement.on();\n      events.trigger.start();\n    };\n\n    var mousemove = function mousemove(event) {\n      throttledDrop.cancel();\n      movement.onEvent(event, mode);\n    };\n\n    movement.events.move.bind(function (event) {\n      mode.mutate(mutation, event.info());\n    });\n\n    var on = function on() {\n      active = true;\n    };\n\n    var off = function off() {\n      active = false;\n    };\n\n    var runIfActive = function runIfActive(f) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (active) {\n          f.apply(null, args);\n        }\n      };\n    };\n\n    var sink = mode.sink(DragApi({\n      forceDrop: drop,\n      drop: runIfActive(drop),\n      move: runIfActive(mousemove),\n      delayDrop: runIfActive(throttledDrop.throttle)\n    }), settings);\n\n    var destroy = function destroy() {\n      sink.destroy();\n    };\n\n    return {\n      element: sink.element,\n      go: go,\n      on: on,\n      off: off,\n      destroy: destroy,\n      events: events.registry\n    };\n  };\n\n  var Dragging = {\n    setup: setup\n  };\n\n  var transform$1 = function transform$1(mutation, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var mode = settings.mode !== undefined ? settings.mode : MouseDrag;\n    return Dragging.setup(mutation, mode, settings);\n  };\n\n  var Dragger = {\n    transform: transform$1\n  };\n\n  var Mutation = function Mutation() {\n    var events = Events.create({\n      drag: Event(['xDelta', 'yDelta'])\n    });\n\n    var mutate = function mutate(x, y) {\n      events.trigger.drag(x, y);\n    };\n\n    return {\n      mutate: mutate,\n      events: events.registry\n    };\n  };\n\n  var BarMutation = function BarMutation() {\n    var events = Events.create({\n      drag: Event(['xDelta', 'yDelta', 'target'])\n    });\n    var target = Option.none();\n    var delegate = Mutation();\n    delegate.events.drag.bind(function (event) {\n      target.each(function (t) {\n        events.trigger.drag(event.xDelta(), event.yDelta(), t);\n      });\n    });\n\n    var assign = function assign(t) {\n      target = Option.some(t);\n    };\n\n    var get = function get() {\n      return target;\n    };\n\n    return {\n      assign: assign,\n      get: get,\n      mutate: delegate.mutate,\n      events: events.registry\n    };\n  };\n\n  var isContentEditableTrue = function isContentEditableTrue(elm) {\n    return get$1(elm, 'contenteditable') === 'true';\n  };\n\n  var findClosestContentEditable = function findClosestContentEditable(target, isRoot) {\n    return closest$1(target, '[contenteditable]', isRoot);\n  };\n\n  var resizeBarDragging = Styles.resolve('resizer-bar-dragging');\n\n  var BarManager = function BarManager(wire, direction, hdirection) {\n    var mutation = BarMutation();\n    var resizing = Dragger.transform(mutation, {});\n    var hoverTable = Option.none();\n\n    var getResizer = function getResizer(element, type) {\n      return Option.from(get$1(element, type));\n    };\n\n    mutation.events.drag.bind(function (event) {\n      getResizer(event.target(), 'data-row').each(function (_dataRow) {\n        var currentRow = CellUtils.getInt(event.target(), 'top');\n        set$1(event.target(), 'top', currentRow + event.yDelta() + 'px');\n      });\n      getResizer(event.target(), 'data-column').each(function (_dataCol) {\n        var currentCol = CellUtils.getInt(event.target(), 'left');\n        set$1(event.target(), 'left', currentCol + event.xDelta() + 'px');\n      });\n    });\n\n    var getDelta = function getDelta(target, dir) {\n      var newX = CellUtils.getInt(target, dir);\n      var oldX = parseInt(get$1(target, 'data-initial-' + dir), 10);\n      return newX - oldX;\n    };\n\n    resizing.events.stop.bind(function () {\n      mutation.get().each(function (target) {\n        hoverTable.each(function (table) {\n          getResizer(target, 'data-row').each(function (row) {\n            var delta = getDelta(target, 'top');\n            remove(target, 'data-initial-top');\n            events.trigger.adjustHeight(table, delta, parseInt(row, 10));\n          });\n          getResizer(target, 'data-column').each(function (column) {\n            var delta = getDelta(target, 'left');\n            remove(target, 'data-initial-left');\n            events.trigger.adjustWidth(table, delta, parseInt(column, 10));\n          });\n          Bars.refresh(wire, table, hdirection, direction);\n        });\n      });\n    });\n\n    var handler = function handler(target, dir) {\n      events.trigger.startAdjust();\n      mutation.assign(target);\n      set(target, 'data-initial-' + dir, parseInt(get$2(target, dir), 10));\n      add$2(target, resizeBarDragging);\n      set$1(target, 'opacity', '0.2');\n      resizing.go(wire.parent());\n    };\n\n    var mousedown = bind$2(wire.parent(), 'mousedown', function (event) {\n      if (Bars.isRowBar(event.target())) {\n        handler(event.target(), 'top');\n      }\n\n      if (Bars.isColBar(event.target())) {\n        handler(event.target(), 'left');\n      }\n    });\n\n    var isRoot = function isRoot(e) {\n      return eq(e, wire.view());\n    };\n\n    var findClosestEditableTable = function findClosestEditableTable(target) {\n      return closest$1(target, 'table', isRoot).filter(function (table) {\n        return findClosestContentEditable(table, isRoot).exists(isContentEditableTrue);\n      });\n    };\n\n    var mouseover = bind$2(wire.view(), 'mouseover', function (event) {\n      findClosestEditableTable(event.target()).fold(function () {\n        if (inBody(event.target())) {\n          Bars.destroy(wire);\n        }\n      }, function (table) {\n        hoverTable = Option.some(table);\n        Bars.refresh(wire, table, hdirection, direction);\n      });\n    });\n\n    var destroy = function destroy() {\n      mousedown.unbind();\n      mouseover.unbind();\n      resizing.destroy();\n      Bars.destroy(wire);\n    };\n\n    var refresh = function refresh(tbl) {\n      Bars.refresh(wire, tbl, hdirection, direction);\n    };\n\n    var events = Events.create({\n      adjustHeight: Event(['table', 'delta', 'row']),\n      adjustWidth: Event(['table', 'delta', 'column']),\n      startAdjust: Event([])\n    });\n    return {\n      destroy: destroy,\n      refresh: refresh,\n      on: resizing.on,\n      off: resizing.off,\n      hideBars: curry(Bars.hide, wire),\n      showBars: curry(Bars.show, wire),\n      events: events.registry\n    };\n  };\n\n  function TableResize(wire, vdirection) {\n    var hdirection = BarPositions.height;\n    var manager = BarManager(wire, vdirection, hdirection);\n    var events = Events.create({\n      beforeResize: Event(['table']),\n      afterResize: Event(['table']),\n      startDrag: Event([])\n    });\n    manager.events.adjustHeight.bind(function (event) {\n      events.trigger.beforeResize(event.table());\n      var delta = hdirection.delta(event.delta(), event.table());\n      Adjustments.adjustHeight(event.table(), delta, event.row(), hdirection);\n      events.trigger.afterResize(event.table());\n    });\n    manager.events.startAdjust.bind(function (event) {\n      events.trigger.startDrag();\n    });\n    manager.events.adjustWidth.bind(function (event) {\n      events.trigger.beforeResize(event.table());\n      var delta = vdirection.delta(event.delta(), event.table());\n      Adjustments.adjustWidth(event.table(), delta, event.column(), vdirection);\n      events.trigger.afterResize(event.table());\n    });\n    return {\n      on: manager.on,\n      off: manager.off,\n      hideBars: manager.hideBars,\n      showBars: manager.showBars,\n      destroy: manager.destroy,\n      events: events.registry\n    };\n  }\n\n  var createContainer = function createContainer() {\n    var container = Element.fromTag('div');\n    setAll$1(container, {\n      position: 'static',\n      height: '0',\n      width: '0',\n      padding: '0',\n      margin: '0',\n      border: '0'\n    });\n    append(body(), container);\n    return container;\n  };\n\n  var get$9 = function get$9(editor, container) {\n    return editor.inline ? ResizeWire.body(getBody$1(editor), createContainer()) : ResizeWire.only(Element.fromDom(editor.getDoc()));\n  };\n\n  var remove$6 = function remove$6(editor, wire) {\n    if (editor.inline) {\n      remove$2(wire.parent());\n    }\n  };\n\n  var TableWire = {\n    get: get$9,\n    remove: remove$6\n  };\n\n  var calculatePercentageWidth = function calculatePercentageWidth(element, parent) {\n    return getPixelWidth$1(element.dom()) / getPixelWidth$1(parent.dom()) * 100 + '%';\n  };\n\n  var enforcePercentage = function enforcePercentage(rawTable) {\n    var table = Element.fromDom(rawTable);\n    parent(table).map(function (parent) {\n      return calculatePercentageWidth(table, parent);\n    }).each(function (tablePercentage) {\n      set$1(table, 'width', tablePercentage);\n      each(descendants$1(table, 'tr'), function (tr) {\n        each(children(tr), function (td) {\n          set$1(td, 'width', calculatePercentageWidth(td, tr));\n        });\n      });\n    });\n  };\n\n  var enforcePixels = function enforcePixels(table) {\n    set$1(Element.fromDom(table), 'width', getPixelWidth$1(table).toString() + 'px');\n  };\n\n  var getResizeHandler = function getResizeHandler(editor) {\n    var selectionRng = Option.none();\n    var resize = Option.none();\n    var wire = Option.none();\n    var percentageBasedSizeRegex = /(\\d+(\\.\\d+)?)%/;\n    var startW;\n    var startRawW;\n\n    var isTable = function isTable(elm) {\n      return elm.nodeName === 'TABLE';\n    };\n\n    var getRawWidth = function getRawWidth(elm) {\n      var raw = editor.dom.getStyle(elm, 'width') || editor.dom.getAttrib(elm, 'width');\n      return Option.from(raw).filter(function (s) {\n        return s.length > 0;\n      });\n    };\n\n    var lazyResize = function lazyResize() {\n      return resize;\n    };\n\n    var lazyWire = function lazyWire() {\n      return wire.getOr(ResizeWire.only(Element.fromDom(editor.getBody())));\n    };\n\n    var destroy = function destroy() {\n      resize.each(function (sz) {\n        sz.destroy();\n      });\n      wire.each(function (w) {\n        TableWire.remove(editor, w);\n      });\n    };\n\n    editor.on('init', function () {\n      var direction = TableDirection(Direction.directionAt);\n      var rawWire = TableWire.get(editor);\n      wire = Option.some(rawWire);\n\n      if (hasObjectResizing(editor) && hasTableResizeBars(editor)) {\n        var sz = TableResize(rawWire, direction);\n        sz.on();\n        sz.events.startDrag.bind(function (event) {\n          selectionRng = Option.some(editor.selection.getRng());\n        });\n        sz.events.beforeResize.bind(function (event) {\n          var rawTable = event.table().dom();\n          fireObjectResizeStart(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable));\n        });\n        sz.events.afterResize.bind(function (event) {\n          var table = event.table();\n          var rawTable = table.dom();\n          removeDataStyle(table);\n          selectionRng.each(function (rng) {\n            editor.selection.setRng(rng);\n            editor.focus();\n          });\n          fireObjectResized(editor, rawTable, getPixelWidth$1(rawTable), getPixelHeight(rawTable));\n          editor.undoManager.add();\n        });\n        resize = Option.some(sz);\n      }\n    });\n    editor.on('ObjectResizeStart', function (e) {\n      var targetElm = e.target;\n\n      if (isTable(targetElm)) {\n        var tableHasPercentage = getRawWidth(targetElm).map(function (w) {\n          return percentageBasedSizeRegex.test(w);\n        }).getOr(false);\n\n        if (tableHasPercentage && isPixelsForced(editor)) {\n          enforcePixels(targetElm);\n        } else if (!tableHasPercentage && isPercentagesForced(editor)) {\n          enforcePercentage(targetElm);\n        }\n\n        startW = e.width;\n        startRawW = getRawWidth(targetElm).getOr('');\n      }\n    });\n    editor.on('ObjectResized', function (e) {\n      var targetElm = e.target;\n\n      if (isTable(targetElm)) {\n        var table = targetElm;\n\n        if (percentageBasedSizeRegex.test(startRawW)) {\n          var percentW = parseFloat(percentageBasedSizeRegex.exec(startRawW)[1]);\n          var targetPercentW = e.width * percentW / startW;\n          editor.dom.setStyle(table, 'width', targetPercentW + '%');\n        } else {\n          var newCellSizes_1 = [];\n          global$1.each(table.rows, function (row) {\n            global$1.each(row.cells, function (cell) {\n              var width = editor.dom.getStyle(cell, 'width', true);\n              newCellSizes_1.push({\n                cell: cell,\n                width: width\n              });\n            });\n          });\n          global$1.each(newCellSizes_1, function (newCellSize) {\n            editor.dom.setStyle(newCellSize.cell, 'width', newCellSize.width);\n            editor.dom.setAttrib(newCellSize.cell, 'width', null);\n          });\n        }\n      }\n    });\n    editor.on('SwitchMode', function () {\n      lazyResize().each(function (resize) {\n        if (editor.readonly) {\n          resize.hideBars();\n        } else {\n          resize.showBars();\n        }\n      });\n    });\n    return {\n      lazyResize: lazyResize,\n      lazyWire: lazyWire,\n      destroy: destroy\n    };\n  };\n\n  var adt$1 = Adt.generate([{\n    none: ['current']\n  }, {\n    first: ['current']\n  }, {\n    middle: ['current', 'target']\n  }, {\n    last: ['current']\n  }]);\n\n  var none$1 = function none$1(current) {\n    if (current === void 0) {\n      current = undefined;\n    }\n\n    return adt$1.none(current);\n  };\n\n  var CellLocation = _assign({}, adt$1, {\n    none: none$1\n  });\n\n  var detect$4 = function detect$4(current, isRoot) {\n    return TableLookup.table(current, isRoot).bind(function (table) {\n      var all = TableLookup.cells(table);\n      var index = findIndex(all, function (x) {\n        return eq(current, x);\n      });\n      return index.map(function (ind) {\n        return {\n          index: constant(ind),\n          all: constant(all)\n        };\n      });\n    });\n  };\n\n  var next = function next(current, isRoot) {\n    var detection = detect$4(current, isRoot);\n    return detection.fold(function () {\n      return CellLocation.none(current);\n    }, function (info) {\n      return info.index() + 1 < info.all().length ? CellLocation.middle(current, info.all()[info.index() + 1]) : CellLocation.last(current);\n    });\n  };\n\n  var prev = function prev(current, isRoot) {\n    var detection = detect$4(current, isRoot);\n    return detection.fold(function () {\n      return CellLocation.none();\n    }, function (info) {\n      return info.index() - 1 >= 0 ? CellLocation.middle(current, info.all()[info.index() - 1]) : CellLocation.first(current);\n    });\n  };\n\n  var CellNavigation = {\n    next: next,\n    prev: prev\n  };\n  var create$2 = Immutable('start', 'soffset', 'finish', 'foffset');\n  var SimRange = {\n    create: create$2\n  };\n  var adt$2 = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata$1 = function cata$1(subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart = function getStart(situ) {\n    return situ.fold(identity, identity, identity);\n  };\n\n  var before$2 = adt$2.before;\n  var on = adt$2.on;\n  var after$2 = adt$2.after;\n  var Situ = {\n    before: before$2,\n    on: on,\n    after: after$2,\n    cata: cata$1,\n    getStart: getStart\n  };\n  var adt$3 = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function exactFromRange(simRange) {\n    return adt$3.exact(simRange.start(), simRange.soffset(), simRange.finish(), simRange.foffset());\n  };\n\n  var getStart$1 = function getStart$1(selection) {\n    return selection.match({\n      domRange: function domRange(rng) {\n        return Element.fromDom(rng.startContainer);\n      },\n      relative: function relative(startSitu, finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function exact(start, soffset, finish, foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt$3.domRange;\n  var relative = adt$3.relative;\n  var exact = adt$3.exact;\n\n  var getWin = function getWin(selection) {\n    var start = getStart$1(selection);\n    return defaultView(start);\n  };\n\n  var range$1 = SimRange.create;\n  var Selection = {\n    domRange: domRange,\n    relative: relative,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range$1\n  };\n\n  var selectNodeContents = function selectNodeContents(win, element) {\n    var rng = win.document.createRange();\n    selectNodeContentsUsing(rng, element);\n    return rng;\n  };\n\n  var selectNodeContentsUsing = function selectNodeContentsUsing(rng, element) {\n    rng.selectNodeContents(element.dom());\n  };\n\n  var setStart = function setStart(rng, situ) {\n    situ.fold(function (e) {\n      rng.setStartBefore(e.dom());\n    }, function (e, o) {\n      rng.setStart(e.dom(), o);\n    }, function (e) {\n      rng.setStartAfter(e.dom());\n    });\n  };\n\n  var setFinish = function setFinish(rng, situ) {\n    situ.fold(function (e) {\n      rng.setEndBefore(e.dom());\n    }, function (e, o) {\n      rng.setEnd(e.dom(), o);\n    }, function (e) {\n      rng.setEndAfter(e.dom());\n    });\n  };\n\n  var relativeToNative = function relativeToNative(win, startSitu, finishSitu) {\n    var range = win.document.createRange();\n    setStart(range, startSitu);\n    setFinish(range, finishSitu);\n    return range;\n  };\n\n  var exactToNative = function exactToNative(win, start, soffset, finish, foffset) {\n    var rng = win.document.createRange();\n    rng.setStart(start.dom(), soffset);\n    rng.setEnd(finish.dom(), foffset);\n    return rng;\n  };\n\n  var toRect = function toRect(rect) {\n    return {\n      left: constant(rect.left),\n      top: constant(rect.top),\n      right: constant(rect.right),\n      bottom: constant(rect.bottom),\n      width: constant(rect.width),\n      height: constant(rect.height)\n    };\n  };\n\n  var getFirstRect = function getFirstRect(rng) {\n    var rects = rng.getClientRects();\n    var rect = rects.length > 0 ? rects[0] : rng.getBoundingClientRect();\n    return rect.width > 0 || rect.height > 0 ? Option.some(rect).map(toRect) : Option.none();\n  };\n\n  var adt$4 = Adt.generate([{\n    ltr: ['start', 'soffset', 'finish', 'foffset']\n  }, {\n    rtl: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var fromRange = function fromRange(win, type, range) {\n    return type(Element.fromDom(range.startContainer), range.startOffset, Element.fromDom(range.endContainer), range.endOffset);\n  };\n\n  var getRanges = function getRanges(win, selection) {\n    return selection.match({\n      domRange: function domRange(rng) {\n        return {\n          ltr: constant(rng),\n          rtl: Option.none\n        };\n      },\n      relative: function relative(startSitu, finishSitu) {\n        return {\n          ltr: cached(function () {\n            return relativeToNative(win, startSitu, finishSitu);\n          }),\n          rtl: cached(function () {\n            return Option.some(relativeToNative(win, finishSitu, startSitu));\n          })\n        };\n      },\n      exact: function exact(start, soffset, finish, foffset) {\n        return {\n          ltr: cached(function () {\n            return exactToNative(win, start, soffset, finish, foffset);\n          }),\n          rtl: cached(function () {\n            return Option.some(exactToNative(win, finish, foffset, start, soffset));\n          })\n        };\n      }\n    });\n  };\n\n  var doDiagnose = function doDiagnose(win, ranges) {\n    var rng = ranges.ltr();\n\n    if (rng.collapsed) {\n      var reversed = ranges.rtl().filter(function (rev) {\n        return rev.collapsed === false;\n      });\n      return reversed.map(function (rev) {\n        return adt$4.rtl(Element.fromDom(rev.endContainer), rev.endOffset, Element.fromDom(rev.startContainer), rev.startOffset);\n      }).getOrThunk(function () {\n        return fromRange(win, adt$4.ltr, rng);\n      });\n    } else {\n      return fromRange(win, adt$4.ltr, rng);\n    }\n  };\n\n  var diagnose = function diagnose(win, selection) {\n    var ranges = getRanges(win, selection);\n    return doDiagnose(win, ranges);\n  };\n\n  var asLtrRange = function asLtrRange(win, selection) {\n    var diagnosis = diagnose(win, selection);\n    return diagnosis.match({\n      ltr: function ltr(start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(start.dom(), soffset);\n        rng.setEnd(finish.dom(), foffset);\n        return rng;\n      },\n      rtl: function rtl(start, soffset, finish, foffset) {\n        var rng = win.document.createRange();\n        rng.setStart(finish.dom(), foffset);\n        rng.setEnd(start.dom(), soffset);\n        return rng;\n      }\n    });\n  };\n\n  var searchForPoint = function searchForPoint(rectForOffset, x, y, maxX, length) {\n    if (length === 0) {\n      return 0;\n    } else if (x === maxX) {\n      return length - 1;\n    }\n\n    var xDelta = maxX;\n\n    for (var i = 1; i < length; i++) {\n      var rect = rectForOffset(i);\n      var curDeltaX = Math.abs(x - rect.left);\n\n      if (y <= rect.bottom) {\n        if (y < rect.top || curDeltaX > xDelta) {\n          return i - 1;\n        } else {\n          xDelta = curDeltaX;\n        }\n      }\n    }\n\n    return 0;\n  };\n\n  var inRect = function inRect(rect, x, y) {\n    return x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom;\n  };\n\n  var locateOffset = function locateOffset(doc, textnode, x, y, rect) {\n    var rangeForOffset = function rangeForOffset(o) {\n      var r = doc.dom().createRange();\n      r.setStart(textnode.dom(), o);\n      r.collapse(true);\n      return r;\n    };\n\n    var rectForOffset = function rectForOffset(o) {\n      var r = rangeForOffset(o);\n      return r.getBoundingClientRect();\n    };\n\n    var length = get$3(textnode).length;\n    var offset = searchForPoint(rectForOffset, x, y, rect.right, length);\n    return rangeForOffset(offset);\n  };\n\n  var locate = function locate(doc, node, x, y) {\n    var r = doc.dom().createRange();\n    r.selectNode(node.dom());\n    var rects = r.getClientRects();\n    var foundRect = findMap(rects, function (rect) {\n      return inRect(rect, x, y) ? Option.some(rect) : Option.none();\n    });\n    return foundRect.map(function (rect) {\n      return locateOffset(doc, node, x, y, rect);\n    });\n  };\n\n  var searchInChildren = function searchInChildren(doc, node, x, y) {\n    var r = doc.dom().createRange();\n    var nodes = children(node);\n    return findMap(nodes, function (n) {\n      r.selectNode(n.dom());\n      return inRect(r.getBoundingClientRect(), x, y) ? locateNode(doc, n, x, y) : Option.none();\n    });\n  };\n\n  var locateNode = function locateNode(doc, node, x, y) {\n    return isText(node) ? locate(doc, node, x, y) : searchInChildren(doc, node, x, y);\n  };\n\n  var locate$1 = function locate$1(doc, node, x, y) {\n    var r = doc.dom().createRange();\n    r.selectNode(node.dom());\n    var rect = r.getBoundingClientRect();\n    var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n    var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n    return locateNode(doc, node, boundedX, boundedY);\n  };\n\n  var COLLAPSE_TO_LEFT = true;\n  var COLLAPSE_TO_RIGHT = false;\n\n  var getCollapseDirection = function getCollapseDirection(rect, x) {\n    return x - rect.left < rect.right - x ? COLLAPSE_TO_LEFT : COLLAPSE_TO_RIGHT;\n  };\n\n  var createCollapsedNode = function createCollapsedNode(doc, target, collapseDirection) {\n    var r = doc.dom().createRange();\n    r.selectNode(target.dom());\n    r.collapse(collapseDirection);\n    return r;\n  };\n\n  var locateInElement = function locateInElement(doc, node, x) {\n    var cursorRange = doc.dom().createRange();\n    cursorRange.selectNode(node.dom());\n    var rect = cursorRange.getBoundingClientRect();\n    var collapseDirection = getCollapseDirection(rect, x);\n    var f = collapseDirection === COLLAPSE_TO_LEFT ? first : last$1;\n    return f(node).map(function (target) {\n      return createCollapsedNode(doc, target, collapseDirection);\n    });\n  };\n\n  var locateInEmpty = function locateInEmpty(doc, node, x) {\n    var rect = node.dom().getBoundingClientRect();\n    var collapseDirection = getCollapseDirection(rect, x);\n    return Option.some(createCollapsedNode(doc, node, collapseDirection));\n  };\n\n  var search = function search(doc, node, x) {\n    var f = children(node).length === 0 ? locateInEmpty : locateInElement;\n    return f(doc, node, x);\n  };\n\n  var caretPositionFromPoint = function caretPositionFromPoint(doc, x, y) {\n    return Option.from(doc.dom().caretPositionFromPoint(x, y)).bind(function (pos) {\n      if (pos.offsetNode === null) {\n        return Option.none();\n      }\n\n      var r = doc.dom().createRange();\n      r.setStart(pos.offsetNode, pos.offset);\n      r.collapse();\n      return Option.some(r);\n    });\n  };\n\n  var caretRangeFromPoint = function caretRangeFromPoint(doc, x, y) {\n    return Option.from(doc.dom().caretRangeFromPoint(x, y));\n  };\n\n  var searchTextNodes = function searchTextNodes(doc, node, x, y) {\n    var r = doc.dom().createRange();\n    r.selectNode(node.dom());\n    var rect = r.getBoundingClientRect();\n    var boundedX = Math.max(rect.left, Math.min(rect.right, x));\n    var boundedY = Math.max(rect.top, Math.min(rect.bottom, y));\n    return locate$1(doc, node, boundedX, boundedY);\n  };\n\n  var searchFromPoint = function searchFromPoint(doc, x, y) {\n    return Element.fromPoint(doc, x, y).bind(function (elem) {\n      var fallback = function fallback() {\n        return search(doc, elem, x);\n      };\n\n      return children(elem).length === 0 ? fallback() : searchTextNodes(doc, elem, x, y).orThunk(fallback);\n    });\n  };\n\n  var availableSearch = document.caretPositionFromPoint ? caretPositionFromPoint : document.caretRangeFromPoint ? caretRangeFromPoint : searchFromPoint;\n\n  var fromPoint$1 = function fromPoint$1(win, x, y) {\n    var doc = Element.fromDom(win.document);\n    return availableSearch(doc, x, y).map(function (rng) {\n      return SimRange.create(Element.fromDom(rng.startContainer), rng.startOffset, Element.fromDom(rng.endContainer), rng.endOffset);\n    });\n  };\n\n  var beforeSpecial = function beforeSpecial(element, offset) {\n    var name$1 = name(element);\n\n    if ('input' === name$1) {\n      return Situ.after(element);\n    } else if (!contains(['br', 'img'], name$1)) {\n      return Situ.on(element, offset);\n    } else {\n      return offset === 0 ? Situ.before(element) : Situ.after(element);\n    }\n  };\n\n  var preprocessRelative = function preprocessRelative(startSitu, finishSitu) {\n    var start = startSitu.fold(Situ.before, beforeSpecial, Situ.after);\n    var finish = finishSitu.fold(Situ.before, beforeSpecial, Situ.after);\n    return Selection.relative(start, finish);\n  };\n\n  var preprocessExact = function preprocessExact(start, soffset, finish, foffset) {\n    var startSitu = beforeSpecial(start, soffset);\n    var finishSitu = beforeSpecial(finish, foffset);\n    return Selection.relative(startSitu, finishSitu);\n  };\n\n  var preprocess = function preprocess(selection) {\n    return selection.match({\n      domRange: function domRange(rng) {\n        var start = Element.fromDom(rng.startContainer);\n        var finish = Element.fromDom(rng.endContainer);\n        return preprocessExact(start, rng.startOffset, finish, rng.endOffset);\n      },\n      relative: preprocessRelative,\n      exact: preprocessExact\n    });\n  };\n\n  var makeRange = function makeRange(start, soffset, finish, foffset) {\n    var doc = owner(start);\n    var rng = doc.dom().createRange();\n    rng.setStart(start.dom(), soffset);\n    rng.setEnd(finish.dom(), foffset);\n    return rng;\n  };\n\n  var after$3 = function after$3(start, soffset, finish, foffset) {\n    var r = makeRange(start, soffset, finish, foffset);\n    var same = eq(start, finish) && soffset === foffset;\n    return r.collapsed && !same;\n  };\n\n  var doSetNativeRange = function doSetNativeRange(win, rng) {\n    Option.from(win.getSelection()).each(function (selection) {\n      selection.removeAllRanges();\n      selection.addRange(rng);\n    });\n  };\n\n  var doSetRange = function doSetRange(win, start, soffset, finish, foffset) {\n    var rng = exactToNative(win, start, soffset, finish, foffset);\n    doSetNativeRange(win, rng);\n  };\n\n  var setLegacyRtlRange = function setLegacyRtlRange(win, selection, start, soffset, finish, foffset) {\n    selection.collapse(start.dom(), soffset);\n    selection.extend(finish.dom(), foffset);\n  };\n\n  var setRangeFromRelative = function setRangeFromRelative(win, relative) {\n    return diagnose(win, relative).match({\n      ltr: function ltr(start, soffset, finish, foffset) {\n        doSetRange(win, start, soffset, finish, foffset);\n      },\n      rtl: function rtl(start, soffset, finish, foffset) {\n        var selection = win.getSelection();\n\n        if (selection.setBaseAndExtent) {\n          selection.setBaseAndExtent(start.dom(), soffset, finish.dom(), foffset);\n        } else if (selection.extend) {\n          try {\n            setLegacyRtlRange(win, selection, start, soffset, finish, foffset);\n          } catch (e) {\n            doSetRange(win, finish, foffset, start, soffset);\n          }\n        } else {\n          doSetRange(win, finish, foffset, start, soffset);\n        }\n      }\n    });\n  };\n\n  var setExact = function setExact(win, start, soffset, finish, foffset) {\n    var relative = preprocessExact(start, soffset, finish, foffset);\n    setRangeFromRelative(win, relative);\n  };\n\n  var setRelative = function setRelative(win, startSitu, finishSitu) {\n    var relative = preprocessRelative(startSitu, finishSitu);\n    setRangeFromRelative(win, relative);\n  };\n\n  var toNative = function toNative(selection) {\n    var win = Selection.getWin(selection).dom();\n\n    var getDomRange = function getDomRange(start, soffset, finish, foffset) {\n      return exactToNative(win, start, soffset, finish, foffset);\n    };\n\n    var filtered = preprocess(selection);\n    return diagnose(win, filtered).match({\n      ltr: getDomRange,\n      rtl: getDomRange\n    });\n  };\n\n  var readRange = function readRange(selection) {\n    if (selection.rangeCount > 0) {\n      var firstRng = selection.getRangeAt(0);\n      var lastRng = selection.getRangeAt(selection.rangeCount - 1);\n      return Option.some(SimRange.create(Element.fromDom(firstRng.startContainer), firstRng.startOffset, Element.fromDom(lastRng.endContainer), lastRng.endOffset));\n    } else {\n      return Option.none();\n    }\n  };\n\n  var doGetExact = function doGetExact(selection) {\n    var anchor = Element.fromDom(selection.anchorNode);\n    var focus = Element.fromDom(selection.focusNode);\n    return after$3(anchor, selection.anchorOffset, focus, selection.focusOffset) ? Option.some(SimRange.create(anchor, selection.anchorOffset, focus, selection.focusOffset)) : readRange(selection);\n  };\n\n  var setToElement = function setToElement(win, element) {\n    var rng = selectNodeContents(win, element);\n    doSetNativeRange(win, rng);\n  };\n\n  var getExact = function getExact(win) {\n    return Option.from(win.getSelection()).filter(function (sel) {\n      return sel.rangeCount > 0;\n    }).bind(doGetExact);\n  };\n\n  var get$a = function get$a(win) {\n    return getExact(win).map(function (range) {\n      return Selection.exact(range.start(), range.soffset(), range.finish(), range.foffset());\n    });\n  };\n\n  var getFirstRect$1 = function getFirstRect$1(win, selection) {\n    var rng = asLtrRange(win, selection);\n    return getFirstRect(rng);\n  };\n\n  var getAtPoint = function getAtPoint(win, x, y) {\n    return fromPoint$1(win, x, y);\n  };\n\n  var clear = function clear(win) {\n    var selection = win.getSelection();\n    selection.removeAllRanges();\n  };\n\n  var global$3 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var forward = function forward(editor, isRoot, cell, lazyWire) {\n    return go(editor, isRoot, CellNavigation.next(cell), lazyWire);\n  };\n\n  var backward = function backward(editor, isRoot, cell, lazyWire) {\n    return go(editor, isRoot, CellNavigation.prev(cell), lazyWire);\n  };\n\n  var getCellFirstCursorPosition = function getCellFirstCursorPosition(editor, cell) {\n    var selection = Selection.exact(cell, 0, cell, 0);\n    return toNative(selection);\n  };\n\n  var getNewRowCursorPosition = function getNewRowCursorPosition(editor, table) {\n    var rows = descendants$1(table, 'tr');\n    return last(rows).bind(function (last) {\n      return descendant$1(last, 'td,th').map(function (first) {\n        return getCellFirstCursorPosition(editor, first);\n      });\n    });\n  };\n\n  var go = function go(editor, isRoot, cell, actions, lazyWire) {\n    return cell.fold(Option.none, Option.none, function (current, next) {\n      return first(next).map(function (cell) {\n        return getCellFirstCursorPosition(editor, cell);\n      });\n    }, function (current) {\n      return TableLookup.table(current, isRoot).bind(function (table) {\n        var targets = TableTargets.noMenu(current);\n        editor.undoManager.transact(function () {\n          actions.insertRowsAfter(table, targets);\n        });\n        return getNewRowCursorPosition(editor, table);\n      });\n    });\n  };\n\n  var rootElements = ['table', 'li', 'dl'];\n\n  var handle$1 = function handle$1(event, editor, actions, lazyWire) {\n    if (event.keyCode === global$3.TAB) {\n      var body_1 = getBody$1(editor);\n\n      var isRoot_1 = function isRoot_1(element) {\n        var name$1 = name(element);\n        return eq(element, body_1) || contains(rootElements, name$1);\n      };\n\n      var rng = editor.selection.getRng();\n\n      if (rng.collapsed) {\n        var start = Element.fromDom(rng.startContainer);\n        TableLookup.cell(start, isRoot_1).each(function (cell) {\n          event.preventDefault();\n          var navigation = event.shiftKey ? backward : forward;\n          var rng = navigation(editor, isRoot_1, cell, actions, lazyWire);\n          rng.each(function (range) {\n            editor.selection.setRng(range);\n          });\n        });\n      }\n    }\n  };\n\n  var TabContext = {\n    handle: handle$1\n  };\n  var create$3 = Immutable('selection', 'kill');\n  var Response = {\n    create: create$3\n  };\n\n  var create$4 = function create$4(start, soffset, finish, foffset) {\n    return {\n      start: constant(Situ.on(start, soffset)),\n      finish: constant(Situ.on(finish, foffset))\n    };\n  };\n\n  var Situs = {\n    create: create$4\n  };\n\n  var convertToRange = function convertToRange(win, selection) {\n    var rng = asLtrRange(win, selection);\n    return SimRange.create(Element.fromDom(rng.startContainer), rng.startOffset, Element.fromDom(rng.endContainer), rng.endOffset);\n  };\n\n  var makeSitus = Situs.create;\n  var Util = {\n    convertToRange: convertToRange,\n    makeSitus: makeSitus\n  };\n\n  var sync = function sync(container, isRoot, start, soffset, finish, foffset, selectRange) {\n    if (!(eq(start, finish) && soffset === foffset)) {\n      return closest$1(start, 'td,th', isRoot).bind(function (s) {\n        return closest$1(finish, 'td,th', isRoot).bind(function (f) {\n          return detect$5(container, isRoot, s, f, selectRange);\n        });\n      });\n    } else {\n      return Option.none();\n    }\n  };\n\n  var detect$5 = function detect$5(container, isRoot, start, finish, selectRange) {\n    if (!eq(start, finish)) {\n      return CellSelection.identify(start, finish, isRoot).bind(function (cellSel) {\n        var boxes = cellSel.boxes().getOr([]);\n\n        if (boxes.length > 0) {\n          selectRange(container, boxes, cellSel.start(), cellSel.finish());\n          return Option.some(Response.create(Option.some(Util.makeSitus(start, 0, start, getEnd(start))), true));\n        } else {\n          return Option.none();\n        }\n      });\n    } else {\n      return Option.none();\n    }\n  };\n\n  var update = function update(rows, columns, container, selected, annotations) {\n    var updateSelection = function updateSelection(newSels) {\n      annotations.clear(container);\n      annotations.selectRange(container, newSels.boxes(), newSels.start(), newSels.finish());\n      return newSels.boxes();\n    };\n\n    return CellSelection.shiftSelection(selected, rows, columns, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(updateSelection);\n  };\n\n  var KeySelection = {\n    sync: sync,\n    detect: detect$5,\n    update: update\n  };\n  var traverse = Immutable('item', 'mode');\n\n  var backtrack = function backtrack(universe, item, _direction, transition) {\n    if (transition === void 0) {\n      transition = sidestep;\n    }\n\n    return universe.property().parent(item).map(function (p) {\n      return traverse(p, transition);\n    });\n  };\n\n  var sidestep = function sidestep(universe, item, direction, transition) {\n    if (transition === void 0) {\n      transition = advance;\n    }\n\n    return direction.sibling(universe, item).map(function (p) {\n      return traverse(p, transition);\n    });\n  };\n\n  var advance = function advance(universe, item, direction, transition) {\n    if (transition === void 0) {\n      transition = advance;\n    }\n\n    var children = universe.property().children(item);\n    var result = direction.first(children);\n    return result.map(function (r) {\n      return traverse(r, transition);\n    });\n  };\n\n  var successors = [{\n    current: backtrack,\n    next: sidestep,\n    fallback: Option.none()\n  }, {\n    current: sidestep,\n    next: advance,\n    fallback: Option.some(backtrack)\n  }, {\n    current: advance,\n    next: advance,\n    fallback: Option.some(sidestep)\n  }];\n\n  var go$1 = function go$1(universe, item, mode, direction, rules) {\n    if (rules === void 0) {\n      rules = successors;\n    }\n\n    var ruleOpt = find(rules, function (succ) {\n      return succ.current === mode;\n    });\n    return ruleOpt.bind(function (rule) {\n      return rule.current(universe, item, direction, rule.next).orThunk(function () {\n        return rule.fallback.bind(function (fb) {\n          return go$1(universe, item, fb, direction);\n        });\n      });\n    });\n  };\n\n  var left = function left() {\n    var sibling = function sibling(universe, item) {\n      return universe.query().prevSibling(item);\n    };\n\n    var first = function first(children) {\n      return children.length > 0 ? Option.some(children[children.length - 1]) : Option.none();\n    };\n\n    return {\n      sibling: sibling,\n      first: first\n    };\n  };\n\n  var right = function right() {\n    var sibling = function sibling(universe, item) {\n      return universe.query().nextSibling(item);\n    };\n\n    var first = function first(children) {\n      return children.length > 0 ? Option.some(children[0]) : Option.none();\n    };\n\n    return {\n      sibling: sibling,\n      first: first\n    };\n  };\n\n  var Walkers = {\n    left: left,\n    right: right\n  };\n\n  var hone = function hone(universe, item, predicate, mode, direction, isRoot) {\n    var next = go$1(universe, item, mode, direction);\n    return next.bind(function (n) {\n      if (isRoot(n.item())) {\n        return Option.none();\n      } else {\n        return predicate(n.item()) ? Option.some(n.item()) : hone(universe, n.item(), predicate, n.mode(), direction, isRoot);\n      }\n    });\n  };\n\n  var left$1 = function left$1(universe, item, predicate, isRoot) {\n    return hone(universe, item, predicate, sidestep, Walkers.left(), isRoot);\n  };\n\n  var right$1 = function right$1(universe, item, predicate, isRoot) {\n    return hone(universe, item, predicate, sidestep, Walkers.right(), isRoot);\n  };\n\n  var isLeaf = function isLeaf(universe) {\n    return function (element) {\n      return universe.property().children(element).length === 0;\n    };\n  };\n\n  var before$3 = function before$3(universe, item, isRoot) {\n    return seekLeft(universe, item, isLeaf(universe), isRoot);\n  };\n\n  var after$4 = function after$4(universe, item, isRoot) {\n    return seekRight(universe, item, isLeaf(universe), isRoot);\n  };\n\n  var seekLeft = left$1;\n  var seekRight = right$1;\n  var universe$2 = DomUniverse();\n\n  var before$4 = function before$4(element, isRoot) {\n    return before$3(universe$2, element, isRoot);\n  };\n\n  var after$5 = function after$5(element, isRoot) {\n    return after$4(universe$2, element, isRoot);\n  };\n\n  var seekLeft$1 = function seekLeft$1(element, predicate, isRoot) {\n    return seekLeft(universe$2, element, predicate, isRoot);\n  };\n\n  var seekRight$1 = function seekRight$1(element, predicate, isRoot) {\n    return seekRight(universe$2, element, predicate, isRoot);\n  };\n\n  var ancestor$2 = function ancestor$2(scope, predicate, isRoot) {\n    return ancestor(scope, predicate, isRoot).isSome();\n  };\n\n  var point = Immutable('element', 'offset');\n  var delta = Immutable('element', 'deltaOffset');\n  var range$2 = Immutable('element', 'start', 'finish');\n  var points = Immutable('begin', 'end');\n  var text = Immutable('element', 'text');\n  var adt$5 = Adt.generate([{\n    none: ['message']\n  }, {\n    success: []\n  }, {\n    failedUp: ['cell']\n  }, {\n    failedDown: ['cell']\n  }]);\n\n  var isOverlapping = function isOverlapping(bridge, before, after) {\n    var beforeBounds = bridge.getRect(before);\n    var afterBounds = bridge.getRect(after);\n    return afterBounds.right > beforeBounds.left && afterBounds.left < beforeBounds.right;\n  };\n\n  var isRow = function isRow(elem) {\n    return closest$1(elem, 'tr');\n  };\n\n  var verify = function verify(bridge, before, beforeOffset, after, afterOffset, failure, isRoot) {\n    return closest$1(after, 'td,th', isRoot).bind(function (afterCell) {\n      return closest$1(before, 'td,th', isRoot).map(function (beforeCell) {\n        if (!eq(afterCell, beforeCell)) {\n          return DomParent.sharedOne(isRow, [afterCell, beforeCell]).fold(function () {\n            return isOverlapping(bridge, beforeCell, afterCell) ? adt$5.success() : failure(beforeCell);\n          }, function (_sharedRow) {\n            return failure(beforeCell);\n          });\n        } else {\n          return eq(after, afterCell) && getEnd(afterCell) === afterOffset ? failure(beforeCell) : adt$5.none('in same cell');\n        }\n      });\n    }).getOr(adt$5.none('default'));\n  };\n\n  var cata$2 = function cata$2(subject, onNone, onSuccess, onFailedUp, onFailedDown) {\n    return subject.fold(onNone, onSuccess, onFailedUp, onFailedDown);\n  };\n\n  var BeforeAfter = _assign({}, adt$5, {\n    verify: verify,\n    cata: cata$2\n  });\n\n  var inAncestor = Immutable('ancestor', 'descendants', 'element', 'index');\n  var inParent = Immutable('parent', 'children', 'element', 'index');\n\n  var indexInParent = function indexInParent(element) {\n    return parent(element).bind(function (parent) {\n      var children$1 = children(parent);\n      return indexOf(children$1, element).map(function (index) {\n        return inParent(parent, children$1, element, index);\n      });\n    });\n  };\n\n  var indexOf = function indexOf(elements, element) {\n    return findIndex(elements, curry(eq, element));\n  };\n\n  var isBr = function isBr(elem) {\n    return name(elem) === 'br';\n  };\n\n  var gatherer = function gatherer(cand, gather, isRoot) {\n    return gather(cand, isRoot).bind(function (target) {\n      return isText(target) && get$3(target).trim().length === 0 ? gatherer(target, gather, isRoot) : Option.some(target);\n    });\n  };\n\n  var handleBr = function handleBr(isRoot, element, direction) {\n    return direction.traverse(element).orThunk(function () {\n      return gatherer(element, direction.gather, isRoot);\n    }).map(direction.relative);\n  };\n\n  var findBr = function findBr(element, offset) {\n    return child(element, offset).filter(isBr).orThunk(function () {\n      return child(element, offset - 1).filter(isBr);\n    });\n  };\n\n  var handleParent = function handleParent(isRoot, element, offset, direction) {\n    return findBr(element, offset).bind(function (br) {\n      return direction.traverse(br).fold(function () {\n        return gatherer(br, direction.gather, isRoot).map(direction.relative);\n      }, function (adjacent) {\n        return indexInParent(adjacent).map(function (info) {\n          return Situ.on(info.parent(), info.index());\n        });\n      });\n    });\n  };\n\n  var tryBr = function tryBr(isRoot, element, offset, direction) {\n    var target = isBr(element) ? handleBr(isRoot, element, direction) : handleParent(isRoot, element, offset, direction);\n    return target.map(function (tgt) {\n      return {\n        start: constant(tgt),\n        finish: constant(tgt)\n      };\n    });\n  };\n\n  var process = function process(analysis) {\n    return BeforeAfter.cata(analysis, function (message) {\n      return Option.none();\n    }, function () {\n      return Option.none();\n    }, function (cell) {\n      return Option.some(point(cell, 0));\n    }, function (cell) {\n      return Option.some(point(cell, getEnd(cell)));\n    });\n  };\n\n  var BrTags = {\n    tryBr: tryBr,\n    process: process\n  };\n  var nu$3 = MixedBag(['left', 'top', 'right', 'bottom'], []);\n\n  var moveDown = function moveDown(caret, amount) {\n    return nu$3({\n      left: caret.left(),\n      top: caret.top() + amount,\n      right: caret.right(),\n      bottom: caret.bottom() + amount\n    });\n  };\n\n  var moveUp = function moveUp(caret, amount) {\n    return nu$3({\n      left: caret.left(),\n      top: caret.top() - amount,\n      right: caret.right(),\n      bottom: caret.bottom() - amount\n    });\n  };\n\n  var moveBottomTo = function moveBottomTo(caret, bottom) {\n    var height = caret.bottom() - caret.top();\n    return nu$3({\n      left: caret.left(),\n      top: bottom - height,\n      right: caret.right(),\n      bottom: bottom\n    });\n  };\n\n  var moveTopTo = function moveTopTo(caret, top) {\n    var height = caret.bottom() - caret.top();\n    return nu$3({\n      left: caret.left(),\n      top: top,\n      right: caret.right(),\n      bottom: top + height\n    });\n  };\n\n  var translate = function translate(caret, xDelta, yDelta) {\n    return nu$3({\n      left: caret.left() + xDelta,\n      top: caret.top() + yDelta,\n      right: caret.right() + xDelta,\n      bottom: caret.bottom() + yDelta\n    });\n  };\n\n  var getTop$1 = function getTop$1(caret) {\n    return caret.top();\n  };\n\n  var getBottom = function getBottom(caret) {\n    return caret.bottom();\n  };\n\n  var toString = function toString(caret) {\n    return '(' + caret.left() + ', ' + caret.top() + ') -> (' + caret.right() + ', ' + caret.bottom() + ')';\n  };\n\n  var Carets = {\n    nu: nu$3,\n    moveUp: moveUp,\n    moveDown: moveDown,\n    moveBottomTo: moveBottomTo,\n    moveTopTo: moveTopTo,\n    getTop: getTop$1,\n    getBottom: getBottom,\n    translate: translate,\n    toString: toString\n  };\n\n  var getPartialBox = function getPartialBox(bridge, element, offset) {\n    if (offset >= 0 && offset < getEnd(element)) {\n      return bridge.getRangedRect(element, offset, element, offset + 1);\n    } else if (offset > 0) {\n      return bridge.getRangedRect(element, offset - 1, element, offset);\n    }\n\n    return Option.none();\n  };\n\n  var toCaret = function toCaret(rect) {\n    return Carets.nu({\n      left: rect.left,\n      top: rect.top,\n      right: rect.right,\n      bottom: rect.bottom\n    });\n  };\n\n  var getElemBox = function getElemBox(bridge, element) {\n    return Option.some(bridge.getRect(element));\n  };\n\n  var getBoxAt = function getBoxAt(bridge, element, offset) {\n    if (isElement(element)) {\n      return getElemBox(bridge, element).map(toCaret);\n    } else if (isText(element)) {\n      return getPartialBox(bridge, element, offset).map(toCaret);\n    } else {\n      return Option.none();\n    }\n  };\n\n  var getEntireBox = function getEntireBox(bridge, element) {\n    if (isElement(element)) {\n      return getElemBox(bridge, element).map(toCaret);\n    } else if (isText(element)) {\n      return bridge.getRangedRect(element, 0, element, getEnd(element)).map(toCaret);\n    } else {\n      return Option.none();\n    }\n  };\n\n  var Rectangles = {\n    getBoxAt: getBoxAt,\n    getEntireBox: getEntireBox\n  };\n  var JUMP_SIZE = 5;\n  var NUM_RETRIES = 100;\n  var adt$6 = Adt.generate([{\n    none: []\n  }, {\n    retry: ['caret']\n  }]);\n\n  var isOutside = function isOutside(caret, box) {\n    return caret.left() < box.left() || Math.abs(box.right() - caret.left()) < 1 || caret.left() > box.right();\n  };\n\n  var inOutsideBlock = function inOutsideBlock(bridge, element, caret) {\n    return closest(element, DomStructure.isBlock).fold(constant(false), function (cell) {\n      return Rectangles.getEntireBox(bridge, cell).exists(function (box) {\n        return isOutside(caret, box);\n      });\n    });\n  };\n\n  var adjustDown = function adjustDown(bridge, element, guessBox, original, caret) {\n    var lowerCaret = Carets.moveDown(caret, JUMP_SIZE);\n\n    if (Math.abs(guessBox.bottom() - original.bottom()) < 1) {\n      return adt$6.retry(lowerCaret);\n    } else if (guessBox.top() > caret.bottom()) {\n      return adt$6.retry(lowerCaret);\n    } else if (guessBox.top() === caret.bottom()) {\n      return adt$6.retry(Carets.moveDown(caret, 1));\n    } else {\n      return inOutsideBlock(bridge, element, caret) ? adt$6.retry(Carets.translate(lowerCaret, JUMP_SIZE, 0)) : adt$6.none();\n    }\n  };\n\n  var adjustUp = function adjustUp(bridge, element, guessBox, original, caret) {\n    var higherCaret = Carets.moveUp(caret, JUMP_SIZE);\n\n    if (Math.abs(guessBox.top() - original.top()) < 1) {\n      return adt$6.retry(higherCaret);\n    } else if (guessBox.bottom() < caret.top()) {\n      return adt$6.retry(higherCaret);\n    } else if (guessBox.bottom() === caret.top()) {\n      return adt$6.retry(Carets.moveUp(caret, 1));\n    } else {\n      return inOutsideBlock(bridge, element, caret) ? adt$6.retry(Carets.translate(higherCaret, JUMP_SIZE, 0)) : adt$6.none();\n    }\n  };\n\n  var upMovement = {\n    point: Carets.getTop,\n    adjuster: adjustUp,\n    move: Carets.moveUp,\n    gather: before$4\n  };\n  var downMovement = {\n    point: Carets.getBottom,\n    adjuster: adjustDown,\n    move: Carets.moveDown,\n    gather: after$5\n  };\n\n  var isAtTable = function isAtTable(bridge, x, y) {\n    return bridge.elementFromPoint(x, y).filter(function (elm) {\n      return name(elm) === 'table';\n    }).isSome();\n  };\n\n  var adjustForTable = function adjustForTable(bridge, movement, original, caret, numRetries) {\n    return adjustTil(bridge, movement, original, movement.move(caret, JUMP_SIZE), numRetries);\n  };\n\n  var adjustTil = function adjustTil(bridge, movement, original, caret, numRetries) {\n    if (numRetries === 0) {\n      return Option.some(caret);\n    }\n\n    if (isAtTable(bridge, caret.left(), movement.point(caret))) {\n      return adjustForTable(bridge, movement, original, caret, numRetries - 1);\n    }\n\n    return bridge.situsFromPoint(caret.left(), movement.point(caret)).bind(function (guess) {\n      return guess.start().fold(Option.none, function (element) {\n        return Rectangles.getEntireBox(bridge, element).bind(function (guessBox) {\n          return movement.adjuster(bridge, element, guessBox, original, caret).fold(Option.none, function (newCaret) {\n            return adjustTil(bridge, movement, original, newCaret, numRetries - 1);\n          });\n        }).orThunk(function () {\n          return Option.some(caret);\n        });\n      }, Option.none);\n    });\n  };\n\n  var ieTryDown = function ieTryDown(bridge, caret) {\n    return bridge.situsFromPoint(caret.left(), caret.bottom() + JUMP_SIZE);\n  };\n\n  var ieTryUp = function ieTryUp(bridge, caret) {\n    return bridge.situsFromPoint(caret.left(), caret.top() - JUMP_SIZE);\n  };\n\n  var checkScroll = function checkScroll(movement, adjusted, bridge) {\n    if (movement.point(adjusted) > bridge.getInnerHeight()) {\n      return Option.some(movement.point(adjusted) - bridge.getInnerHeight());\n    } else if (movement.point(adjusted) < 0) {\n      return Option.some(-movement.point(adjusted));\n    } else {\n      return Option.none();\n    }\n  };\n\n  var retry = function retry(movement, bridge, caret) {\n    var moved = movement.move(caret, JUMP_SIZE);\n    var adjusted = adjustTil(bridge, movement, caret, moved, NUM_RETRIES).getOr(moved);\n    return checkScroll(movement, adjusted, bridge).fold(function () {\n      return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted));\n    }, function (delta) {\n      bridge.scrollBy(0, delta);\n      return bridge.situsFromPoint(adjusted.left(), movement.point(adjusted) - delta);\n    });\n  };\n\n  var Retries = {\n    tryUp: curry(retry, upMovement),\n    tryDown: curry(retry, downMovement),\n    ieTryUp: ieTryUp,\n    ieTryDown: ieTryDown,\n    getJumpSize: constant(JUMP_SIZE)\n  };\n  var MAX_RETRIES = 20;\n  var platform$1 = PlatformDetection$1.detect();\n\n  var findSpot = function findSpot(bridge, isRoot, direction) {\n    return bridge.getSelection().bind(function (sel) {\n      return BrTags.tryBr(isRoot, sel.finish(), sel.foffset(), direction).fold(function () {\n        return Option.some(point(sel.finish(), sel.foffset()));\n      }, function (brNeighbour) {\n        var range = bridge.fromSitus(brNeighbour);\n        var analysis = BeforeAfter.verify(bridge, sel.finish(), sel.foffset(), range.finish(), range.foffset(), direction.failure, isRoot);\n        return BrTags.process(analysis);\n      });\n    });\n  };\n\n  var scan = function scan(bridge, isRoot, element, offset, direction, numRetries) {\n    if (numRetries === 0) {\n      return Option.none();\n    }\n\n    return tryCursor(bridge, isRoot, element, offset, direction).bind(function (situs) {\n      var range = bridge.fromSitus(situs);\n      var analysis = BeforeAfter.verify(bridge, element, offset, range.finish(), range.foffset(), direction.failure, isRoot);\n      return BeforeAfter.cata(analysis, function () {\n        return Option.none();\n      }, function () {\n        return Option.some(situs);\n      }, function (cell) {\n        if (eq(element, cell) && offset === 0) {\n          return tryAgain(bridge, element, offset, Carets.moveUp, direction);\n        } else {\n          return scan(bridge, isRoot, cell, 0, direction, numRetries - 1);\n        }\n      }, function (cell) {\n        if (eq(element, cell) && offset === getEnd(cell)) {\n          return tryAgain(bridge, element, offset, Carets.moveDown, direction);\n        } else {\n          return scan(bridge, isRoot, cell, getEnd(cell), direction, numRetries - 1);\n        }\n      });\n    });\n  };\n\n  var tryAgain = function tryAgain(bridge, element, offset, move, direction) {\n    return Rectangles.getBoxAt(bridge, element, offset).bind(function (box) {\n      return tryAt(bridge, direction, move(box, Retries.getJumpSize()));\n    });\n  };\n\n  var tryAt = function tryAt(bridge, direction, box) {\n    if (platform$1.browser.isChrome() || platform$1.browser.isSafari() || platform$1.browser.isFirefox() || platform$1.browser.isEdge()) {\n      return direction.otherRetry(bridge, box);\n    } else if (platform$1.browser.isIE()) {\n      return direction.ieRetry(bridge, box);\n    } else {\n      return Option.none();\n    }\n  };\n\n  var tryCursor = function tryCursor(bridge, isRoot, element, offset, direction) {\n    return Rectangles.getBoxAt(bridge, element, offset).bind(function (box) {\n      return tryAt(bridge, direction, box);\n    });\n  };\n\n  var handle$2 = function handle$2(bridge, isRoot, direction) {\n    return findSpot(bridge, isRoot, direction).bind(function (spot) {\n      return scan(bridge, isRoot, spot.element(), spot.offset(), direction, MAX_RETRIES).map(bridge.fromSitus);\n    });\n  };\n\n  var TableKeys = {\n    handle: handle$2\n  };\n  var detection = PlatformDetection$1.detect();\n\n  var inSameTable = function inSameTable(elem, table) {\n    return ancestor$2(elem, function (e) {\n      return parent(e).exists(function (p) {\n        return eq(p, table);\n      });\n    });\n  };\n\n  var simulate = function simulate(bridge, isRoot, direction, initial, anchor) {\n    return closest$1(initial, 'td,th', isRoot).bind(function (start) {\n      return closest$1(start, 'table', isRoot).bind(function (table) {\n        if (!inSameTable(anchor, table)) {\n          return Option.none();\n        }\n\n        return TableKeys.handle(bridge, isRoot, direction).bind(function (range) {\n          return closest$1(range.finish(), 'td,th', isRoot).map(function (finish) {\n            return {\n              start: constant(start),\n              finish: constant(finish),\n              range: constant(range)\n            };\n          });\n        });\n      });\n    });\n  };\n\n  var navigate = function navigate(bridge, isRoot, direction, initial, anchor, precheck) {\n    if (detection.browser.isIE()) {\n      return Option.none();\n    } else {\n      return precheck(initial, isRoot).orThunk(function () {\n        return simulate(bridge, isRoot, direction, initial, anchor).map(function (info) {\n          var range = info.range();\n          return Response.create(Option.some(Util.makeSitus(range.start(), range.soffset(), range.finish(), range.foffset())), true);\n        });\n      });\n    }\n  };\n\n  var firstUpCheck = function firstUpCheck(initial, isRoot) {\n    return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n      return closest$1(startRow, 'table', isRoot).bind(function (table) {\n        var rows = descendants$1(table, 'tr');\n\n        if (eq(startRow, rows[0])) {\n          return seekLeft$1(table, function (element) {\n            return last$1(element).isSome();\n          }, isRoot).map(function (last) {\n            var lastOffset = getEnd(last);\n            return Response.create(Option.some(Util.makeSitus(last, lastOffset, last, lastOffset)), true);\n          });\n        } else {\n          return Option.none();\n        }\n      });\n    });\n  };\n\n  var lastDownCheck = function lastDownCheck(initial, isRoot) {\n    return closest$1(initial, 'tr', isRoot).bind(function (startRow) {\n      return closest$1(startRow, 'table', isRoot).bind(function (table) {\n        var rows = descendants$1(table, 'tr');\n\n        if (eq(startRow, rows[rows.length - 1])) {\n          return seekRight$1(table, function (element) {\n            return first(element).isSome();\n          }, isRoot).map(function (first) {\n            return Response.create(Option.some(Util.makeSitus(first, 0, first, 0)), true);\n          });\n        } else {\n          return Option.none();\n        }\n      });\n    });\n  };\n\n  var select = function select(bridge, container, isRoot, direction, initial, anchor, selectRange) {\n    return simulate(bridge, isRoot, direction, initial, anchor).bind(function (info) {\n      return KeySelection.detect(container, isRoot, info.start(), info.finish(), selectRange);\n    });\n  };\n\n  var VerticalMovement = {\n    navigate: navigate,\n    select: select,\n    firstUpCheck: firstUpCheck,\n    lastDownCheck: lastDownCheck\n  };\n\n  var findCell = function findCell(target, isRoot) {\n    return closest$1(target, 'td,th', isRoot);\n  };\n\n  function MouseSelection(bridge, container, isRoot, annotations) {\n    var cursor = Option.none();\n\n    var clearState = function clearState() {\n      cursor = Option.none();\n    };\n\n    var mousedown = function mousedown(event) {\n      annotations.clear(container);\n      cursor = findCell(event.target(), isRoot);\n    };\n\n    var mouseover = function mouseover(event) {\n      cursor.each(function (start) {\n        annotations.clear(container);\n        findCell(event.target(), isRoot).each(function (finish) {\n          CellSelection.identify(start, finish, isRoot).each(function (cellSel) {\n            var boxes = cellSel.boxes().getOr([]);\n\n            if (boxes.length > 1 || boxes.length === 1 && !eq(start, finish)) {\n              annotations.selectRange(container, boxes, cellSel.start(), cellSel.finish());\n              bridge.selectContents(finish);\n            }\n          });\n        });\n      });\n    };\n\n    var mouseup = function mouseup(_event) {\n      cursor.each(clearState);\n    };\n\n    return {\n      mousedown: mousedown,\n      mouseover: mouseover,\n      mouseup: mouseup\n    };\n  }\n\n  var down = {\n    traverse: nextSibling,\n    gather: after$5,\n    relative: Situ.before,\n    otherRetry: Retries.tryDown,\n    ieRetry: Retries.ieTryDown,\n    failure: BeforeAfter.failedDown\n  };\n  var up = {\n    traverse: prevSibling,\n    gather: before$4,\n    relative: Situ.before,\n    otherRetry: Retries.tryUp,\n    ieRetry: Retries.ieTryUp,\n    failure: BeforeAfter.failedUp\n  };\n  var KeyDirection = {\n    down: down,\n    up: up\n  };\n\n  var isKey = function isKey(key) {\n    return function (keycode) {\n      return keycode === key;\n    };\n  };\n\n  var isUp = isKey(38);\n  var isDown = isKey(40);\n\n  var isNavigation = function isNavigation(keycode) {\n    return keycode >= 37 && keycode <= 40;\n  };\n\n  var SelectionKeys = {\n    ltr: {\n      isBackward: isKey(37),\n      isForward: isKey(39)\n    },\n    rtl: {\n      isBackward: isKey(39),\n      isForward: isKey(37)\n    },\n    isUp: isUp,\n    isDown: isDown,\n    isNavigation: isNavigation\n  };\n\n  var toRaw = function toRaw(sr) {\n    return {\n      left: sr.left(),\n      top: sr.top(),\n      right: sr.right(),\n      bottom: sr.bottom(),\n      width: sr.width(),\n      height: sr.height()\n    };\n  };\n\n  var Rect = {\n    toRaw: toRaw\n  };\n  var isSafari = PlatformDetection$1.detect().browser.isSafari();\n\n  var get$b = function get$b(_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return Position(x, y);\n  };\n\n  var by = function by(x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom() : domGlobals.document;\n    var win = doc.defaultView;\n    win.scrollBy(x, y);\n  };\n\n  var WindowBridge = function WindowBridge(win) {\n    var elementFromPoint = function elementFromPoint(x, y) {\n      return Element.fromPoint(Element.fromDom(win.document), x, y);\n    };\n\n    var getRect = function getRect(element) {\n      return element.dom().getBoundingClientRect();\n    };\n\n    var getRangedRect = function getRangedRect(start, soffset, finish, foffset) {\n      var sel = Selection.exact(start, soffset, finish, foffset);\n      return getFirstRect$1(win, sel).map(Rect.toRaw);\n    };\n\n    var getSelection = function getSelection() {\n      return get$a(win).map(function (exactAdt) {\n        return Util.convertToRange(win, exactAdt);\n      });\n    };\n\n    var fromSitus = function fromSitus(situs) {\n      var relative = Selection.relative(situs.start(), situs.finish());\n      return Util.convertToRange(win, relative);\n    };\n\n    var situsFromPoint = function situsFromPoint(x, y) {\n      return getAtPoint(win, x, y).map(function (exact) {\n        return Situs.create(exact.start(), exact.soffset(), exact.finish(), exact.foffset());\n      });\n    };\n\n    var clearSelection = function clearSelection() {\n      clear(win);\n    };\n\n    var selectContents = function selectContents(element) {\n      setToElement(win, element);\n    };\n\n    var setSelection = function setSelection(sel) {\n      setExact(win, sel.start(), sel.soffset(), sel.finish(), sel.foffset());\n    };\n\n    var setRelativeSelection = function setRelativeSelection(start, finish) {\n      setRelative(win, start, finish);\n    };\n\n    var getInnerHeight = function getInnerHeight() {\n      return win.innerHeight;\n    };\n\n    var getScrollY = function getScrollY() {\n      var pos = get$b(Element.fromDom(win.document));\n      return pos.top();\n    };\n\n    var scrollBy = function scrollBy(x, y) {\n      by(x, y, Element.fromDom(win.document));\n    };\n\n    return {\n      elementFromPoint: elementFromPoint,\n      getRect: getRect,\n      getRangedRect: getRangedRect,\n      getSelection: getSelection,\n      fromSitus: fromSitus,\n      situsFromPoint: situsFromPoint,\n      clearSelection: clearSelection,\n      setSelection: setSelection,\n      setRelativeSelection: setRelativeSelection,\n      selectContents: selectContents,\n      getInnerHeight: getInnerHeight,\n      getScrollY: getScrollY,\n      scrollBy: scrollBy\n    };\n  };\n\n  var rc = Immutable('rows', 'cols');\n\n  var mouse = function mouse(win, container, isRoot, annotations) {\n    var bridge = WindowBridge(win);\n    var handlers = MouseSelection(bridge, container, isRoot, annotations);\n    return {\n      mousedown: handlers.mousedown,\n      mouseover: handlers.mouseover,\n      mouseup: handlers.mouseup\n    };\n  };\n\n  var keyboard = function keyboard(win, container, isRoot, annotations) {\n    var bridge = WindowBridge(win);\n\n    var clearToNavigate = function clearToNavigate() {\n      annotations.clear(container);\n      return Option.none();\n    };\n\n    var keydown = function keydown(event, start, soffset, finish, foffset, direction) {\n      var realEvent = event.raw();\n      var keycode = realEvent.which;\n      var shiftKey = realEvent.shiftKey === true;\n      var handler = CellSelection.retrieve(container, annotations.selectedSelector()).fold(function () {\n        if (SelectionKeys.isDown(keycode) && shiftKey) {\n          return curry(VerticalMovement.select, bridge, container, isRoot, KeyDirection.down, finish, start, annotations.selectRange);\n        } else if (SelectionKeys.isUp(keycode) && shiftKey) {\n          return curry(VerticalMovement.select, bridge, container, isRoot, KeyDirection.up, finish, start, annotations.selectRange);\n        } else if (SelectionKeys.isDown(keycode)) {\n          return curry(VerticalMovement.navigate, bridge, isRoot, KeyDirection.down, finish, start, VerticalMovement.lastDownCheck);\n        } else if (SelectionKeys.isUp(keycode)) {\n          return curry(VerticalMovement.navigate, bridge, isRoot, KeyDirection.up, finish, start, VerticalMovement.firstUpCheck);\n        } else {\n          return Option.none;\n        }\n      }, function (selected) {\n        var update = function update(attempts) {\n          return function () {\n            var navigation = findMap(attempts, function (delta) {\n              return KeySelection.update(delta.rows(), delta.cols(), container, selected, annotations);\n            });\n            return navigation.fold(function () {\n              return CellSelection.getEdges(container, annotations.firstSelectedSelector(), annotations.lastSelectedSelector()).map(function (edges) {\n                var relative = SelectionKeys.isDown(keycode) || direction.isForward(keycode) ? Situ.after : Situ.before;\n                bridge.setRelativeSelection(Situ.on(edges.first(), 0), relative(edges.table()));\n                annotations.clear(container);\n                return Response.create(Option.none(), true);\n              });\n            }, function (_) {\n              return Option.some(Response.create(Option.none(), true));\n            });\n          };\n        };\n\n        if (SelectionKeys.isDown(keycode) && shiftKey) {\n          return update([rc(+1, 0)]);\n        } else if (SelectionKeys.isUp(keycode) && shiftKey) {\n          return update([rc(-1, 0)]);\n        } else if (direction.isBackward(keycode) && shiftKey) {\n          return update([rc(0, -1), rc(-1, 0)]);\n        } else if (direction.isForward(keycode) && shiftKey) {\n          return update([rc(0, +1), rc(+1, 0)]);\n        } else if (SelectionKeys.isNavigation(keycode) && shiftKey === false) {\n          return clearToNavigate;\n        } else {\n          return Option.none;\n        }\n      });\n      return handler();\n    };\n\n    var keyup = function keyup(event, start, soffset, finish, foffset) {\n      return CellSelection.retrieve(container, annotations.selectedSelector()).fold(function () {\n        var realEvent = event.raw();\n        var keycode = realEvent.which;\n        var shiftKey = realEvent.shiftKey === true;\n\n        if (shiftKey === false) {\n          return Option.none();\n        }\n\n        if (SelectionKeys.isNavigation(keycode)) {\n          return KeySelection.sync(container, isRoot, start, soffset, finish, foffset, annotations.selectRange);\n        } else {\n          return Option.none();\n        }\n      }, Option.none);\n    };\n\n    return {\n      keydown: keydown,\n      keyup: keyup\n    };\n  };\n\n  var InputHandlers = {\n    mouse: mouse,\n    keyboard: keyboard\n  };\n\n  var remove$7 = function remove$7(element, classes) {\n    each(classes, function (x) {\n      remove$5(element, x);\n    });\n  };\n\n  var addClass = function addClass(clazz) {\n    return function (element) {\n      add$2(element, clazz);\n    };\n  };\n\n  var removeClasses = function removeClasses(classes) {\n    return function (element) {\n      remove$7(element, classes);\n    };\n  };\n\n  var byClass = function byClass(ephemera) {\n    var addSelectionClass = addClass(ephemera.selected());\n    var removeSelectionClasses = removeClasses([ephemera.selected(), ephemera.lastSelected(), ephemera.firstSelected()]);\n\n    var clear = function clear(container) {\n      var sels = descendants$1(container, ephemera.selectedSelector());\n      each(sels, removeSelectionClasses);\n    };\n\n    var selectRange = function selectRange(container, cells, start, finish) {\n      clear(container);\n      each(cells, addSelectionClass);\n      add$2(start, ephemera.firstSelected());\n      add$2(finish, ephemera.lastSelected());\n    };\n\n    return {\n      clear: clear,\n      selectRange: selectRange,\n      selectedSelector: ephemera.selectedSelector,\n      firstSelectedSelector: ephemera.firstSelectedSelector,\n      lastSelectedSelector: ephemera.lastSelectedSelector\n    };\n  };\n\n  var byAttr = function byAttr(ephemera) {\n    var removeSelectionAttributes = function removeSelectionAttributes(element) {\n      remove(element, ephemera.selected());\n      remove(element, ephemera.firstSelected());\n      remove(element, ephemera.lastSelected());\n    };\n\n    var addSelectionAttribute = function addSelectionAttribute(element) {\n      set(element, ephemera.selected(), '1');\n    };\n\n    var clear = function clear(container) {\n      var sels = descendants$1(container, ephemera.selectedSelector());\n      each(sels, removeSelectionAttributes);\n    };\n\n    var selectRange = function selectRange(container, cells, start, finish) {\n      clear(container);\n      each(cells, addSelectionAttribute);\n      set(start, ephemera.firstSelected(), '1');\n      set(finish, ephemera.lastSelected(), '1');\n    };\n\n    return {\n      clear: clear,\n      selectRange: selectRange,\n      selectedSelector: ephemera.selectedSelector,\n      firstSelectedSelector: ephemera.firstSelectedSelector,\n      lastSelectedSelector: ephemera.lastSelectedSelector\n    };\n  };\n\n  var SelectionAnnotation = {\n    byClass: byClass,\n    byAttr: byAttr\n  };\n\n  var hasInternalTarget = function hasInternalTarget(e) {\n    return has$2(Element.fromDom(e.target), 'ephox-snooker-resizer-bar') === false;\n  };\n\n  function CellSelection$1(editor, lazyResize) {\n    var handlerStruct = MixedBag(['mousedown', 'mouseover', 'mouseup', 'keyup', 'keydown'], []);\n    var handlers = Option.none();\n    var annotations = SelectionAnnotation.byAttr(Ephemera);\n    editor.on('init', function (e) {\n      var win = editor.getWin();\n      var body = getBody$1(editor);\n      var isRoot = getIsRoot(editor);\n\n      var syncSelection = function syncSelection() {\n        var sel = editor.selection;\n        var start = Element.fromDom(sel.getStart());\n        var end = Element.fromDom(sel.getEnd());\n        var shared = DomParent.sharedOne(TableLookup.table, [start, end]);\n        shared.fold(function () {\n          annotations.clear(body);\n        }, noop);\n      };\n\n      var mouseHandlers = InputHandlers.mouse(win, body, isRoot, annotations);\n      var keyHandlers = InputHandlers.keyboard(win, body, isRoot, annotations);\n\n      var hasShiftKey = function hasShiftKey(event) {\n        return event.raw().shiftKey === true;\n      };\n\n      var handleResponse = function handleResponse(event, response) {\n        if (!hasShiftKey(event)) {\n          return;\n        }\n\n        if (response.kill()) {\n          event.kill();\n        }\n\n        response.selection().each(function (ns) {\n          var relative = Selection.relative(ns.start(), ns.finish());\n          var rng = asLtrRange(win, relative);\n          editor.selection.setRng(rng);\n        });\n      };\n\n      var keyup = function keyup(event) {\n        var wrappedEvent = wrapEvent(event);\n\n        if (wrappedEvent.raw().shiftKey && SelectionKeys.isNavigation(wrappedEvent.raw().which)) {\n          var rng = editor.selection.getRng();\n          var start = Element.fromDom(rng.startContainer);\n          var end = Element.fromDom(rng.endContainer);\n          keyHandlers.keyup(wrappedEvent, start, rng.startOffset, end, rng.endOffset).each(function (response) {\n            handleResponse(wrappedEvent, response);\n          });\n        }\n      };\n\n      var keydown = function keydown(event) {\n        var wrappedEvent = wrapEvent(event);\n        lazyResize().each(function (resize) {\n          resize.hideBars();\n        });\n        var rng = editor.selection.getRng();\n        var startContainer = Element.fromDom(editor.selection.getStart());\n        var start = Element.fromDom(rng.startContainer);\n        var end = Element.fromDom(rng.endContainer);\n        var direction = Direction.directionAt(startContainer).isRtl() ? SelectionKeys.rtl : SelectionKeys.ltr;\n        keyHandlers.keydown(wrappedEvent, start, rng.startOffset, end, rng.endOffset, direction).each(function (response) {\n          handleResponse(wrappedEvent, response);\n        });\n        lazyResize().each(function (resize) {\n          resize.showBars();\n        });\n      };\n\n      var isMouseEvent = function isMouseEvent(event) {\n        return event.hasOwnProperty('x') && event.hasOwnProperty('y');\n      };\n\n      var wrapEvent = function wrapEvent(event) {\n        var target = Element.fromDom(event.target);\n\n        var stop = function stop() {\n          event.stopPropagation();\n        };\n\n        var prevent = function prevent() {\n          event.preventDefault();\n        };\n\n        var kill = compose(prevent, stop);\n        return {\n          target: constant(target),\n          x: constant(isMouseEvent(event) ? event.x : null),\n          y: constant(isMouseEvent(event) ? event.y : null),\n          stop: stop,\n          prevent: prevent,\n          kill: kill,\n          raw: constant(event)\n        };\n      };\n\n      var isLeftMouse = function isLeftMouse(raw) {\n        return raw.button === 0;\n      };\n\n      var isLeftButtonPressed = function isLeftButtonPressed(raw) {\n        if (raw.buttons === undefined) {\n          return true;\n        }\n\n        return (raw.buttons & 1) !== 0;\n      };\n\n      var mouseDown = function mouseDown(e) {\n        if (isLeftMouse(e) && hasInternalTarget(e)) {\n          mouseHandlers.mousedown(wrapEvent(e));\n        }\n      };\n\n      var mouseOver = function mouseOver(e) {\n        if (isLeftButtonPressed(e) && hasInternalTarget(e)) {\n          mouseHandlers.mouseover(wrapEvent(e));\n        }\n      };\n\n      var mouseUp = function mouseUp(e) {\n        if (isLeftMouse(e) && hasInternalTarget(e)) {\n          mouseHandlers.mouseup(wrapEvent(e));\n        }\n      };\n\n      editor.on('mousedown', mouseDown);\n      editor.on('mouseover', mouseOver);\n      editor.on('mouseup', mouseUp);\n      editor.on('keyup', keyup);\n      editor.on('keydown', keydown);\n      editor.on('NodeChange', syncSelection);\n      handlers = Option.some(handlerStruct({\n        mousedown: mouseDown,\n        mouseover: mouseOver,\n        mouseup: mouseUp,\n        keyup: keyup,\n        keydown: keydown\n      }));\n    });\n\n    var destroy = function destroy() {\n      handlers.each(function (handlers) {});\n    };\n\n    return {\n      clear: annotations.clear,\n      destroy: destroy\n    };\n  }\n\n  var Selections = function Selections(editor) {\n    var get = function get() {\n      var body = getBody$1(editor);\n      return TableSelection.retrieve(body, Ephemera.selectedSelector()).fold(function () {\n        if (editor.selection.getStart() === undefined) {\n          return SelectionTypes.none();\n        } else {\n          return SelectionTypes.single(editor.selection);\n        }\n      }, function (cells) {\n        return SelectionTypes.multiple(cells);\n      });\n    };\n\n    return {\n      get: get\n    };\n  };\n\n  var getSelectionTargets = function getSelectionTargets(editor, selections) {\n    var _targets = Cell(Option.none());\n\n    var changeHandlers = Cell([]);\n\n    var findTargets = function findTargets() {\n      return getSelectionStartCellOrCaption(editor).bind(function (cellOrCaption) {\n        var table = TableLookup.table(cellOrCaption);\n        return table.map(function (table) {\n          if (name(cellOrCaption) === 'caption') {\n            return TableTargets.notCell(cellOrCaption);\n          } else {\n            return TableTargets.forMenu(selections, table, cellOrCaption);\n          }\n        });\n      });\n    };\n\n    var resetTargets = function resetTargets() {\n      _targets.set(cached(findTargets)());\n\n      each(changeHandlers.get(), function (handler) {\n        return handler();\n      });\n    };\n\n    var onSetup = function onSetup(api, isDisabled) {\n      var handler = function handler() {\n        return _targets.get().fold(function () {\n          api.setDisabled(true);\n        }, function (targets) {\n          api.setDisabled(isDisabled(targets));\n        });\n      };\n\n      handler();\n      changeHandlers.set(changeHandlers.get().concat([handler]));\n      return function () {\n        changeHandlers.set(filter(changeHandlers.get(), function (h) {\n          return h !== handler;\n        }));\n      };\n    };\n\n    var onSetupTable = function onSetupTable(api) {\n      return onSetup(api, function (_) {\n        return false;\n      });\n    };\n\n    var onSetupCellOrRow = function onSetupCellOrRow(api) {\n      return onSetup(api, function (targets) {\n        return name(targets.element()) === 'caption';\n      });\n    };\n\n    var onSetupMergeable = function onSetupMergeable(api) {\n      return onSetup(api, function (targets) {\n        return targets.mergable().isNone();\n      });\n    };\n\n    var onSetupUnmergeable = function onSetupUnmergeable(api) {\n      return onSetup(api, function (targets) {\n        return targets.unmergable().isNone();\n      });\n    };\n\n    editor.on('NodeChange', resetTargets);\n    return {\n      onSetupTable: onSetupTable,\n      onSetupCellOrRow: onSetupCellOrRow,\n      onSetupMergeable: onSetupMergeable,\n      onSetupUnmergeable: onSetupUnmergeable,\n      resetTargets: resetTargets,\n      targets: function targets() {\n        return _targets.get();\n      }\n    };\n  };\n\n  var addButtons = function addButtons(editor, selectionTargets) {\n    editor.ui.registry.addMenuButton('table', {\n      tooltip: 'Table',\n      icon: 'table',\n      fetch: function fetch(callback) {\n        return callback('inserttable tableprops deletetable | cell row column');\n      }\n    });\n\n    var cmd = function cmd(command) {\n      return function () {\n        return editor.execCommand(command);\n      };\n    };\n\n    editor.ui.registry.addButton('tableprops', {\n      tooltip: 'Table properties',\n      onAction: cmd('mceTableProps'),\n      icon: 'table',\n      onSetup: selectionTargets.onSetupTable\n    });\n    editor.ui.registry.addButton('tabledelete', {\n      tooltip: 'Delete table',\n      onAction: cmd('mceTableDelete'),\n      icon: 'table-delete-table',\n      onSetup: selectionTargets.onSetupTable\n    });\n    editor.ui.registry.addButton('tablecellprops', {\n      tooltip: 'Cell properties',\n      onAction: cmd('mceTableCellProps'),\n      icon: 'table-cell-properties',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablemergecells', {\n      tooltip: 'Merge cells',\n      onAction: cmd('mceTableMergeCells'),\n      icon: 'table-merge-cells',\n      onSetup: selectionTargets.onSetupMergeable\n    });\n    editor.ui.registry.addButton('tablesplitcells', {\n      tooltip: 'Split cell',\n      onAction: cmd('mceTableSplitCells'),\n      icon: 'table-split-cells',\n      onSetup: selectionTargets.onSetupUnmergeable\n    });\n    editor.ui.registry.addButton('tableinsertrowbefore', {\n      tooltip: 'Insert row before',\n      onAction: cmd('mceTableInsertRowBefore'),\n      icon: 'table-insert-row-above',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tableinsertrowafter', {\n      tooltip: 'Insert row after',\n      onAction: cmd('mceTableInsertRowAfter'),\n      icon: 'table-insert-row-after',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tabledeleterow', {\n      tooltip: 'Delete row',\n      onAction: cmd('mceTableDeleteRow'),\n      icon: 'table-delete-row',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablerowprops', {\n      tooltip: 'Row properties',\n      onAction: cmd('mceTableRowProps'),\n      icon: 'table-row-properties',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tableinsertcolbefore', {\n      tooltip: 'Insert column before',\n      onAction: cmd('mceTableInsertColBefore'),\n      icon: 'table-insert-column-before',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tableinsertcolafter', {\n      tooltip: 'Insert column after',\n      onAction: cmd('mceTableInsertColAfter'),\n      icon: 'table-insert-column-after',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tabledeletecol', {\n      tooltip: 'Delete column',\n      onAction: cmd('mceTableDeleteCol'),\n      icon: 'table-delete-column',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablecutrow', {\n      tooltip: 'Cut row',\n      onAction: cmd('mceTableCutRow'),\n      icon: 'temporary-placeholder',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablecopyrow', {\n      tooltip: 'Copy row',\n      onAction: cmd('mceTableCopyRow'),\n      icon: 'temporary-placeholder',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablepasterowbefore', {\n      tooltip: 'Paste row before',\n      onAction: cmd('mceTablePasteRowBefore'),\n      icon: 'temporary-placeholder',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tablepasterowafter', {\n      tooltip: 'Paste row after',\n      onAction: cmd('mceTablePasteRowAfter'),\n      icon: 'temporary-placeholder',\n      onSetup: selectionTargets.onSetupCellOrRow\n    });\n    editor.ui.registry.addButton('tableinsertdialog', {\n      tooltip: 'Insert table',\n      onAction: cmd('mceInsertTable'),\n      icon: 'table'\n    });\n  };\n\n  var addToolbars = function addToolbars(editor) {\n    var isTable = function isTable(table) {\n      return editor.dom.is(table, 'table') && editor.getBody().contains(table);\n    };\n\n    var toolbar = getToolbar(editor);\n\n    if (toolbar.length > 0) {\n      editor.ui.registry.addContextToolbar('table', {\n        predicate: isTable,\n        items: toolbar,\n        scope: 'node',\n        position: 'node'\n      });\n    }\n  };\n\n  var Buttons = {\n    addButtons: addButtons,\n    addToolbars: addToolbars\n  };\n\n  var addMenuItems = function addMenuItems(editor, selectionTargets) {\n    var cmd = function cmd(command) {\n      return function () {\n        return editor.execCommand(command);\n      };\n    };\n\n    var insertTableAction = function insertTableAction(_a) {\n      var numRows = _a.numRows,\n          numColumns = _a.numColumns;\n      editor.undoManager.transact(function () {\n        InsertTable.insert(editor, numColumns, numRows);\n      });\n      editor.addVisual();\n    };\n\n    var tableProperties = {\n      text: 'Table properties',\n      onSetup: selectionTargets.onSetupTable,\n      onAction: cmd('mceTableProps')\n    };\n    var deleteTable = {\n      text: 'Delete table',\n      icon: 'table-delete-table',\n      onSetup: selectionTargets.onSetupTable,\n      onAction: cmd('mceTableDelete')\n    };\n    var rowItems = [{\n      type: 'menuitem',\n      text: 'Insert row before',\n      icon: 'table-insert-row-above',\n      onAction: cmd('mceTableInsertRowBefore'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Insert row after',\n      icon: 'table-insert-row-after',\n      onAction: cmd('mceTableInsertRowAfter'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Delete row',\n      icon: 'table-delete-row',\n      onAction: cmd('mceTableDeleteRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Row properties',\n      icon: 'table-row-properties',\n      onAction: cmd('mceTableRowProps'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'separator'\n    }, {\n      type: 'menuitem',\n      text: 'Cut row',\n      onAction: cmd('mceTableCutRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Copy row',\n      onAction: cmd('mceTableCopyRow'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Paste row before',\n      onAction: cmd('mceTablePasteRowBefore'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Paste row after',\n      onAction: cmd('mceTablePasteRowAfter'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }];\n    var row = {\n      type: 'nestedmenuitem',\n      text: 'Row',\n      getSubmenuItems: function getSubmenuItems() {\n        return rowItems;\n      }\n    };\n    var columnItems = [{\n      type: 'menuitem',\n      text: 'Insert column before',\n      icon: 'table-insert-column-before',\n      onAction: cmd('mceTableInsertColBefore'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Insert column after',\n      icon: 'table-insert-column-after',\n      onAction: cmd('mceTableInsertColAfter'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Delete column',\n      icon: 'table-delete-column',\n      onAction: cmd('mceTableDeleteCol'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }];\n    var column = {\n      type: 'nestedmenuitem',\n      text: 'Column',\n      getSubmenuItems: function getSubmenuItems() {\n        return columnItems;\n      }\n    };\n    var cellItems = [{\n      type: 'menuitem',\n      text: 'Cell properties',\n      icon: 'table-cell-properties',\n      onAction: cmd('mceTableCellProps'),\n      onSetup: selectionTargets.onSetupCellOrRow\n    }, {\n      type: 'menuitem',\n      text: 'Merge cells',\n      icon: 'table-merge-cells',\n      onAction: cmd('mceTableMergeCells'),\n      onSetup: selectionTargets.onSetupMergeable\n    }, {\n      type: 'menuitem',\n      text: 'Split cell',\n      icon: 'table-split-cells',\n      onAction: cmd('mceTableSplitCells'),\n      onSetup: selectionTargets.onSetupUnmergeable\n    }];\n    var cell = {\n      type: 'nestedmenuitem',\n      text: 'Cell',\n      getSubmenuItems: function getSubmenuItems() {\n        return cellItems;\n      }\n    };\n\n    if (hasTableGrid(editor) === false) {\n      editor.ui.registry.addMenuItem('inserttable', {\n        text: 'Table',\n        icon: 'table',\n        onAction: cmd('mceInsertTable')\n      });\n    } else {\n      editor.ui.registry.addNestedMenuItem('inserttable', {\n        text: 'Table',\n        icon: 'table',\n        getSubmenuItems: function getSubmenuItems() {\n          return [{\n            type: 'fancymenuitem',\n            fancytype: 'inserttable',\n            onAction: insertTableAction\n          }];\n        }\n      });\n    }\n\n    editor.ui.registry.addMenuItem('inserttabledialog', {\n      text: 'Insert table',\n      icon: 'table',\n      onAction: cmd('mceInsertTable')\n    });\n    editor.ui.registry.addMenuItem('tableprops', tableProperties);\n    editor.ui.registry.addMenuItem('deletetable', deleteTable);\n    editor.ui.registry.addNestedMenuItem('row', row);\n    editor.ui.registry.addNestedMenuItem('column', column);\n    editor.ui.registry.addNestedMenuItem('cell', cell);\n    editor.ui.registry.addContextMenu('table', {\n      update: function update() {\n        selectionTargets.resetTargets();\n        return selectionTargets.targets().fold(function () {\n          return '';\n        }, function (targets) {\n          if (name(targets.element()) === 'caption') {\n            return 'tableprops deletetable';\n          } else {\n            return 'cell row column | tableprops deletetable';\n          }\n        });\n      }\n    });\n    return {\n      rowItems: rowItems,\n      columnItems: columnItems,\n      cellItems: cellItems\n    };\n  };\n\n  var MenuItems = {\n    addMenuItems: addMenuItems\n  };\n\n  var _getClipboardRows = function getClipboardRows(clipboardRows) {\n    return clipboardRows.get().fold(function () {\n      return;\n    }, function (rows) {\n      return map(rows, function (row) {\n        return row.dom();\n      });\n    });\n  };\n\n  var _setClipboardRows = function setClipboardRows(rows, clipboardRows) {\n    var sugarRows = map(rows, Element.fromDom);\n    clipboardRows.set(Option.from(sugarRows));\n  };\n\n  var getApi = function getApi(editor, clipboardRows, resizeHandler, selectionTargets, menuItems) {\n    return {\n      insertTable: function insertTable(columns, rows) {\n        return InsertTable.insert(editor, columns, rows);\n      },\n      setClipboardRows: function setClipboardRows(rows) {\n        return _setClipboardRows(rows, clipboardRows);\n      },\n      getClipboardRows: function getClipboardRows() {\n        return _getClipboardRows(clipboardRows);\n      },\n      resizeHandler: resizeHandler,\n      menuItems: menuItems,\n      selectionTargets: selectionTargets\n    };\n  };\n\n  function Plugin(editor) {\n    var resizeHandler = getResizeHandler(editor);\n    var cellSelection = CellSelection$1(editor, resizeHandler.lazyResize);\n    var actions = TableActions(editor, resizeHandler.lazyWire);\n    var selections = Selections(editor);\n    var selectionTargets = getSelectionTargets(editor, selections);\n    var clipboardRows = Cell(Option.none());\n    Commands.registerCommands(editor, actions, cellSelection, selections, clipboardRows);\n    Clipboard.registerEvents(editor, selections, actions, cellSelection);\n    var menuItems = MenuItems.addMenuItems(editor, selectionTargets);\n    Buttons.addButtons(editor, selectionTargets);\n    Buttons.addToolbars(editor);\n    editor.on('PreInit', function () {\n      editor.serializer.addTempAttr(Ephemera.firstSelected());\n      editor.serializer.addTempAttr(Ephemera.lastSelected());\n    });\n\n    if (hasTabNavigation(editor)) {\n      editor.on('keydown', function (e) {\n        TabContext.handle(e, editor, actions, resizeHandler.lazyWire);\n      });\n    }\n\n    editor.on('remove', function () {\n      resizeHandler.destroy();\n      cellSelection.destroy();\n    });\n    return getApi(editor, clipboardRows, resizeHandler, selectionTargets, menuItems);\n  }\n\n  function Plugin$1() {\n    global.add('table', Plugin);\n  }\n\n  Plugin$1();\n})(window);","require(\"core-js/modules/es6.regexp.flags\");\n\nrequire(\"core-js/modules/es6.function.bind\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.object.assign\");\n\nrequire(\"core-js/modules/es6.string.anchor\");\n\nrequire(\"core-js/modules/es6.string.link\");\n\nrequire(\"core-js/modules/es6.array.some\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nrequire(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.array.sort\");\n\nrequire(\"core-js/modules/es6.string.trim\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.array.from\");\n\nrequire(\"core-js/modules/es6.array.index-of\");\n\nrequire(\"core-js/modules/es6.object.freeze\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\n/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.0.15 (2019-09-02)\n */\n(function (domGlobals) {\n  'use strict';\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n  var global$2 = tinymce.util.Tools.resolve('tinymce.util.VK');\n\n  var typeOf = function typeOf(x) {\n    if (x === null) {\n      return 'null';\n    }\n\n    var t = typeof x;\n\n    if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    }\n\n    if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    }\n\n    return t;\n  };\n\n  var isType = function isType(type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isString = isType('string');\n  var isArray = isType('array');\n  var isBoolean = isType('boolean');\n  var isFunction = isType('function');\n\n  var assumeExternalTargets = function assumeExternalTargets(editor) {\n    var externalTargets = editor.getParam('link_assume_external_targets', false);\n\n    if (isBoolean(externalTargets) && externalTargets) {\n      return 1;\n    } else if (isString(externalTargets) && (externalTargets === 'http' || externalTargets === 'https')) {\n      return externalTargets;\n    }\n\n    return 0;\n  };\n\n  var hasContextToolbar = function hasContextToolbar(editor) {\n    return editor.getParam('link_context_toolbar', false, 'boolean');\n  };\n\n  var getLinkList = function getLinkList(editor) {\n    return editor.getParam('link_list');\n  };\n\n  var getDefaultLinkTarget = function getDefaultLinkTarget(editor) {\n    return editor.getParam('default_link_target');\n  };\n\n  var getTargetList = function getTargetList(editor) {\n    return editor.getParam('target_list', true);\n  };\n\n  var getRelList = function getRelList(editor) {\n    return editor.getParam('rel_list', [], 'array');\n  };\n\n  var getLinkClassList = function getLinkClassList(editor) {\n    return editor.getParam('link_class_list', [], 'array');\n  };\n\n  var shouldShowLinkTitle = function shouldShowLinkTitle(editor) {\n    return editor.getParam('link_title', true, 'boolean');\n  };\n\n  var allowUnsafeLinkTarget = function allowUnsafeLinkTarget(editor) {\n    return editor.getParam('allow_unsafe_link_target', false, 'boolean');\n  };\n\n  var useQuickLink = function useQuickLink(editor) {\n    return editor.getParam('link_quicklink', false, 'boolean');\n  };\n\n  var Settings = {\n    assumeExternalTargets: assumeExternalTargets,\n    hasContextToolbar: hasContextToolbar,\n    getLinkList: getLinkList,\n    getDefaultLinkTarget: getDefaultLinkTarget,\n    getTargetList: getTargetList,\n    getRelList: getRelList,\n    getLinkClassList: getLinkClassList,\n    shouldShowLinkTitle: shouldShowLinkTitle,\n    allowUnsafeLinkTarget: allowUnsafeLinkTarget,\n    useQuickLink: useQuickLink\n  };\n  var global$3 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n  var global$4 = tinymce.util.Tools.resolve('tinymce.Env');\n\n  var appendClickRemove = function appendClickRemove(link, evt) {\n    domGlobals.document.body.appendChild(link);\n    link.dispatchEvent(evt);\n    domGlobals.document.body.removeChild(link);\n  };\n\n  var open = function open(url) {\n    if (!global$4.ie || global$4.ie > 10) {\n      var link = domGlobals.document.createElement('a');\n      link.target = '_blank';\n      link.href = url;\n      link.rel = 'noreferrer noopener';\n      var evt = domGlobals.document.createEvent('MouseEvents');\n      evt.initMouseEvent('click', true, true, domGlobals.window, 0, 0, 0, 0, 0, false, false, false, false, 0, null);\n      appendClickRemove(link, evt);\n    } else {\n      var win = domGlobals.window.open('', '_blank');\n\n      if (win) {\n        win.opener = null;\n        var doc = win.document;\n        doc.open();\n        doc.write('<meta http-equiv=\"refresh\" content=\"0; url=' + global$3.DOM.encode(url) + '\">');\n        doc.close();\n      }\n    }\n  };\n\n  var OpenUrl = {\n    open: open\n  };\n\n  var noop = function noop() {};\n\n  var constant = function constant(value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n  var never$1 = never;\n  var always$1 = always;\n\n  var none = function none() {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function eq(o) {\n      return o.isNone();\n    };\n\n    var call = function call(thunk) {\n      return thunk();\n    };\n\n    var id = function id(n) {\n      return n;\n    };\n\n    var noop = function noop() {};\n\n    var nul = function nul() {\n      return null;\n    };\n\n    var undef = function undef() {\n      return undefined;\n    };\n\n    var me = {\n      fold: function fold(n, s) {\n        return n();\n      },\n      is: never$1,\n      isSome: never$1,\n      isNone: always$1,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function getOrDie(msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: nul,\n      getOrUndefined: undef,\n      or: id,\n      orThunk: call,\n      map: none,\n      ap: none,\n      each: noop,\n      bind: none,\n      flatten: none,\n      exists: never$1,\n      forall: always$1,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function toArray() {\n        return [];\n      },\n      toString: constant('none()')\n    };\n\n    if (Object.freeze) {\n      Object.freeze(me);\n    }\n\n    return me;\n  }();\n\n  var some = function some(a) {\n    var constant_a = function constant_a() {\n      return a;\n    };\n\n    var self = function self() {\n      return me;\n    };\n\n    var map = function map(f) {\n      return some(f(a));\n    };\n\n    var bind = function bind(f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function fold(n, s) {\n        return s(a);\n      },\n      is: function is(v) {\n        return a === v;\n      },\n      isSome: always$1,\n      isNone: never$1,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: map,\n      ap: function ap(optfab) {\n        return optfab.fold(none, function (fab) {\n          return some(fab(a));\n        });\n      },\n      each: function each(f) {\n        f(a);\n      },\n      bind: bind,\n      flatten: constant_a,\n      exists: bind,\n      forall: bind,\n      filter: function filter(f) {\n        return f(a) ? me : NONE;\n      },\n      equals: function equals(o) {\n        return o.is(a);\n      },\n      equals_: function equals_(o, elementEq) {\n        return o.fold(never$1, function (b) {\n          return elementEq(a, b);\n        });\n      },\n      toArray: function toArray() {\n        return [a];\n      },\n      toString: function toString() {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from = function from(value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Option = {\n    some: some,\n    none: none,\n    from: from\n  };\n  var slice = Array.prototype.slice;\n\n  var rawIndexOf = function () {\n    var pIndexOf = Array.prototype.indexOf;\n\n    var fastIndex = function fastIndex(xs, x) {\n      return pIndexOf.call(xs, x);\n    };\n\n    var slowIndex = function slowIndex(xs, x) {\n      return slowIndexOf(xs, x);\n    };\n\n    return pIndexOf === undefined ? slowIndex : fastIndex;\n  }();\n\n  var contains = function contains(xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var map = function map(xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i, xs);\n    }\n\n    return r;\n  };\n\n  var each = function each(xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i, xs);\n    }\n  };\n\n  var foldl = function foldl(xs, f, acc) {\n    each(xs, function (x) {\n      acc = f(acc, x);\n    });\n    return acc;\n  };\n\n  var slowIndexOf = function slowIndexOf(xs, x) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (xs[i] === x) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var push = Array.prototype.push;\n\n  var flatten = function flatten(xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      push.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function bind(xs, f) {\n    var output = map(xs, f);\n    return flatten(output);\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return slice.call(x);\n  };\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var hasProtocol = function hasProtocol(url) {\n    return /^\\w+:/i.test(url);\n  };\n\n  var getHref = function getHref(elm) {\n    var href = elm.getAttribute('data-mce-href');\n    return href ? href : elm.getAttribute('href');\n  };\n\n  var applyRelTargetRules = function applyRelTargetRules(rel, isUnsafe) {\n    var rules = ['noopener'];\n    var rels = rel ? rel.split(/\\s+/) : [];\n\n    var toString = function toString(rels) {\n      return global$5.trim(rels.sort().join(' '));\n    };\n\n    var addTargetRules = function addTargetRules(rels) {\n      rels = removeTargetRules(rels);\n      return rels.length > 0 ? rels.concat(rules) : rules;\n    };\n\n    var removeTargetRules = function removeTargetRules(rels) {\n      return rels.filter(function (val) {\n        return global$5.inArray(rules, val) === -1;\n      });\n    };\n\n    var newRels = isUnsafe ? addTargetRules(rels) : removeTargetRules(rels);\n    return newRels.length > 0 ? toString(newRels) : '';\n  };\n\n  var trimCaretContainers = function trimCaretContainers(text) {\n    return text.replace(/\\uFEFF/g, '');\n  };\n\n  var getAnchorElement = function getAnchorElement(editor, selectedElm) {\n    selectedElm = selectedElm || editor.selection.getNode();\n\n    if (isImageFigure(selectedElm)) {\n      return editor.dom.select('a[href]', selectedElm)[0];\n    } else {\n      return editor.dom.getParent(selectedElm, 'a[href]');\n    }\n  };\n\n  var getAnchorText = function getAnchorText(selection, anchorElm) {\n    var text = anchorElm ? anchorElm.innerText || anchorElm.textContent : selection.getContent({\n      format: 'text'\n    });\n    return trimCaretContainers(text);\n  };\n\n  var isLink = function isLink(elm) {\n    return elm && elm.nodeName === 'A' && !!elm.href;\n  };\n\n  var hasLinks = function hasLinks(elements) {\n    return global$5.grep(elements, isLink).length > 0;\n  };\n\n  var isOnlyTextSelected = function isOnlyTextSelected(html) {\n    if (/</.test(html) && (!/^<a [^>]+>[^<]+<\\/a>$/.test(html) || html.indexOf('href=') === -1)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var isImageFigure = function isImageFigure(elm) {\n    return elm && elm.nodeName === 'FIGURE' && /\\bimage\\b/i.test(elm.className);\n  };\n\n  var getLinkAttrs = function getLinkAttrs(data) {\n    return foldl(['title', 'rel', 'class', 'target'], function (acc, key) {\n      data[key].each(function (value) {\n        acc[key] = value.length > 0 ? value : null;\n      });\n      return acc;\n    }, {\n      href: data.href\n    });\n  };\n\n  var handleExternalTargets = function handleExternalTargets(href, assumeExternalTargets) {\n    if ((assumeExternalTargets === 'http' || assumeExternalTargets === 'https') && !hasProtocol(href)) {\n      return assumeExternalTargets + '://' + href;\n    }\n\n    return href;\n  };\n\n  var updateLink = function updateLink(editor, anchorElm, text, linkAttrs) {\n    text.each(function (text) {\n      if (anchorElm.hasOwnProperty('innerText')) {\n        anchorElm.innerText = text;\n      } else {\n        anchorElm.textContent = text;\n      }\n    });\n    editor.dom.setAttribs(anchorElm, linkAttrs);\n    editor.selection.select(anchorElm);\n  };\n\n  var createLink = function createLink(editor, selectedElm, text, linkAttrs) {\n    if (isImageFigure(selectedElm)) {\n      linkImageFigure(editor, selectedElm, linkAttrs);\n    } else {\n      text.fold(function () {\n        editor.execCommand('mceInsertLink', false, linkAttrs);\n      }, function (text) {\n        editor.insertContent(editor.dom.createHTML('a', linkAttrs, editor.dom.encode(text)));\n      });\n    }\n  };\n\n  var link = function link(editor, attachState, data) {\n    editor.undoManager.transact(function () {\n      var selectedElm = editor.selection.getNode();\n      var anchorElm = getAnchorElement(editor, selectedElm);\n      var linkAttrs = getLinkAttrs(data);\n\n      if (!(Settings.getRelList(editor).length > 0) && Settings.allowUnsafeLinkTarget(editor) === false) {\n        var newRel = applyRelTargetRules(linkAttrs.rel, linkAttrs.target === '_blank');\n        linkAttrs.rel = newRel ? newRel : null;\n      }\n\n      if (Option.from(linkAttrs.target).isNone()) {\n        linkAttrs.target = Settings.getDefaultLinkTarget(editor);\n      }\n\n      linkAttrs.href = handleExternalTargets(linkAttrs.href, Settings.assumeExternalTargets(editor));\n\n      if (data.href === attachState.href) {\n        attachState.attach();\n      }\n\n      if (anchorElm) {\n        editor.focus();\n        updateLink(editor, anchorElm, data.text, linkAttrs);\n      } else {\n        createLink(editor, selectedElm, data.text, linkAttrs);\n      }\n    });\n  };\n\n  var unlink = function unlink(editor) {\n    editor.undoManager.transact(function () {\n      var node = editor.selection.getNode();\n\n      if (isImageFigure(node)) {\n        unlinkImageFigure(editor, node);\n      } else {\n        var anchorElm = editor.dom.getParent(node, 'a[href]', editor.getBody());\n\n        if (anchorElm) {\n          editor.dom.remove(anchorElm, true);\n        }\n      }\n\n      editor.focus();\n    });\n  };\n\n  var unlinkImageFigure = function unlinkImageFigure(editor, fig) {\n    var img = editor.dom.select('img', fig)[0];\n\n    if (img) {\n      var a = editor.dom.getParents(img, 'a[href]', fig)[0];\n\n      if (a) {\n        a.parentNode.insertBefore(img, a);\n        editor.dom.remove(a);\n      }\n    }\n  };\n\n  var linkImageFigure = function linkImageFigure(editor, fig, attrs) {\n    var img = editor.dom.select('img', fig)[0];\n\n    if (img) {\n      var a = editor.dom.create('a', attrs);\n      img.parentNode.insertBefore(a, img);\n      a.appendChild(img);\n    }\n  };\n\n  var Utils = {\n    link: link,\n    unlink: unlink,\n    isLink: isLink,\n    hasLinks: hasLinks,\n    getHref: getHref,\n    isOnlyTextSelected: isOnlyTextSelected,\n    getAnchorElement: getAnchorElement,\n    getAnchorText: getAnchorText,\n    applyRelTargetRules: applyRelTargetRules,\n    hasProtocol: hasProtocol\n  };\n\n  var cat = function cat(arr) {\n    var r = [];\n\n    var push = function push(x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var findMap = function findMap(arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Option.none();\n  };\n\n  var getValue = function getValue(item) {\n    return isString(item.value) ? item.value : '';\n  };\n\n  var sanitizeList = function sanitizeList(list, extractValue) {\n    var out = [];\n    global$5.each(list, function (item) {\n      var text = isString(item.text) ? item.text : isString(item.title) ? item.title : '';\n      if (item.menu !== undefined) ;else {\n        var value = extractValue(item);\n        out.push({\n          text: text,\n          value: value\n        });\n      }\n    });\n    return out;\n  };\n\n  var sanitizeWith = function sanitizeWith(extracter) {\n    if (extracter === void 0) {\n      extracter = getValue;\n    }\n\n    return function (list) {\n      return Option.from(list).map(function (list) {\n        return sanitizeList(list, extracter);\n      });\n    };\n  };\n\n  var sanitize = function sanitize(list) {\n    return sanitizeWith(getValue)(list);\n  };\n\n  var createUi = function createUi(name, label) {\n    return function (items) {\n      return {\n        name: name,\n        type: 'selectbox',\n        label: label,\n        items: items\n      };\n    };\n  };\n\n  var ListOptions = {\n    sanitize: sanitize,\n    sanitizeWith: sanitizeWith,\n    createUi: createUi,\n    getValue: getValue\n  };\n\n  var Cell = function Cell(initial) {\n    var value = initial;\n\n    var get = function get() {\n      return value;\n    };\n\n    var set = function set(v) {\n      value = v;\n    };\n\n    var clone = function clone() {\n      return Cell(get());\n    };\n\n    return {\n      get: get,\n      set: set,\n      clone: clone\n    };\n  };\n\n  var findTextByValue = function findTextByValue(value, catalog) {\n    return findMap(catalog, function (item) {\n      return Option.some(item).filter(function (i) {\n        return i.value === value;\n      });\n    });\n  };\n\n  var getDelta = function getDelta(persistentText, fieldName, catalog, data) {\n    var value = data[fieldName];\n    var hasPersistentText = persistentText.length > 0;\n    return value !== undefined ? findTextByValue(value, catalog).map(function (i) {\n      return {\n        url: {\n          value: i.value,\n          meta: {\n            text: hasPersistentText ? persistentText : i.text,\n            attach: noop\n          }\n        },\n        text: hasPersistentText ? persistentText : i.text\n      };\n    }) : Option.none();\n  };\n\n  var findCatalog = function findCatalog(settings, fieldName) {\n    if (fieldName === 'link') {\n      return settings.catalogs.link;\n    } else if (fieldName === 'anchor') {\n      return settings.catalogs.anchor;\n    } else {\n      return Option.none();\n    }\n  };\n\n  var init = function init(initialData, linkSettings) {\n    var persistentText = Cell(initialData.text);\n\n    var onUrlChange = function onUrlChange(data) {\n      if (persistentText.get().length <= 0) {\n        var urlText = data.url.meta.text !== undefined ? data.url.meta.text : data.url.value;\n        return Option.some({\n          text: urlText\n        });\n      } else {\n        return Option.none();\n      }\n    };\n\n    var onCatalogChange = function onCatalogChange(data, change) {\n      var catalog = findCatalog(linkSettings, change.name).getOr([]);\n      return getDelta(persistentText.get(), change.name, catalog, data);\n    };\n\n    var onChange = function onChange(getData, change) {\n      if (change.name === 'url') {\n        return onUrlChange(getData());\n      } else if (contains(['anchor', 'link'], change.name)) {\n        return onCatalogChange(getData(), change);\n      } else if (change.name === 'text') {\n        persistentText.set(getData().text);\n        return Option.none();\n      } else {\n        return Option.none();\n      }\n    };\n\n    return {\n      onChange: onChange\n    };\n  };\n\n  var DialogChanges = {\n    init: init,\n    getDelta: getDelta\n  };\n\n  var _assign = function __assign() {\n    _assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) {\n          if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n      }\n\n      return t;\n    };\n\n    return _assign.apply(this, arguments);\n  };\n\n  var exports$1 = {},\n      module = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (f) {\n      if (typeof exports === 'object' && typeof module !== 'undefined') {\n        module.exports = f();\n      } else if (typeof define === 'function' && define.amd) {\n        define([], f);\n      } else {\n        var g;\n\n        if (typeof window !== 'undefined') {\n          g = window;\n        } else if (typeof global !== 'undefined') {\n          g = global;\n        } else if (typeof self !== 'undefined') {\n          g = self;\n        } else {\n          g = this;\n        }\n\n        g.EphoxContactWrapper = f();\n      }\n    })(function () {\n      return function () {\n        function r(e, n, t) {\n          function o(i, f) {\n            if (!n[i]) {\n              if (!e[i]) {\n                var c = 'function' == typeof require && require;\n                if (!f && c) return c(i, !0);\n                if (u) return u(i, !0);\n                var a = new Error('Cannot find module \\'' + i + '\\'');\n                throw a.code = 'MODULE_NOT_FOUND', a;\n              }\n\n              var p = n[i] = {\n                exports: {}\n              };\n              e[i][0].call(p.exports, function (r) {\n                var n = e[i][1][r];\n                return o(n || r);\n              }, p, p.exports, r, e, n, t);\n            }\n\n            return n[i].exports;\n          }\n\n          for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++) {\n            o(t[i]);\n          }\n\n          return o;\n        }\n\n        return r;\n      }()({\n        1: [function (require, module, exports) {\n          var process = module.exports = {};\n          var cachedSetTimeout;\n          var cachedClearTimeout;\n\n          function defaultSetTimout() {\n            throw new Error('setTimeout has not been defined');\n          }\n\n          function defaultClearTimeout() {\n            throw new Error('clearTimeout has not been defined');\n          }\n\n          (function () {\n            try {\n              if (typeof setTimeout === 'function') {\n                cachedSetTimeout = setTimeout;\n              } else {\n                cachedSetTimeout = defaultSetTimout;\n              }\n            } catch (e) {\n              cachedSetTimeout = defaultSetTimout;\n            }\n\n            try {\n              if (typeof clearTimeout === 'function') {\n                cachedClearTimeout = clearTimeout;\n              } else {\n                cachedClearTimeout = defaultClearTimeout;\n              }\n            } catch (e) {\n              cachedClearTimeout = defaultClearTimeout;\n            }\n          })();\n\n          function runTimeout(fun) {\n            if (cachedSetTimeout === setTimeout) {\n              return setTimeout(fun, 0);\n            }\n\n            if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n              cachedSetTimeout = setTimeout;\n              return setTimeout(fun, 0);\n            }\n\n            try {\n              return cachedSetTimeout(fun, 0);\n            } catch (e) {\n              try {\n                return cachedSetTimeout.call(null, fun, 0);\n              } catch (e) {\n                return cachedSetTimeout.call(this, fun, 0);\n              }\n            }\n          }\n\n          function runClearTimeout(marker) {\n            if (cachedClearTimeout === clearTimeout) {\n              return clearTimeout(marker);\n            }\n\n            if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n              cachedClearTimeout = clearTimeout;\n              return clearTimeout(marker);\n            }\n\n            try {\n              return cachedClearTimeout(marker);\n            } catch (e) {\n              try {\n                return cachedClearTimeout.call(null, marker);\n              } catch (e) {\n                return cachedClearTimeout.call(this, marker);\n              }\n            }\n          }\n\n          var queue = [];\n          var draining = false;\n          var currentQueue;\n          var queueIndex = -1;\n\n          function cleanUpNextTick() {\n            if (!draining || !currentQueue) {\n              return;\n            }\n\n            draining = false;\n\n            if (currentQueue.length) {\n              queue = currentQueue.concat(queue);\n            } else {\n              queueIndex = -1;\n            }\n\n            if (queue.length) {\n              drainQueue();\n            }\n          }\n\n          function drainQueue() {\n            if (draining) {\n              return;\n            }\n\n            var timeout = runTimeout(cleanUpNextTick);\n            draining = true;\n            var len = queue.length;\n\n            while (len) {\n              currentQueue = queue;\n              queue = [];\n\n              while (++queueIndex < len) {\n                if (currentQueue) {\n                  currentQueue[queueIndex].run();\n                }\n              }\n\n              queueIndex = -1;\n              len = queue.length;\n            }\n\n            currentQueue = null;\n            draining = false;\n            runClearTimeout(timeout);\n          }\n\n          process.nextTick = function (fun) {\n            var args = new Array(arguments.length - 1);\n\n            if (arguments.length > 1) {\n              for (var i = 1; i < arguments.length; i++) {\n                args[i - 1] = arguments[i];\n              }\n            }\n\n            queue.push(new Item(fun, args));\n\n            if (queue.length === 1 && !draining) {\n              runTimeout(drainQueue);\n            }\n          };\n\n          function Item(fun, array) {\n            this.fun = fun;\n            this.array = array;\n          }\n\n          Item.prototype.run = function () {\n            this.fun.apply(null, this.array);\n          };\n\n          process.title = 'browser';\n          process.browser = true;\n          process.env = {};\n          process.argv = [];\n          process.version = '';\n          process.versions = {};\n\n          function noop() {}\n\n          process.on = noop;\n          process.addListener = noop;\n          process.once = noop;\n          process.off = noop;\n          process.removeListener = noop;\n          process.removeAllListeners = noop;\n          process.emit = noop;\n          process.prependListener = noop;\n          process.prependOnceListener = noop;\n\n          process.listeners = function (name) {\n            return [];\n          };\n\n          process.binding = function (name) {\n            throw new Error('process.binding is not supported');\n          };\n\n          process.cwd = function () {\n            return '/';\n          };\n\n          process.chdir = function (dir) {\n            throw new Error('process.chdir is not supported');\n          };\n\n          process.umask = function () {\n            return 0;\n          };\n        }, {}],\n        2: [function (require, module, exports) {\n          (function (setImmediate) {\n            (function (root) {\n              var setTimeoutFunc = setTimeout;\n\n              function noop() {}\n\n              function bind(fn, thisArg) {\n                return function () {\n                  fn.apply(thisArg, arguments);\n                };\n              }\n\n              function Promise(fn) {\n                if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n                if (typeof fn !== 'function') throw new TypeError('not a function');\n                this._state = 0;\n                this._handled = false;\n                this._value = undefined;\n                this._deferreds = [];\n                doResolve(fn, this);\n              }\n\n              function handle(self, deferred) {\n                while (self._state === 3) {\n                  self = self._value;\n                }\n\n                if (self._state === 0) {\n                  self._deferreds.push(deferred);\n\n                  return;\n                }\n\n                self._handled = true;\n\n                Promise._immediateFn(function () {\n                  var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n                  if (cb === null) {\n                    (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                    return;\n                  }\n\n                  var ret;\n\n                  try {\n                    ret = cb(self._value);\n                  } catch (e) {\n                    reject(deferred.promise, e);\n                    return;\n                  }\n\n                  resolve(deferred.promise, ret);\n                });\n              }\n\n              function resolve(self, newValue) {\n                try {\n                  if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n                  if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                    var then = newValue.then;\n\n                    if (newValue instanceof Promise) {\n                      self._state = 3;\n                      self._value = newValue;\n                      finale(self);\n                      return;\n                    } else if (typeof then === 'function') {\n                      doResolve(bind(then, newValue), self);\n                      return;\n                    }\n                  }\n\n                  self._state = 1;\n                  self._value = newValue;\n                  finale(self);\n                } catch (e) {\n                  reject(self, e);\n                }\n              }\n\n              function reject(self, newValue) {\n                self._state = 2;\n                self._value = newValue;\n                finale(self);\n              }\n\n              function finale(self) {\n                if (self._state === 2 && self._deferreds.length === 0) {\n                  Promise._immediateFn(function () {\n                    if (!self._handled) {\n                      Promise._unhandledRejectionFn(self._value);\n                    }\n                  });\n                }\n\n                for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                  handle(self, self._deferreds[i]);\n                }\n\n                self._deferreds = null;\n              }\n\n              function Handler(onFulfilled, onRejected, promise) {\n                this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                this.promise = promise;\n              }\n\n              function doResolve(fn, self) {\n                var done = false;\n\n                try {\n                  fn(function (value) {\n                    if (done) return;\n                    done = true;\n                    resolve(self, value);\n                  }, function (reason) {\n                    if (done) return;\n                    done = true;\n                    reject(self, reason);\n                  });\n                } catch (ex) {\n                  if (done) return;\n                  done = true;\n                  reject(self, ex);\n                }\n              }\n\n              Promise.prototype['catch'] = function (onRejected) {\n                return this.then(null, onRejected);\n              };\n\n              Promise.prototype.then = function (onFulfilled, onRejected) {\n                var prom = new this.constructor(noop);\n                handle(this, new Handler(onFulfilled, onRejected, prom));\n                return prom;\n              };\n\n              Promise.all = function (arr) {\n                var args = Array.prototype.slice.call(arr);\n                return new Promise(function (resolve, reject) {\n                  if (args.length === 0) return resolve([]);\n                  var remaining = args.length;\n\n                  function res(i, val) {\n                    try {\n                      if (val && (typeof val === 'object' || typeof val === 'function')) {\n                        var then = val.then;\n\n                        if (typeof then === 'function') {\n                          then.call(val, function (val) {\n                            res(i, val);\n                          }, reject);\n                          return;\n                        }\n                      }\n\n                      args[i] = val;\n\n                      if (--remaining === 0) {\n                        resolve(args);\n                      }\n                    } catch (ex) {\n                      reject(ex);\n                    }\n                  }\n\n                  for (var i = 0; i < args.length; i++) {\n                    res(i, args[i]);\n                  }\n                });\n              };\n\n              Promise.resolve = function (value) {\n                if (value && typeof value === 'object' && value.constructor === Promise) {\n                  return value;\n                }\n\n                return new Promise(function (resolve) {\n                  resolve(value);\n                });\n              };\n\n              Promise.reject = function (value) {\n                return new Promise(function (resolve, reject) {\n                  reject(value);\n                });\n              };\n\n              Promise.race = function (values) {\n                return new Promise(function (resolve, reject) {\n                  for (var i = 0, len = values.length; i < len; i++) {\n                    values[i].then(resolve, reject);\n                  }\n                });\n              };\n\n              Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                setImmediate(fn);\n              } : function (fn) {\n                setTimeoutFunc(fn, 0);\n              };\n\n              Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                if (typeof console !== 'undefined' && console) {\n                  console.warn('Possible Unhandled Promise Rejection:', err);\n                }\n              };\n\n              Promise._setImmediateFn = function _setImmediateFn(fn) {\n                Promise._immediateFn = fn;\n              };\n\n              Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                Promise._unhandledRejectionFn = fn;\n              };\n\n              if (typeof module !== 'undefined' && module.exports) {\n                module.exports = Promise;\n              } else if (!root.Promise) {\n                root.Promise = Promise;\n              }\n            })(this);\n          }).call(this, require('timers').setImmediate);\n        }, {\n          'timers': 3\n        }],\n        3: [function (require, module, exports) {\n          (function (setImmediate, clearImmediate) {\n            var nextTick = require('process/browser.js').nextTick;\n\n            var apply = Function.prototype.apply;\n            var slice = Array.prototype.slice;\n            var immediateIds = {};\n            var nextImmediateId = 0;\n\n            exports.setTimeout = function () {\n              return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n            };\n\n            exports.setInterval = function () {\n              return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n            };\n\n            exports.clearTimeout = exports.clearInterval = function (timeout) {\n              timeout.close();\n            };\n\n            function Timeout(id, clearFn) {\n              this._id = id;\n              this._clearFn = clearFn;\n            }\n\n            Timeout.prototype.unref = Timeout.prototype.ref = function () {};\n\n            Timeout.prototype.close = function () {\n              this._clearFn.call(window, this._id);\n            };\n\n            exports.enroll = function (item, msecs) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = msecs;\n            };\n\n            exports.unenroll = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = -1;\n            };\n\n            exports._unrefActive = exports.active = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              var msecs = item._idleTimeout;\n\n              if (msecs >= 0) {\n                item._idleTimeoutId = setTimeout(function onTimeout() {\n                  if (item._onTimeout) item._onTimeout();\n                }, msecs);\n              }\n            };\n\n            exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n              var id = nextImmediateId++;\n              var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n              immediateIds[id] = true;\n              nextTick(function onNextTick() {\n                if (immediateIds[id]) {\n                  if (args) {\n                    fn.apply(null, args);\n                  } else {\n                    fn.call(null);\n                  }\n\n                  exports.clearImmediate(id);\n                }\n              });\n              return id;\n            };\n            exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n              delete immediateIds[id];\n            };\n          }).call(this, require('timers').setImmediate, require('timers').clearImmediate);\n        }, {\n          'process/browser.js': 1,\n          'timers': 3\n        }],\n        4: [function (require, module, exports) {\n          var promisePolyfill = require('promise-polyfill');\n\n          var Global = function () {\n            if (typeof window !== 'undefined') {\n              return window;\n            } else {\n              return Function('return this;')();\n            }\n          }();\n\n          module.exports = {\n            boltExport: Global.Promise || promisePolyfill\n          };\n        }, {\n          'promise-polyfill': 2\n        }]\n      }, {}, [4])(4);\n    });\n  })(undefined, exports$1, module, undefined);\n\n  var Promise = module.exports.boltExport;\n\n  var nu = function nu(baseFn) {\n    var data = Option.none();\n    var callbacks = [];\n\n    var map = function map(f) {\n      return nu(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function get(nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function set(x) {\n      data = Option.some(x);\n      run(callbacks);\n      callbacks = [];\n    };\n\n    var isReady = function isReady() {\n      return data.isSome();\n    };\n\n    var run = function run(cbs) {\n      each(cbs, call);\n    };\n\n    var call = function call(cb) {\n      data.each(function (x) {\n        domGlobals.setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure = function pure(a) {\n    return nu(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu,\n    pure: pure\n  };\n\n  var errorReporter = function errorReporter(err) {\n    domGlobals.setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make = function make(run) {\n    var get = function get(callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function map(fab) {\n      return make(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function bind(aFutureB) {\n      return make(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function anonBind(futureB) {\n      return make(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function toLazy() {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function toCached() {\n      var cache = null;\n      return make(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu$1 = function nu$1(baseFn) {\n    return make(function () {\n      return new Promise(baseFn);\n    });\n  };\n\n  var pure$1 = function pure$1(a) {\n    return make(function () {\n      return Promise.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu$1,\n    pure: pure$1\n  };\n  var global$6 = tinymce.util.Tools.resolve('tinymce.util.Delay');\n\n  var delayedConfirm = function delayedConfirm(editor, message, callback) {\n    var rng = editor.selection.getRng();\n    global$6.setEditorTimeout(editor, function () {\n      editor.windowManager.confirm(message, function (state) {\n        editor.selection.setRng(rng);\n        callback(state);\n      });\n    });\n  };\n\n  var tryEmailTransform = function tryEmailTransform(data) {\n    var url = data.href;\n    var suggestMailTo = url.indexOf('@') > 0 && url.indexOf('//') === -1 && url.indexOf('mailto:') === -1;\n    return suggestMailTo ? Option.some({\n      message: 'The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?',\n      preprocess: function preprocess(oldData) {\n        return _assign({}, oldData, {\n          href: 'mailto:' + url\n        });\n      }\n    }) : Option.none();\n  };\n\n  var tryProtocolTransform = function tryProtocolTransform(assumeExternalTargets) {\n    return function (data) {\n      var url = data.href;\n      var suggestProtocol = assumeExternalTargets === 1 && !Utils.hasProtocol(url) || assumeExternalTargets === 0 && /^\\s*www[\\.|\\d\\.]/i.test(url);\n      return suggestProtocol ? Option.some({\n        message: 'The URL you entered seems to be an external link. Do you want to add the required http:// prefix?',\n        preprocess: function preprocess(oldData) {\n          return _assign({}, oldData, {\n            href: 'http://' + url\n          });\n        }\n      }) : Option.none();\n    };\n  };\n\n  var preprocess = function preprocess(editor, assumeExternalTargets, data) {\n    return findMap([tryEmailTransform, tryProtocolTransform(assumeExternalTargets)], function (f) {\n      return f(data);\n    }).fold(function () {\n      return Future.pure(data);\n    }, function (transform) {\n      return Future.nu(function (callback) {\n        delayedConfirm(editor, transform.message, function (state) {\n          callback(state ? transform.preprocess(data) : data);\n        });\n      });\n    });\n  };\n\n  var DialogConfirms = {\n    preprocess: preprocess\n  };\n\n  var getAnchors = function getAnchors(editor) {\n    var anchorNodes = editor.dom.select('a:not([href])');\n    var anchors = bind(anchorNodes, function (anchor) {\n      var id = anchor.name || anchor.id;\n      return id ? [{\n        text: id,\n        value: '#' + id\n      }] : [];\n    });\n    return anchors.length > 0 ? Option.some([{\n      text: 'None',\n      value: ''\n    }].concat(anchors)) : Option.none();\n  };\n\n  var AnchorListOptions = {\n    getAnchors: getAnchors\n  };\n\n  var getClasses = function getClasses(editor) {\n    var list = Settings.getLinkClassList(editor);\n\n    if (list.length > 0) {\n      return ListOptions.sanitize(list);\n    }\n\n    return Option.none();\n  };\n\n  var ClassListOptions = {\n    getClasses: getClasses\n  };\n  var global$7 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n  var parseJson = function parseJson(text) {\n    try {\n      return Option.some(JSON.parse(text));\n    } catch (err) {\n      return Option.none();\n    }\n  };\n\n  var getLinks = function getLinks(editor) {\n    var extractor = function extractor(item) {\n      return editor.convertURL(item.value || item.url, 'href');\n    };\n\n    var linkList = Settings.getLinkList(editor);\n    return Future.nu(function (callback) {\n      if (isString(linkList)) {\n        global$7.send({\n          url: linkList,\n          success: function success(text) {\n            return callback(parseJson(text));\n          },\n          error: function error(_) {\n            return callback(Option.none());\n          }\n        });\n      } else if (isFunction(linkList)) {\n        linkList(function (output) {\n          return callback(Option.some(output));\n        });\n      } else {\n        callback(Option.from(linkList));\n      }\n    }).map(function (optItems) {\n      return optItems.bind(ListOptions.sanitizeWith(extractor)).map(function (items) {\n        if (items.length > 0) {\n          return [{\n            text: 'None',\n            value: ''\n          }].concat(items);\n        } else {\n          return items;\n        }\n      });\n    });\n  };\n\n  var LinkListOptions = {\n    getLinks: getLinks\n  };\n\n  var getRels = function getRels(editor, initialTarget) {\n    var list = Settings.getRelList(editor);\n\n    if (list.length > 0) {\n      var isTargetBlank_1 = initialTarget.is('_blank');\n      var enforceSafe = Settings.allowUnsafeLinkTarget(editor) === false;\n\n      var safeRelExtractor = function safeRelExtractor(item) {\n        return Utils.applyRelTargetRules(ListOptions.getValue(item), isTargetBlank_1);\n      };\n\n      var sanitizer = enforceSafe ? ListOptions.sanitizeWith(safeRelExtractor) : ListOptions.sanitize;\n      return sanitizer(list);\n    }\n\n    return Option.none();\n  };\n\n  var RelOptions = {\n    getRels: getRels\n  };\n  var fallbacks = [{\n    text: 'Current window',\n    value: ''\n  }, {\n    text: 'New window',\n    value: '_blank'\n  }];\n\n  var getTargets = function getTargets(editor) {\n    var list = Settings.getTargetList(editor);\n\n    if (isArray(list)) {\n      return ListOptions.sanitize(list).orThunk(function () {\n        return Option.some(fallbacks);\n      });\n    } else if (list === false) {\n      return Option.none();\n    }\n\n    return Option.some(fallbacks);\n  };\n\n  var TargetOptions = {\n    getTargets: getTargets\n  };\n\n  var nonEmptyAttr = function nonEmptyAttr(dom, elem, name) {\n    var val = dom.getAttrib(elem, name);\n    return val !== null && val.length > 0 ? Option.some(val) : Option.none();\n  };\n\n  var extractFromAnchor = function extractFromAnchor(editor, anchor) {\n    var dom = editor.dom;\n    var onlyText = Utils.isOnlyTextSelected(editor.selection.getContent());\n    var text = onlyText ? Option.some(Utils.getAnchorText(editor.selection, anchor)) : Option.none();\n    var url = anchor ? Option.some(dom.getAttrib(anchor, 'href')) : Option.none();\n    var target = anchor ? Option.from(dom.getAttrib(anchor, 'target')) : Option.none();\n    var rel = nonEmptyAttr(dom, anchor, 'rel');\n    var linkClass = nonEmptyAttr(dom, anchor, 'class');\n    var title = nonEmptyAttr(dom, anchor, 'title');\n    return {\n      url: url,\n      text: text,\n      title: title,\n      target: target,\n      rel: rel,\n      linkClass: linkClass\n    };\n  };\n\n  var collect = function collect(editor, linkNode) {\n    return LinkListOptions.getLinks(editor).map(function (links) {\n      var anchor = extractFromAnchor(editor, linkNode);\n      return {\n        anchor: anchor,\n        catalogs: {\n          targets: TargetOptions.getTargets(editor),\n          rels: RelOptions.getRels(editor, anchor.target),\n          classes: ClassListOptions.getClasses(editor),\n          anchor: AnchorListOptions.getAnchors(editor),\n          link: links\n        },\n        optNode: Option.from(linkNode),\n        flags: {\n          titleEnabled: Settings.shouldShowLinkTitle(editor)\n        }\n      };\n    });\n  };\n\n  var DialogInfo = {\n    collect: collect\n  };\n\n  var handleSubmit = function handleSubmit(editor, info, assumeExternalTargets) {\n    return function (api) {\n      var data = api.getData();\n\n      if (!data.url.value) {\n        Utils.unlink(editor);\n        api.close();\n        return;\n      }\n\n      var getChangedValue = function getChangedValue(key) {\n        return Option.from(data[key]).filter(function (value) {\n          return !info.anchor[key].is(value);\n        });\n      };\n\n      var changedData = {\n        href: data.url.value,\n        text: getChangedValue('text'),\n        target: getChangedValue('target'),\n        rel: getChangedValue('rel'),\n        \"class\": getChangedValue('linkClass'),\n        title: getChangedValue('title')\n      };\n      var attachState = {\n        href: data.url.value,\n        attach: data.url.meta !== undefined && data.url.meta.attach ? data.url.meta.attach : function () {}\n      };\n      DialogConfirms.preprocess(editor, assumeExternalTargets, changedData).get(function (pData) {\n        Utils.link(editor, attachState, pData);\n      });\n      api.close();\n    };\n  };\n\n  var collectData = function collectData(editor) {\n    var anchorNode = Utils.getAnchorElement(editor);\n    return DialogInfo.collect(editor, anchorNode);\n  };\n\n  var getInitialData = function getInitialData(info, defaultTarget) {\n    return {\n      url: {\n        value: info.anchor.url.getOr(''),\n        meta: {\n          attach: function attach() {},\n          text: info.anchor.url.fold(function () {\n            return '';\n          }, function () {\n            return info.anchor.text.getOr('');\n          }),\n          original: {\n            value: info.anchor.url.getOr('')\n          }\n        }\n      },\n      text: info.anchor.text.getOr(''),\n      title: info.anchor.title.getOr(''),\n      anchor: info.anchor.url.getOr(''),\n      link: info.anchor.url.getOr(''),\n      rel: info.anchor.rel.getOr(''),\n      target: info.anchor.target.or(defaultTarget).getOr(''),\n      linkClass: info.anchor.linkClass.getOr('')\n    };\n  };\n\n  var makeDialog = function makeDialog(settings, onSubmit, editor) {\n    var urlInput = [{\n      name: 'url',\n      type: 'urlinput',\n      filetype: 'file',\n      label: 'URL'\n    }];\n    var displayText = settings.anchor.text.map(function () {\n      return {\n        name: 'text',\n        type: 'input',\n        label: 'Text to display'\n      };\n    }).toArray();\n    var titleText = settings.flags.titleEnabled ? [{\n      name: 'title',\n      type: 'input',\n      label: 'Title'\n    }] : [];\n    var defaultTarget = Option.from(Settings.getDefaultLinkTarget(editor));\n    var initialData = getInitialData(settings, defaultTarget);\n    var dialogDelta = DialogChanges.init(initialData, settings);\n    var catalogs = settings.catalogs;\n    var body = {\n      type: 'panel',\n      items: flatten([urlInput, displayText, titleText, cat([catalogs.anchor.map(ListOptions.createUi('anchor', 'Anchors')), catalogs.rels.map(ListOptions.createUi('rel', 'Rel')), catalogs.targets.map(ListOptions.createUi('target', 'Open link in...')), catalogs.link.map(ListOptions.createUi('link', 'Link list')), catalogs.classes.map(ListOptions.createUi('linkClass', 'Class'))])])\n    };\n    return {\n      title: 'Insert/Edit Link',\n      size: 'normal',\n      body: body,\n      buttons: [{\n        type: 'cancel',\n        name: 'cancel',\n        text: 'Cancel'\n      }, {\n        type: 'submit',\n        name: 'save',\n        text: 'Save',\n        primary: true\n      }],\n      initialData: initialData,\n      onChange: function onChange(api, _a) {\n        var name = _a.name;\n        dialogDelta.onChange(api.getData, {\n          name: name\n        }).each(function (newData) {\n          api.setData(newData);\n        });\n      },\n      onSubmit: onSubmit\n    };\n  };\n\n  var open$1 = function open$1(editor) {\n    var data = collectData(editor);\n    data.map(function (info) {\n      var onSubmit = handleSubmit(editor, info, Settings.assumeExternalTargets(editor));\n      return makeDialog(info, onSubmit, editor);\n    }).get(function (spec) {\n      editor.windowManager.open(spec);\n    });\n  };\n\n  var Dialog = {\n    open: open$1\n  };\n\n  var getLink = function getLink(editor, elm) {\n    return editor.dom.getParent(elm, 'a[href]');\n  };\n\n  var getSelectedLink = function getSelectedLink(editor) {\n    return getLink(editor, editor.selection.getStart());\n  };\n\n  var hasOnlyAltModifier = function hasOnlyAltModifier(e) {\n    return e.altKey === true && e.shiftKey === false && e.ctrlKey === false && e.metaKey === false;\n  };\n\n  var gotoLink = function gotoLink(editor, a) {\n    if (a) {\n      var href = Utils.getHref(a);\n\n      if (/^#/.test(href)) {\n        var targetEl = editor.$(href);\n\n        if (targetEl.length) {\n          editor.selection.scrollIntoView(targetEl[0], true);\n        }\n      } else {\n        OpenUrl.open(a.href);\n      }\n    }\n  };\n\n  var openDialog = function openDialog(editor) {\n    return function () {\n      Dialog.open(editor);\n    };\n  };\n\n  var gotoSelectedLink = function gotoSelectedLink(editor) {\n    return function () {\n      gotoLink(editor, getSelectedLink(editor));\n    };\n  };\n\n  var leftClickedOnAHref = function leftClickedOnAHref(editor) {\n    return function (elm) {\n      var sel, rng, node;\n\n      if (Settings.hasContextToolbar(editor) && Utils.isLink(elm)) {\n        sel = editor.selection;\n        rng = sel.getRng();\n        node = rng.startContainer;\n\n        if (node.nodeType === 3 && sel.isCollapsed() && rng.startOffset > 0 && rng.startOffset < node.data.length) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var setupGotoLinks = function setupGotoLinks(editor) {\n    editor.on('click', function (e) {\n      var link = getLink(editor, e.target);\n\n      if (link && global$2.metaKeyPressed(e)) {\n        e.preventDefault();\n        gotoLink(editor, link);\n      }\n    });\n    editor.on('keydown', function (e) {\n      var link = getSelectedLink(editor);\n\n      if (link && e.keyCode === 13 && hasOnlyAltModifier(e)) {\n        e.preventDefault();\n        gotoLink(editor, link);\n      }\n    });\n  };\n\n  var toggleActiveState = function toggleActiveState(editor) {\n    return function (api) {\n      var nodeChangeHandler = function nodeChangeHandler(e) {\n        return api.setActive(!editor.readonly && !!Utils.getAnchorElement(editor, e.element));\n      };\n\n      editor.on('NodeChange', nodeChangeHandler);\n      return function () {\n        return editor.off('NodeChange', nodeChangeHandler);\n      };\n    };\n  };\n\n  var toggleEnabledState = function toggleEnabledState(editor) {\n    return function (api) {\n      api.setDisabled(!Utils.hasLinks(editor.dom.getParents(editor.selection.getStart())));\n\n      var nodeChangeHandler = function nodeChangeHandler(e) {\n        return api.setDisabled(!Utils.hasLinks(e.parents));\n      };\n\n      editor.on('NodeChange', nodeChangeHandler);\n      return function () {\n        return editor.off('NodeChange', nodeChangeHandler);\n      };\n    };\n  };\n\n  var Actions = {\n    openDialog: openDialog,\n    gotoSelectedLink: gotoSelectedLink,\n    leftClickedOnAHref: leftClickedOnAHref,\n    setupGotoLinks: setupGotoLinks,\n    toggleActiveState: toggleActiveState,\n    toggleEnabledState: toggleEnabledState\n  };\n\n  var register = function register(editor) {\n    editor.addCommand('mceLink', function () {\n      if (Settings.useQuickLink(editor)) {\n        editor.fire('contexttoolbar-show', {\n          toolbarKey: 'quicklink'\n        });\n      } else {\n        Actions.openDialog(editor)();\n      }\n    });\n  };\n\n  var Commands = {\n    register: register\n  };\n\n  var setup = function setup(editor) {\n    editor.addShortcut('Meta+K', '', function () {\n      editor.execCommand('mceLink');\n    });\n  };\n\n  var Keyboard = {\n    setup: setup\n  };\n\n  var setupButtons = function setupButtons(editor) {\n    editor.ui.registry.addToggleButton('link', {\n      icon: 'link',\n      tooltip: 'Insert/edit link',\n      onAction: Actions.openDialog(editor),\n      onSetup: Actions.toggleActiveState(editor)\n    });\n    editor.ui.registry.addButton('unlink', {\n      icon: 'unlink',\n      tooltip: 'Remove link',\n      onAction: function onAction() {\n        return Utils.unlink(editor);\n      },\n      onSetup: Actions.toggleEnabledState(editor)\n    });\n  };\n\n  var setupMenuItems = function setupMenuItems(editor) {\n    editor.ui.registry.addMenuItem('openlink', {\n      text: 'Open link',\n      icon: 'new-tab',\n      onAction: Actions.gotoSelectedLink(editor),\n      onSetup: Actions.toggleEnabledState(editor)\n    });\n    editor.ui.registry.addMenuItem('link', {\n      icon: 'link',\n      text: 'Link...',\n      shortcut: 'Meta+K',\n      onAction: Actions.openDialog(editor)\n    });\n    editor.ui.registry.addMenuItem('unlink', {\n      icon: 'unlink',\n      text: 'Remove link',\n      onAction: function onAction() {\n        return Utils.unlink(editor);\n      },\n      onSetup: Actions.toggleEnabledState(editor)\n    });\n  };\n\n  var setupContextMenu = function setupContextMenu(editor) {\n    var noLink = 'link';\n    var inLink = 'link unlink openlink';\n    editor.ui.registry.addContextMenu('link', {\n      update: function update(element) {\n        return Utils.hasLinks(editor.dom.getParents(element, 'a')) ? inLink : noLink;\n      }\n    });\n  };\n\n  var setupContextToolbars = function setupContextToolbars(editor) {\n    var collapseSelectionToEnd = function collapseSelectionToEnd(editor) {\n      editor.selection.collapse(false);\n    };\n\n    var onSetupLink = function onSetupLink(buttonApi) {\n      var node = editor.selection.getNode();\n      buttonApi.setDisabled(!Utils.getAnchorElement(editor, node));\n      return function () {};\n    };\n\n    editor.ui.registry.addContextForm('quicklink', {\n      launch: {\n        type: 'contextformtogglebutton',\n        icon: 'link',\n        tooltip: 'Link',\n        onSetup: Actions.toggleActiveState(editor)\n      },\n      label: 'Link',\n      predicate: function predicate(node) {\n        return !!Utils.getAnchorElement(editor, node) && Settings.hasContextToolbar(editor);\n      },\n      initValue: function initValue() {\n        var elm = Utils.getAnchorElement(editor);\n        return !!elm ? Utils.getHref(elm) : '';\n      },\n      commands: [{\n        type: 'contextformtogglebutton',\n        icon: 'link',\n        tooltip: 'Link',\n        primary: true,\n        onSetup: function onSetup(buttonApi) {\n          var node = editor.selection.getNode();\n          buttonApi.setActive(!!Utils.getAnchorElement(editor, node));\n          return Actions.toggleActiveState(editor)(buttonApi);\n        },\n        onAction: function onAction(formApi) {\n          var anchor = Utils.getAnchorElement(editor);\n          var value = formApi.getValue();\n\n          if (!anchor) {\n            var attachState = {\n              href: value,\n              attach: function attach() {}\n            };\n            var onlyText = Utils.isOnlyTextSelected(editor.selection.getContent());\n            var text = onlyText ? Option.some(Utils.getAnchorText(editor.selection, anchor)).filter(function (t) {\n              return t.length > 0;\n            }).or(Option.from(value)) : Option.none();\n            Utils.link(editor, attachState, {\n              href: value,\n              text: text,\n              title: Option.none(),\n              rel: Option.none(),\n              target: Option.none(),\n              \"class\": Option.none()\n            });\n            formApi.hide();\n          } else {\n            editor.dom.setAttrib(anchor, 'href', value);\n            collapseSelectionToEnd(editor);\n            formApi.hide();\n          }\n        }\n      }, {\n        type: 'contextformbutton',\n        icon: 'unlink',\n        tooltip: 'Remove link',\n        onSetup: onSetupLink,\n        onAction: function onAction(formApi) {\n          Utils.unlink(editor);\n          formApi.hide();\n        }\n      }, {\n        type: 'contextformbutton',\n        icon: 'new-tab',\n        tooltip: 'Open link',\n        onSetup: onSetupLink,\n        onAction: function onAction(formApi) {\n          Actions.gotoSelectedLink(editor)();\n          formApi.hide();\n        }\n      }]\n    });\n  };\n\n  var Controls = {\n    setupButtons: setupButtons,\n    setupMenuItems: setupMenuItems,\n    setupContextMenu: setupContextMenu,\n    setupContextToolbars: setupContextToolbars\n  };\n\n  function Plugin() {\n    global$1.add('link', function (editor) {\n      Controls.setupButtons(editor);\n      Controls.setupMenuItems(editor);\n      Controls.setupContextMenu(editor);\n      Controls.setupContextToolbars(editor);\n      Actions.setupGotoLinks(editor);\n      Commands.register(editor);\n      Keyboard.setup(editor);\n    });\n  }\n\n  Plugin();\n})(window);","require(\"core-js/modules/es6.array.filter\");\n\nrequire(\"core-js/modules/es6.regexp.split\");\n\nrequire(\"core-js/modules/es6.regexp.replace\");\n\nrequire(\"core-js/modules/es6.array.map\");\n\nrequire(\"core-js/modules/es6.function.bind\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nrequire(\"core-js/modules/es6.array.iterator\");\n\nrequire(\"core-js/modules/es6.object.to-string\");\n\nrequire(\"core-js/modules/es6.object.assign\");\n\nrequire(\"core-js/modules/es6.string.iterator\");\n\nrequire(\"core-js/modules/es6.array.from\");\n\nrequire(\"core-js/modules/es6.array.some\");\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/es6.object.freeze\");\n\n/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.0.15 (2019-09-02)\n */\n(function (domGlobals) {\n  'use strict';\n\n  var global$1 = tinymce.util.Tools.resolve('tinymce.PluginManager');\n\n  var noop = function noop() {};\n\n  var constant = function constant(value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function identity(x) {\n    return x;\n  };\n\n  var die = function die(msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n  var never$1 = never;\n  var always$1 = always;\n\n  var none = function none() {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var eq = function eq(o) {\n      return o.isNone();\n    };\n\n    var call = function call(thunk) {\n      return thunk();\n    };\n\n    var id = function id(n) {\n      return n;\n    };\n\n    var noop = function noop() {};\n\n    var nul = function nul() {\n      return null;\n    };\n\n    var undef = function undef() {\n      return undefined;\n    };\n\n    var me = {\n      fold: function fold(n, s) {\n        return n();\n      },\n      is: never$1,\n      isSome: never$1,\n      isNone: always$1,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function getOrDie(msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: nul,\n      getOrUndefined: undef,\n      or: id,\n      orThunk: call,\n      map: none,\n      ap: none,\n      each: noop,\n      bind: none,\n      flatten: none,\n      exists: never$1,\n      forall: always$1,\n      filter: none,\n      equals: eq,\n      equals_: eq,\n      toArray: function toArray() {\n        return [];\n      },\n      toString: constant('none()')\n    };\n\n    if (Object.freeze) {\n      Object.freeze(me);\n    }\n\n    return me;\n  }();\n\n  var some = function some(a) {\n    var constant_a = function constant_a() {\n      return a;\n    };\n\n    var self = function self() {\n      return me;\n    };\n\n    var map = function map(f) {\n      return some(f(a));\n    };\n\n    var bind = function bind(f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function fold(n, s) {\n        return s(a);\n      },\n      is: function is(v) {\n        return a === v;\n      },\n      isSome: always$1,\n      isNone: never$1,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: map,\n      ap: function ap(optfab) {\n        return optfab.fold(none, function (fab) {\n          return some(fab(a));\n        });\n      },\n      each: function each(f) {\n        f(a);\n      },\n      bind: bind,\n      flatten: constant_a,\n      exists: bind,\n      forall: bind,\n      filter: function filter(f) {\n        return f(a) ? me : NONE;\n      },\n      equals: function equals(o) {\n        return o.is(a);\n      },\n      equals_: function equals_(o, elementEq) {\n        return o.fold(never$1, function (b) {\n          return elementEq(a, b);\n        });\n      },\n      toArray: function toArray() {\n        return [a];\n      },\n      toString: function toString() {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from = function from(value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Option = {\n    some: some,\n    none: none,\n    from: from\n  };\n\n  var typeOf = function typeOf(x) {\n    if (x === null) {\n      return 'null';\n    }\n\n    var t = typeof x;\n\n    if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    }\n\n    if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    }\n\n    return t;\n  };\n\n  var isType = function isType(type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isString = isType('string');\n  var isObject = isType('object');\n  var isArray = isType('array');\n  var isBoolean = isType('boolean');\n  var isFunction = isType('function');\n  var slice = Array.prototype.slice;\n\n  var each = function each(xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i, xs);\n    }\n  };\n\n  var push = Array.prototype.push;\n\n  var flatten = function flatten(xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      push.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var head = function head(xs) {\n    return xs.length === 0 ? Option.none() : Option.some(xs[0]);\n  };\n\n  var from$1 = isFunction(Array.from) ? Array.from : function (x) {\n    return slice.call(x);\n  };\n\n  var _assign = function __assign() {\n    _assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) {\n          if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n        }\n      }\n\n      return t;\n    };\n\n    return _assign.apply(this, arguments);\n  };\n\n  var exports$1 = {},\n      module = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (f) {\n      if (typeof exports === 'object' && typeof module !== 'undefined') {\n        module.exports = f();\n      } else if (typeof define === 'function' && define.amd) {\n        define([], f);\n      } else {\n        var g;\n\n        if (typeof window !== 'undefined') {\n          g = window;\n        } else if (typeof global !== 'undefined') {\n          g = global;\n        } else if (typeof self !== 'undefined') {\n          g = self;\n        } else {\n          g = this;\n        }\n\n        g.EphoxContactWrapper = f();\n      }\n    })(function () {\n      return function () {\n        function r(e, n, t) {\n          function o(i, f) {\n            if (!n[i]) {\n              if (!e[i]) {\n                var c = 'function' == typeof require && require;\n                if (!f && c) return c(i, !0);\n                if (u) return u(i, !0);\n                var a = new Error('Cannot find module \\'' + i + '\\'');\n                throw a.code = 'MODULE_NOT_FOUND', a;\n              }\n\n              var p = n[i] = {\n                exports: {}\n              };\n              e[i][0].call(p.exports, function (r) {\n                var n = e[i][1][r];\n                return o(n || r);\n              }, p, p.exports, r, e, n, t);\n            }\n\n            return n[i].exports;\n          }\n\n          for (var u = 'function' == typeof require && require, i = 0; i < t.length; i++) {\n            o(t[i]);\n          }\n\n          return o;\n        }\n\n        return r;\n      }()({\n        1: [function (require, module, exports) {\n          var process = module.exports = {};\n          var cachedSetTimeout;\n          var cachedClearTimeout;\n\n          function defaultSetTimout() {\n            throw new Error('setTimeout has not been defined');\n          }\n\n          function defaultClearTimeout() {\n            throw new Error('clearTimeout has not been defined');\n          }\n\n          (function () {\n            try {\n              if (typeof setTimeout === 'function') {\n                cachedSetTimeout = setTimeout;\n              } else {\n                cachedSetTimeout = defaultSetTimout;\n              }\n            } catch (e) {\n              cachedSetTimeout = defaultSetTimout;\n            }\n\n            try {\n              if (typeof clearTimeout === 'function') {\n                cachedClearTimeout = clearTimeout;\n              } else {\n                cachedClearTimeout = defaultClearTimeout;\n              }\n            } catch (e) {\n              cachedClearTimeout = defaultClearTimeout;\n            }\n          })();\n\n          function runTimeout(fun) {\n            if (cachedSetTimeout === setTimeout) {\n              return setTimeout(fun, 0);\n            }\n\n            if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n              cachedSetTimeout = setTimeout;\n              return setTimeout(fun, 0);\n            }\n\n            try {\n              return cachedSetTimeout(fun, 0);\n            } catch (e) {\n              try {\n                return cachedSetTimeout.call(null, fun, 0);\n              } catch (e) {\n                return cachedSetTimeout.call(this, fun, 0);\n              }\n            }\n          }\n\n          function runClearTimeout(marker) {\n            if (cachedClearTimeout === clearTimeout) {\n              return clearTimeout(marker);\n            }\n\n            if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n              cachedClearTimeout = clearTimeout;\n              return clearTimeout(marker);\n            }\n\n            try {\n              return cachedClearTimeout(marker);\n            } catch (e) {\n              try {\n                return cachedClearTimeout.call(null, marker);\n              } catch (e) {\n                return cachedClearTimeout.call(this, marker);\n              }\n            }\n          }\n\n          var queue = [];\n          var draining = false;\n          var currentQueue;\n          var queueIndex = -1;\n\n          function cleanUpNextTick() {\n            if (!draining || !currentQueue) {\n              return;\n            }\n\n            draining = false;\n\n            if (currentQueue.length) {\n              queue = currentQueue.concat(queue);\n            } else {\n              queueIndex = -1;\n            }\n\n            if (queue.length) {\n              drainQueue();\n            }\n          }\n\n          function drainQueue() {\n            if (draining) {\n              return;\n            }\n\n            var timeout = runTimeout(cleanUpNextTick);\n            draining = true;\n            var len = queue.length;\n\n            while (len) {\n              currentQueue = queue;\n              queue = [];\n\n              while (++queueIndex < len) {\n                if (currentQueue) {\n                  currentQueue[queueIndex].run();\n                }\n              }\n\n              queueIndex = -1;\n              len = queue.length;\n            }\n\n            currentQueue = null;\n            draining = false;\n            runClearTimeout(timeout);\n          }\n\n          process.nextTick = function (fun) {\n            var args = new Array(arguments.length - 1);\n\n            if (arguments.length > 1) {\n              for (var i = 1; i < arguments.length; i++) {\n                args[i - 1] = arguments[i];\n              }\n            }\n\n            queue.push(new Item(fun, args));\n\n            if (queue.length === 1 && !draining) {\n              runTimeout(drainQueue);\n            }\n          };\n\n          function Item(fun, array) {\n            this.fun = fun;\n            this.array = array;\n          }\n\n          Item.prototype.run = function () {\n            this.fun.apply(null, this.array);\n          };\n\n          process.title = 'browser';\n          process.browser = true;\n          process.env = {};\n          process.argv = [];\n          process.version = '';\n          process.versions = {};\n\n          function noop() {}\n\n          process.on = noop;\n          process.addListener = noop;\n          process.once = noop;\n          process.off = noop;\n          process.removeListener = noop;\n          process.removeAllListeners = noop;\n          process.emit = noop;\n          process.prependListener = noop;\n          process.prependOnceListener = noop;\n\n          process.listeners = function (name) {\n            return [];\n          };\n\n          process.binding = function (name) {\n            throw new Error('process.binding is not supported');\n          };\n\n          process.cwd = function () {\n            return '/';\n          };\n\n          process.chdir = function (dir) {\n            throw new Error('process.chdir is not supported');\n          };\n\n          process.umask = function () {\n            return 0;\n          };\n        }, {}],\n        2: [function (require, module, exports) {\n          (function (setImmediate) {\n            (function (root) {\n              var setTimeoutFunc = setTimeout;\n\n              function noop() {}\n\n              function bind(fn, thisArg) {\n                return function () {\n                  fn.apply(thisArg, arguments);\n                };\n              }\n\n              function Promise(fn) {\n                if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n                if (typeof fn !== 'function') throw new TypeError('not a function');\n                this._state = 0;\n                this._handled = false;\n                this._value = undefined;\n                this._deferreds = [];\n                doResolve(fn, this);\n              }\n\n              function handle(self, deferred) {\n                while (self._state === 3) {\n                  self = self._value;\n                }\n\n                if (self._state === 0) {\n                  self._deferreds.push(deferred);\n\n                  return;\n                }\n\n                self._handled = true;\n\n                Promise._immediateFn(function () {\n                  var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n                  if (cb === null) {\n                    (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                    return;\n                  }\n\n                  var ret;\n\n                  try {\n                    ret = cb(self._value);\n                  } catch (e) {\n                    reject(deferred.promise, e);\n                    return;\n                  }\n\n                  resolve(deferred.promise, ret);\n                });\n              }\n\n              function resolve(self, newValue) {\n                try {\n                  if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n                  if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                    var then = newValue.then;\n\n                    if (newValue instanceof Promise) {\n                      self._state = 3;\n                      self._value = newValue;\n                      finale(self);\n                      return;\n                    } else if (typeof then === 'function') {\n                      doResolve(bind(then, newValue), self);\n                      return;\n                    }\n                  }\n\n                  self._state = 1;\n                  self._value = newValue;\n                  finale(self);\n                } catch (e) {\n                  reject(self, e);\n                }\n              }\n\n              function reject(self, newValue) {\n                self._state = 2;\n                self._value = newValue;\n                finale(self);\n              }\n\n              function finale(self) {\n                if (self._state === 2 && self._deferreds.length === 0) {\n                  Promise._immediateFn(function () {\n                    if (!self._handled) {\n                      Promise._unhandledRejectionFn(self._value);\n                    }\n                  });\n                }\n\n                for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                  handle(self, self._deferreds[i]);\n                }\n\n                self._deferreds = null;\n              }\n\n              function Handler(onFulfilled, onRejected, promise) {\n                this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n                this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n                this.promise = promise;\n              }\n\n              function doResolve(fn, self) {\n                var done = false;\n\n                try {\n                  fn(function (value) {\n                    if (done) return;\n                    done = true;\n                    resolve(self, value);\n                  }, function (reason) {\n                    if (done) return;\n                    done = true;\n                    reject(self, reason);\n                  });\n                } catch (ex) {\n                  if (done) return;\n                  done = true;\n                  reject(self, ex);\n                }\n              }\n\n              Promise.prototype['catch'] = function (onRejected) {\n                return this.then(null, onRejected);\n              };\n\n              Promise.prototype.then = function (onFulfilled, onRejected) {\n                var prom = new this.constructor(noop);\n                handle(this, new Handler(onFulfilled, onRejected, prom));\n                return prom;\n              };\n\n              Promise.all = function (arr) {\n                var args = Array.prototype.slice.call(arr);\n                return new Promise(function (resolve, reject) {\n                  if (args.length === 0) return resolve([]);\n                  var remaining = args.length;\n\n                  function res(i, val) {\n                    try {\n                      if (val && (typeof val === 'object' || typeof val === 'function')) {\n                        var then = val.then;\n\n                        if (typeof then === 'function') {\n                          then.call(val, function (val) {\n                            res(i, val);\n                          }, reject);\n                          return;\n                        }\n                      }\n\n                      args[i] = val;\n\n                      if (--remaining === 0) {\n                        resolve(args);\n                      }\n                    } catch (ex) {\n                      reject(ex);\n                    }\n                  }\n\n                  for (var i = 0; i < args.length; i++) {\n                    res(i, args[i]);\n                  }\n                });\n              };\n\n              Promise.resolve = function (value) {\n                if (value && typeof value === 'object' && value.constructor === Promise) {\n                  return value;\n                }\n\n                return new Promise(function (resolve) {\n                  resolve(value);\n                });\n              };\n\n              Promise.reject = function (value) {\n                return new Promise(function (resolve, reject) {\n                  reject(value);\n                });\n              };\n\n              Promise.race = function (values) {\n                return new Promise(function (resolve, reject) {\n                  for (var i = 0, len = values.length; i < len; i++) {\n                    values[i].then(resolve, reject);\n                  }\n                });\n              };\n\n              Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n                setImmediate(fn);\n              } : function (fn) {\n                setTimeoutFunc(fn, 0);\n              };\n\n              Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n                if (typeof console !== 'undefined' && console) {\n                  console.warn('Possible Unhandled Promise Rejection:', err);\n                }\n              };\n\n              Promise._setImmediateFn = function _setImmediateFn(fn) {\n                Promise._immediateFn = fn;\n              };\n\n              Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n                Promise._unhandledRejectionFn = fn;\n              };\n\n              if (typeof module !== 'undefined' && module.exports) {\n                module.exports = Promise;\n              } else if (!root.Promise) {\n                root.Promise = Promise;\n              }\n            })(this);\n          }).call(this, require('timers').setImmediate);\n        }, {\n          'timers': 3\n        }],\n        3: [function (require, module, exports) {\n          (function (setImmediate, clearImmediate) {\n            var nextTick = require('process/browser.js').nextTick;\n\n            var apply = Function.prototype.apply;\n            var slice = Array.prototype.slice;\n            var immediateIds = {};\n            var nextImmediateId = 0;\n\n            exports.setTimeout = function () {\n              return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);\n            };\n\n            exports.setInterval = function () {\n              return new Timeout(apply.call(setInterval, window, arguments), clearInterval);\n            };\n\n            exports.clearTimeout = exports.clearInterval = function (timeout) {\n              timeout.close();\n            };\n\n            function Timeout(id, clearFn) {\n              this._id = id;\n              this._clearFn = clearFn;\n            }\n\n            Timeout.prototype.unref = Timeout.prototype.ref = function () {};\n\n            Timeout.prototype.close = function () {\n              this._clearFn.call(window, this._id);\n            };\n\n            exports.enroll = function (item, msecs) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = msecs;\n            };\n\n            exports.unenroll = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              item._idleTimeout = -1;\n            };\n\n            exports._unrefActive = exports.active = function (item) {\n              clearTimeout(item._idleTimeoutId);\n              var msecs = item._idleTimeout;\n\n              if (msecs >= 0) {\n                item._idleTimeoutId = setTimeout(function onTimeout() {\n                  if (item._onTimeout) item._onTimeout();\n                }, msecs);\n              }\n            };\n\n            exports.setImmediate = typeof setImmediate === 'function' ? setImmediate : function (fn) {\n              var id = nextImmediateId++;\n              var args = arguments.length < 2 ? false : slice.call(arguments, 1);\n              immediateIds[id] = true;\n              nextTick(function onNextTick() {\n                if (immediateIds[id]) {\n                  if (args) {\n                    fn.apply(null, args);\n                  } else {\n                    fn.call(null);\n                  }\n\n                  exports.clearImmediate(id);\n                }\n              });\n              return id;\n            };\n            exports.clearImmediate = typeof clearImmediate === 'function' ? clearImmediate : function (id) {\n              delete immediateIds[id];\n            };\n          }).call(this, require('timers').setImmediate, require('timers').clearImmediate);\n        }, {\n          'process/browser.js': 1,\n          'timers': 3\n        }],\n        4: [function (require, module, exports) {\n          var promisePolyfill = require('promise-polyfill');\n\n          var Global = function () {\n            if (typeof window !== 'undefined') {\n              return window;\n            } else {\n              return Function('return this;')();\n            }\n          }();\n\n          module.exports = {\n            boltExport: Global.Promise || promisePolyfill\n          };\n        }, {\n          'promise-polyfill': 2\n        }]\n      }, {}, [4])(4);\n    });\n  })(undefined, exports$1, module, undefined);\n\n  var Promise = module.exports.boltExport;\n\n  var nu = function nu(baseFn) {\n    var data = Option.none();\n    var callbacks = [];\n\n    var map = function map(f) {\n      return nu(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function get(nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function set(x) {\n      data = Option.some(x);\n      run(callbacks);\n      callbacks = [];\n    };\n\n    var isReady = function isReady() {\n      return data.isSome();\n    };\n\n    var run = function run(cbs) {\n      each(cbs, call);\n    };\n\n    var call = function call(cb) {\n      data.each(function (x) {\n        domGlobals.setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure = function pure(a) {\n    return nu(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu,\n    pure: pure\n  };\n\n  var errorReporter = function errorReporter(err) {\n    domGlobals.setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make = function make(run) {\n    var get = function get(callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function map(fab) {\n      return make(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function bind(aFutureB) {\n      return make(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function anonBind(futureB) {\n      return make(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function toLazy() {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function toCached() {\n      var cache = null;\n      return make(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu$1 = function nu$1(baseFn) {\n    return make(function () {\n      return new Promise(baseFn);\n    });\n  };\n\n  var pure$1 = function pure$1(a) {\n    return make(function () {\n      return Promise.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu$1,\n    pure: pure$1\n  };\n\n  var value = function value(o) {\n    var is = function is(v) {\n      return o === v;\n    };\n\n    var or = function or(opt) {\n      return value(o);\n    };\n\n    var orThunk = function orThunk(f) {\n      return value(o);\n    };\n\n    var map = function map(f) {\n      return value(f(o));\n    };\n\n    var mapError = function mapError(f) {\n      return value(o);\n    };\n\n    var each = function each(f) {\n      f(o);\n    };\n\n    var bind = function bind(f) {\n      return f(o);\n    };\n\n    var fold = function fold(_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function exists(f) {\n      return f(o);\n    };\n\n    var forall = function forall(f) {\n      return f(o);\n    };\n\n    var toOption = function toOption() {\n      return Option.some(o);\n    };\n\n    return {\n      is: is,\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOption: toOption\n    };\n  };\n\n  var error = function error(message) {\n    var getOrThunk = function getOrThunk(f) {\n      return f();\n    };\n\n    var getOrDie = function getOrDie() {\n      return die(String(message))();\n    };\n\n    var or = function or(opt) {\n      return opt;\n    };\n\n    var orThunk = function orThunk(f) {\n      return f();\n    };\n\n    var map = function map(f) {\n      return error(message);\n    };\n\n    var mapError = function mapError(f) {\n      return error(f(message));\n    };\n\n    var bind = function bind(f) {\n      return error(message);\n    };\n\n    var fold = function fold(onError, _) {\n      return onError(message);\n    };\n\n    return {\n      is: never,\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOption: Option.none\n    };\n  };\n\n  var fromOption = function fromOption(opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value);\n  };\n\n  var Result = {\n    value: value,\n    error: error,\n    fromOption: fromOption\n  };\n\n  var wrap = function wrap(delegate) {\n    var toCached = function toCached() {\n      return wrap(delegate.toCached());\n    };\n\n    var bindFuture = function bindFuture(f) {\n      return wrap(delegate.bind(function (resA) {\n        return resA.fold(function (err) {\n          return Future.pure(Result.error(err));\n        }, function (a) {\n          return f(a);\n        });\n      }));\n    };\n\n    var bindResult = function bindResult(f) {\n      return wrap(delegate.map(function (resA) {\n        return resA.bind(f);\n      }));\n    };\n\n    var mapResult = function mapResult(f) {\n      return wrap(delegate.map(function (resA) {\n        return resA.map(f);\n      }));\n    };\n\n    var mapError = function mapError(f) {\n      return wrap(delegate.map(function (resA) {\n        return resA.mapError(f);\n      }));\n    };\n\n    var foldResult = function foldResult(whenError, whenValue) {\n      return delegate.map(function (res) {\n        return res.fold(whenError, whenValue);\n      });\n    };\n\n    var withTimeout = function withTimeout(timeout, errorThunk) {\n      return wrap(Future.nu(function (callback) {\n        var timedOut = false;\n        var timer = domGlobals.setTimeout(function () {\n          timedOut = true;\n          callback(Result.error(errorThunk()));\n        }, timeout);\n        delegate.get(function (result) {\n          if (!timedOut) {\n            domGlobals.clearTimeout(timer);\n            callback(result);\n          }\n        });\n      }));\n    };\n\n    return _assign({}, delegate, {\n      toCached: toCached,\n      bindFuture: bindFuture,\n      bindResult: bindResult,\n      mapResult: mapResult,\n      mapError: mapError,\n      foldResult: foldResult,\n      withTimeout: withTimeout\n    });\n  };\n\n  var nu$2 = function nu$2(worker) {\n    return wrap(Future.nu(worker));\n  };\n\n  var value$1 = function value$1(value) {\n    return wrap(Future.pure(Result.value(value)));\n  };\n\n  var error$1 = function error$1(error) {\n    return wrap(Future.pure(Result.error(error)));\n  };\n\n  var fromResult = function fromResult(result) {\n    return wrap(Future.pure(result));\n  };\n\n  var fromFuture = function fromFuture(future) {\n    return wrap(future.map(Result.value));\n  };\n\n  var fromPromise = function fromPromise(promise) {\n    return nu$2(function (completer) {\n      promise.then(function (value) {\n        completer(Result.value(value));\n      }, function (error) {\n        completer(Result.error(error));\n      });\n    });\n  };\n\n  var FutureResult = {\n    nu: nu$2,\n    wrap: wrap,\n    pure: value$1,\n    value: value$1,\n    error: error$1,\n    fromResult: fromResult,\n    fromFuture: fromFuture,\n    fromPromise: fromPromise\n  };\n  var hasOwnProperty = Object.prototype.hasOwnProperty;\n\n  var shallow = function shallow(old, nu) {\n    return nu;\n  };\n\n  var deep = function deep(old, nu) {\n    var bothObjects = isObject(old) && isObject(nu);\n    return bothObjects ? deepMerge(old, nu) : nu;\n  };\n\n  var baseMerge = function baseMerge(merger) {\n    return function () {\n      var objects = new Array(arguments.length);\n\n      for (var i = 0; i < objects.length; i++) {\n        objects[i] = arguments[i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (hasOwnProperty.call(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var deepMerge = baseMerge(deep);\n  var merge = baseMerge(shallow);\n\n  var makeItems = function makeItems(info) {\n    var imageUrl = {\n      name: 'src',\n      type: 'urlinput',\n      filetype: 'image',\n      label: 'Source'\n    };\n    var imageList = info.imageList.map(function (items) {\n      return {\n        name: 'images',\n        type: 'selectbox',\n        label: 'Image list',\n        items: items\n      };\n    });\n    var imageDescription = {\n      name: 'alt',\n      type: 'input',\n      label: 'Image description'\n    };\n    var imageTitle = {\n      name: 'title',\n      type: 'input',\n      label: 'Image title'\n    };\n    var imageDimensions = {\n      name: 'dimensions',\n      type: 'sizeinput'\n    };\n    var classList = info.classList.map(function (items) {\n      return {\n        name: 'classes',\n        type: 'selectbox',\n        label: 'Class',\n        items: items\n      };\n    });\n    var caption = {\n      type: 'label',\n      label: 'Caption',\n      items: [{\n        type: 'checkbox',\n        name: 'caption',\n        label: 'Show caption'\n      }]\n    };\n    return flatten([[imageUrl], imageList.toArray(), info.hasDescription ? [imageDescription] : [], info.hasImageTitle ? [imageTitle] : [], info.hasDimensions ? [imageDimensions] : [], [{\n      type: 'grid',\n      columns: 2,\n      items: flatten([classList.toArray(), info.hasImageCaption ? [caption] : []])\n    }]]);\n  };\n\n  var makeTab = function makeTab(info) {\n    return {\n      title: 'General',\n      name: 'general',\n      items: makeItems(info)\n    };\n  };\n\n  var MainTab = {\n    makeTab: makeTab,\n    makeItems: makeItems\n  };\n  var global$2 = tinymce.util.Tools.resolve('tinymce.dom.DOMUtils');\n  var global$3 = tinymce.util.Tools.resolve('tinymce.util.Promise');\n  var global$4 = tinymce.util.Tools.resolve('tinymce.util.XHR');\n\n  var hasDimensions = function hasDimensions(editor) {\n    return editor.getParam('image_dimensions', true, 'boolean');\n  };\n\n  var hasAdvTab = function hasAdvTab(editor) {\n    return editor.getParam('image_advtab', false, 'boolean');\n  };\n\n  var hasUploadTab = function hasUploadTab(editor) {\n    return editor.getParam('image_uploadtab', true, 'boolean');\n  };\n\n  var getPrependUrl = function getPrependUrl(editor) {\n    return editor.getParam('image_prepend_url', '', 'string');\n  };\n\n  var getClassList = function getClassList(editor) {\n    return editor.getParam('image_class_list');\n  };\n\n  var hasDescription = function hasDescription(editor) {\n    return editor.getParam('image_description', true, 'boolean');\n  };\n\n  var hasImageTitle = function hasImageTitle(editor) {\n    return editor.getParam('image_title', false, 'boolean');\n  };\n\n  var hasImageCaption = function hasImageCaption(editor) {\n    return editor.getParam('image_caption', false, 'boolean');\n  };\n\n  var getImageList = function getImageList(editor) {\n    return editor.getParam('image_list', false);\n  };\n\n  var hasUploadUrl = function hasUploadUrl(editor) {\n    return !!getUploadUrl(editor);\n  };\n\n  var hasUploadHandler = function hasUploadHandler(editor) {\n    return !!getUploadHandler(editor);\n  };\n\n  var getUploadUrl = function getUploadUrl(editor) {\n    return editor.getParam('images_upload_url', '', 'string');\n  };\n\n  var getUploadHandler = function getUploadHandler(editor) {\n    return editor.getParam('images_upload_handler', undefined, 'function');\n  };\n\n  var getUploadBasePath = function getUploadBasePath(editor) {\n    return editor.getParam('images_upload_base_path', undefined, 'string');\n  };\n\n  var getUploadCredentials = function getUploadCredentials(editor) {\n    return editor.getParam('images_upload_credentials', false, 'boolean');\n  };\n\n  var Settings = {\n    hasDimensions: hasDimensions,\n    hasUploadTab: hasUploadTab,\n    hasAdvTab: hasAdvTab,\n    getPrependUrl: getPrependUrl,\n    getClassList: getClassList,\n    hasDescription: hasDescription,\n    hasImageTitle: hasImageTitle,\n    hasImageCaption: hasImageCaption,\n    getImageList: getImageList,\n    hasUploadUrl: hasUploadUrl,\n    hasUploadHandler: hasUploadHandler,\n    getUploadUrl: getUploadUrl,\n    getUploadHandler: getUploadHandler,\n    getUploadBasePath: getUploadBasePath,\n    getUploadCredentials: getUploadCredentials\n  };\n\n  var parseIntAndGetMax = function parseIntAndGetMax(val1, val2) {\n    return Math.max(parseInt(val1, 10), parseInt(val2, 10));\n  };\n\n  var getImageSize = function getImageSize(url, callback) {\n    var img = domGlobals.document.createElement('img');\n\n    var done = function done(dimensions) {\n      if (img.parentNode) {\n        img.parentNode.removeChild(img);\n      }\n\n      callback(dimensions);\n    };\n\n    img.onload = function () {\n      var width = parseIntAndGetMax(img.width, img.clientWidth);\n      var height = parseIntAndGetMax(img.height, img.clientHeight);\n      var dimensions = {\n        width: width,\n        height: height\n      };\n      done(Result.value(dimensions));\n    };\n\n    img.onerror = function () {\n      done(Result.error('Failed to get image dimensions for: ' + url));\n    };\n\n    var style = img.style;\n    style.visibility = 'hidden';\n    style.position = 'fixed';\n    style.bottom = style.left = '0px';\n    style.width = style.height = 'auto';\n    domGlobals.document.body.appendChild(img);\n    img.src = url;\n  };\n\n  var removePixelSuffix = function removePixelSuffix(value) {\n    if (value) {\n      value = value.replace(/px$/, '');\n    }\n\n    return value;\n  };\n\n  var addPixelSuffix = function addPixelSuffix(value) {\n    if (value.length > 0 && /^[0-9]+$/.test(value)) {\n      value += 'px';\n    }\n\n    return value;\n  };\n\n  var mergeMargins = function mergeMargins(css) {\n    if (css.margin) {\n      var splitMargin = String(css.margin).split(' ');\n\n      switch (splitMargin.length) {\n        case 1:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[0];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[0];\n          break;\n\n        case 2:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[0];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n\n        case 3:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[1];\n          break;\n\n        case 4:\n          css['margin-top'] = css['margin-top'] || splitMargin[0];\n          css['margin-right'] = css['margin-right'] || splitMargin[1];\n          css['margin-bottom'] = css['margin-bottom'] || splitMargin[2];\n          css['margin-left'] = css['margin-left'] || splitMargin[3];\n      }\n\n      delete css.margin;\n    }\n\n    return css;\n  };\n\n  var createImageList = function createImageList(editor, callback) {\n    var imageList = Settings.getImageList(editor);\n\n    if (typeof imageList === 'string') {\n      global$4.send({\n        url: imageList,\n        success: function success(text) {\n          callback(JSON.parse(text));\n        }\n      });\n    } else if (typeof imageList === 'function') {\n      imageList(callback);\n    } else {\n      callback(imageList);\n    }\n  };\n\n  var waitLoadImage = function waitLoadImage(editor, data, imgElm) {\n    var selectImage = function selectImage() {\n      imgElm.onload = imgElm.onerror = null;\n\n      if (editor.selection) {\n        editor.selection.select(imgElm);\n        editor.nodeChanged();\n      }\n    };\n\n    imgElm.onload = function () {\n      if (!data.width && !data.height && Settings.hasDimensions(editor)) {\n        editor.dom.setAttribs(imgElm, {\n          width: String(imgElm.clientWidth),\n          height: String(imgElm.clientHeight)\n        });\n      }\n\n      selectImage();\n    };\n\n    imgElm.onerror = selectImage;\n  };\n\n  var blobToDataUri = function blobToDataUri(blob) {\n    return new global$3(function (resolve, reject) {\n      var reader = new domGlobals.FileReader();\n\n      reader.onload = function () {\n        resolve(reader.result);\n      };\n\n      reader.onerror = function () {\n        reject(reader.error.message);\n      };\n\n      reader.readAsDataURL(blob);\n    });\n  };\n\n  var isPlaceholderImage = function isPlaceholderImage(imgElm) {\n    return imgElm.nodeName === 'IMG' && (imgElm.hasAttribute('data-mce-object') || imgElm.hasAttribute('data-mce-placeholder'));\n  };\n\n  var Utils = {\n    getImageSize: getImageSize,\n    removePixelSuffix: removePixelSuffix,\n    addPixelSuffix: addPixelSuffix,\n    mergeMargins: mergeMargins,\n    createImageList: createImageList,\n    waitLoadImage: waitLoadImage,\n    blobToDataUri: blobToDataUri,\n    isPlaceholderImage: isPlaceholderImage\n  };\n  var DOM = global$2.DOM;\n\n  var getHspace = function getHspace(image) {\n    if (image.style.marginLeft && image.style.marginRight && image.style.marginLeft === image.style.marginRight) {\n      return Utils.removePixelSuffix(image.style.marginLeft);\n    } else {\n      return '';\n    }\n  };\n\n  var getVspace = function getVspace(image) {\n    if (image.style.marginTop && image.style.marginBottom && image.style.marginTop === image.style.marginBottom) {\n      return Utils.removePixelSuffix(image.style.marginTop);\n    } else {\n      return '';\n    }\n  };\n\n  var getBorder = function getBorder(image) {\n    if (image.style.borderWidth) {\n      return Utils.removePixelSuffix(image.style.borderWidth);\n    } else {\n      return '';\n    }\n  };\n\n  var getAttrib = function getAttrib(image, name) {\n    if (image.hasAttribute(name)) {\n      return image.getAttribute(name);\n    } else {\n      return '';\n    }\n  };\n\n  var getStyle = function getStyle(image, name) {\n    return image.style[name] ? image.style[name] : '';\n  };\n\n  var hasCaption = function hasCaption(image) {\n    return image.parentNode !== null && image.parentNode.nodeName === 'FIGURE';\n  };\n\n  var setAttrib = function setAttrib(image, name, value) {\n    image.setAttribute(name, value);\n  };\n\n  var wrapInFigure = function wrapInFigure(image) {\n    var figureElm = DOM.create('figure', {\n      \"class\": 'image'\n    });\n    DOM.insertAfter(figureElm, image);\n    figureElm.appendChild(image);\n    figureElm.appendChild(DOM.create('figcaption', {\n      contentEditable: 'true'\n    }, 'Caption'));\n    figureElm.contentEditable = 'false';\n  };\n\n  var removeFigure = function removeFigure(image) {\n    var figureElm = image.parentNode;\n    DOM.insertAfter(image, figureElm);\n    DOM.remove(figureElm);\n  };\n\n  var toggleCaption = function toggleCaption(image) {\n    if (hasCaption(image)) {\n      removeFigure(image);\n    } else {\n      wrapInFigure(image);\n    }\n  };\n\n  var normalizeStyle = function normalizeStyle(image, normalizeCss) {\n    var attrValue = image.getAttribute('style');\n    var value = normalizeCss(attrValue !== null ? attrValue : '');\n\n    if (value.length > 0) {\n      image.setAttribute('style', value);\n      image.setAttribute('data-mce-style', value);\n    } else {\n      image.removeAttribute('style');\n    }\n  };\n\n  var setSize = function setSize(name, normalizeCss) {\n    return function (image, name, value) {\n      if (image.style[name]) {\n        image.style[name] = Utils.addPixelSuffix(value);\n        normalizeStyle(image, normalizeCss);\n      } else {\n        setAttrib(image, name, value);\n      }\n    };\n  };\n\n  var getSize = function getSize(image, name) {\n    if (image.style[name]) {\n      return Utils.removePixelSuffix(image.style[name]);\n    } else {\n      return getAttrib(image, name);\n    }\n  };\n\n  var setHspace = function setHspace(image, value) {\n    var pxValue = Utils.addPixelSuffix(value);\n    image.style.marginLeft = pxValue;\n    image.style.marginRight = pxValue;\n  };\n\n  var setVspace = function setVspace(image, value) {\n    var pxValue = Utils.addPixelSuffix(value);\n    image.style.marginTop = pxValue;\n    image.style.marginBottom = pxValue;\n  };\n\n  var setBorder = function setBorder(image, value) {\n    var pxValue = Utils.addPixelSuffix(value);\n    image.style.borderWidth = pxValue;\n  };\n\n  var setBorderStyle = function setBorderStyle(image, value) {\n    image.style.borderStyle = value;\n  };\n\n  var getBorderStyle = function getBorderStyle(image) {\n    return getStyle(image, 'borderStyle');\n  };\n\n  var isFigure = function isFigure(elm) {\n    return elm.nodeName === 'FIGURE';\n  };\n\n  var isImage = function isImage(elm) {\n    return elm.nodeName === 'IMG';\n  };\n\n  var defaultData = function defaultData() {\n    return {\n      src: '',\n      alt: '',\n      title: '',\n      width: '',\n      height: '',\n      \"class\": '',\n      style: '',\n      caption: false,\n      hspace: '',\n      vspace: '',\n      border: '',\n      borderStyle: ''\n    };\n  };\n\n  var getStyleValue = function getStyleValue(normalizeCss, data) {\n    var image = domGlobals.document.createElement('img');\n    setAttrib(image, 'style', data.style);\n\n    if (getHspace(image) || data.hspace !== '') {\n      setHspace(image, data.hspace);\n    }\n\n    if (getVspace(image) || data.vspace !== '') {\n      setVspace(image, data.vspace);\n    }\n\n    if (getBorder(image) || data.border !== '') {\n      setBorder(image, data.border);\n    }\n\n    if (getBorderStyle(image) || data.borderStyle !== '') {\n      setBorderStyle(image, data.borderStyle);\n    }\n\n    return normalizeCss(image.getAttribute('style'));\n  };\n\n  var create = function create(normalizeCss, data) {\n    var image = domGlobals.document.createElement('img');\n    write(normalizeCss, merge(data, {\n      caption: false\n    }), image);\n    setAttrib(image, 'alt', data.alt);\n\n    if (data.caption) {\n      var figure = DOM.create('figure', {\n        \"class\": 'image'\n      });\n      figure.appendChild(image);\n      figure.appendChild(DOM.create('figcaption', {\n        contentEditable: 'true'\n      }, 'Caption'));\n      figure.contentEditable = 'false';\n      return figure;\n    } else {\n      return image;\n    }\n  };\n\n  var read = function read(normalizeCss, image) {\n    return {\n      src: getAttrib(image, 'src'),\n      alt: getAttrib(image, 'alt'),\n      title: getAttrib(image, 'title'),\n      width: getSize(image, 'width'),\n      height: getSize(image, 'height'),\n      \"class\": getAttrib(image, 'class'),\n      style: normalizeCss(getAttrib(image, 'style')),\n      caption: hasCaption(image),\n      hspace: getHspace(image),\n      vspace: getVspace(image),\n      border: getBorder(image),\n      borderStyle: getStyle(image, 'borderStyle')\n    };\n  };\n\n  var updateProp = function updateProp(image, oldData, newData, name, set) {\n    if (newData[name] !== oldData[name]) {\n      set(image, name, newData[name]);\n    }\n  };\n\n  var normalized = function normalized(set, normalizeCss) {\n    return function (image, name, value) {\n      set(image, value);\n      normalizeStyle(image, normalizeCss);\n    };\n  };\n\n  var write = function write(normalizeCss, newData, image) {\n    var oldData = read(normalizeCss, image);\n    updateProp(image, oldData, newData, 'caption', function (image, _name, _value) {\n      return toggleCaption(image);\n    });\n    updateProp(image, oldData, newData, 'src', setAttrib);\n    updateProp(image, oldData, newData, 'alt', setAttrib);\n    updateProp(image, oldData, newData, 'title', setAttrib);\n    updateProp(image, oldData, newData, 'width', setSize('width', normalizeCss));\n    updateProp(image, oldData, newData, 'height', setSize('height', normalizeCss));\n    updateProp(image, oldData, newData, 'class', setAttrib);\n    updateProp(image, oldData, newData, 'style', normalized(function (image, value) {\n      return setAttrib(image, 'style', value);\n    }, normalizeCss));\n    updateProp(image, oldData, newData, 'hspace', normalized(setHspace, normalizeCss));\n    updateProp(image, oldData, newData, 'vspace', normalized(setVspace, normalizeCss));\n    updateProp(image, oldData, newData, 'border', normalized(setBorder, normalizeCss));\n    updateProp(image, oldData, newData, 'borderStyle', normalized(setBorderStyle, normalizeCss));\n  };\n\n  var normalizeCss = function normalizeCss(editor, cssText) {\n    var css = editor.dom.styles.parse(cssText);\n    var mergedCss = Utils.mergeMargins(css);\n    var compressed = editor.dom.styles.parse(editor.dom.styles.serialize(mergedCss));\n    return editor.dom.styles.serialize(compressed);\n  };\n\n  var getSelectedImage = function getSelectedImage(editor) {\n    var imgElm = editor.selection.getNode();\n    var figureElm = editor.dom.getParent(imgElm, 'figure.image');\n\n    if (figureElm) {\n      return editor.dom.select('img', figureElm)[0];\n    }\n\n    if (imgElm && (imgElm.nodeName !== 'IMG' || Utils.isPlaceholderImage(imgElm))) {\n      return null;\n    }\n\n    return imgElm;\n  };\n\n  var splitTextBlock = function splitTextBlock(editor, figure) {\n    var dom = editor.dom;\n    var textBlock = dom.getParent(figure.parentNode, function (node) {\n      return editor.schema.getTextBlockElements()[node.nodeName];\n    }, editor.getBody());\n\n    if (textBlock) {\n      return dom.split(textBlock, figure);\n    } else {\n      return figure;\n    }\n  };\n\n  var readImageDataFromSelection = function readImageDataFromSelection(editor) {\n    var image = getSelectedImage(editor);\n    return image ? read(function (css) {\n      return normalizeCss(editor, css);\n    }, image) : defaultData();\n  };\n\n  var insertImageAtCaret = function insertImageAtCaret(editor, data) {\n    var elm = create(function (css) {\n      return normalizeCss(editor, css);\n    }, data);\n    editor.dom.setAttrib(elm, 'data-mce-id', '__mcenew');\n    editor.focus();\n    editor.selection.setContent(elm.outerHTML);\n    var insertedElm = editor.dom.select('*[data-mce-id=\"__mcenew\"]')[0];\n    editor.dom.setAttrib(insertedElm, 'data-mce-id', null);\n\n    if (isFigure(insertedElm)) {\n      var figure = splitTextBlock(editor, insertedElm);\n      editor.selection.select(figure);\n    } else {\n      editor.selection.select(insertedElm);\n    }\n  };\n\n  var syncSrcAttr = function syncSrcAttr(editor, image) {\n    editor.dom.setAttrib(image, 'src', image.getAttribute('src'));\n  };\n\n  var deleteImage = function deleteImage(editor, image) {\n    if (image) {\n      var elm = editor.dom.is(image.parentNode, 'figure.image') ? image.parentNode : image;\n      editor.dom.remove(elm);\n      editor.focus();\n      editor.nodeChanged();\n\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        editor.selection.setCursorLocation();\n      }\n    }\n  };\n\n  var writeImageDataToSelection = function writeImageDataToSelection(editor, data) {\n    var image = getSelectedImage(editor);\n    write(function (css) {\n      return normalizeCss(editor, css);\n    }, data, image);\n    syncSrcAttr(editor, image);\n\n    if (isFigure(image.parentNode)) {\n      var figure = image.parentNode;\n      splitTextBlock(editor, figure);\n      editor.selection.select(image.parentNode);\n    } else {\n      editor.selection.select(image);\n      Utils.waitLoadImage(editor, data, image);\n    }\n  };\n\n  var insertOrUpdateImage = function insertOrUpdateImage(editor, data) {\n    var image = getSelectedImage(editor);\n\n    if (image) {\n      if (data.src) {\n        writeImageDataToSelection(editor, data);\n      } else {\n        deleteImage(editor, image);\n      }\n    } else if (data.src) {\n      insertImageAtCaret(editor, data);\n    }\n  };\n\n  var findMap = function findMap(arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Option.none();\n  };\n\n  var global$5 = tinymce.util.Tools.resolve('tinymce.util.Tools');\n\n  var getValue = function getValue(item) {\n    return isString(item.value) ? item.value : '';\n  };\n\n  var sanitizeList = function sanitizeList(list, extractValue) {\n    var out = [];\n    global$5.each(list, function (item) {\n      var text = isString(item.text) ? item.text : isString(item.title) ? item.title : '';\n\n      if (item.menu !== undefined) {\n        var items = sanitizeList(item.menu, extractValue);\n        out.push({\n          text: text,\n          items: items\n        });\n      } else {\n        var value = extractValue(item);\n        out.push({\n          text: text,\n          value: value\n        });\n      }\n    });\n    return out;\n  };\n\n  var sanitizer = function sanitizer(extracter) {\n    if (extracter === void 0) {\n      extracter = getValue;\n    }\n\n    return function (list) {\n      if (list) {\n        return Option.from(list).map(function (list) {\n          return sanitizeList(list, extracter);\n        });\n      } else {\n        return Option.none();\n      }\n    };\n  };\n\n  var sanitize = function sanitize(list) {\n    return sanitizer(getValue)(list);\n  };\n\n  var isGroup = function isGroup(item) {\n    return Object.prototype.hasOwnProperty.call(item, 'items');\n  };\n\n  var findEntryDelegate = function findEntryDelegate(list, value) {\n    return findMap(list, function (item) {\n      if (isGroup(item)) {\n        return findEntryDelegate(item.items, value);\n      } else if (item.value === value) {\n        return Option.some(item);\n      } else {\n        return Option.none();\n      }\n    });\n  };\n\n  var findEntry = function findEntry(optList, value) {\n    return optList.bind(function (list) {\n      return findEntryDelegate(list, value);\n    });\n  };\n\n  var ListUtils = {\n    sanitizer: sanitizer,\n    sanitize: sanitize,\n    findEntry: findEntry\n  };\n\n  var pathJoin = function pathJoin(path1, path2) {\n    if (path1) {\n      return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n    }\n\n    return path2;\n  };\n\n  function Uploader(settings) {\n    var defaultHandler = function defaultHandler(blobInfo, success, failure, progress) {\n      var xhr, formData;\n      xhr = new domGlobals.XMLHttpRequest();\n      xhr.open('POST', settings.url);\n      xhr.withCredentials = settings.credentials;\n\n      xhr.upload.onprogress = function (e) {\n        progress(e.loaded / e.total * 100);\n      };\n\n      xhr.onerror = function () {\n        failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n      };\n\n      xhr.onload = function () {\n        var json;\n\n        if (xhr.status < 200 || xhr.status >= 300) {\n          failure('HTTP Error: ' + xhr.status);\n          return;\n        }\n\n        json = JSON.parse(xhr.responseText);\n\n        if (!json || typeof json.location !== 'string') {\n          failure('Invalid JSON: ' + xhr.responseText);\n          return;\n        }\n\n        success(pathJoin(settings.basePath, json.location));\n      };\n\n      formData = new domGlobals.FormData();\n      formData.append('file', blobInfo.blob(), blobInfo.filename());\n      xhr.send(formData);\n    };\n\n    var uploadBlob = function uploadBlob(blobInfo, handler) {\n      return new global$3(function (resolve, reject) {\n        try {\n          handler(blobInfo, resolve, reject, noop);\n        } catch (ex) {\n          reject(ex.message);\n        }\n      });\n    };\n\n    var isDefaultHandler = function isDefaultHandler(handler) {\n      return handler === defaultHandler;\n    };\n\n    var upload = function upload(blobInfo) {\n      return !settings.url && isDefaultHandler(settings.handler) ? global$3.reject('Upload url missing from the settings.') : uploadBlob(blobInfo, settings.handler);\n    };\n\n    settings = global$5.extend({\n      credentials: false,\n      handler: defaultHandler\n    }, settings);\n    return {\n      upload: upload\n    };\n  }\n\n  var makeTab$1 = function makeTab$1(info) {\n    return {\n      title: 'Advanced',\n      name: 'advanced',\n      items: [{\n        type: 'input',\n        label: 'Style',\n        name: 'style'\n      }, {\n        type: 'grid',\n        columns: 2,\n        items: [{\n          type: 'input',\n          label: 'Vertical space',\n          name: 'vspace'\n        }, {\n          type: 'input',\n          label: 'Horizontal space',\n          name: 'hspace'\n        }, {\n          type: 'input',\n          label: 'Border width',\n          name: 'border'\n        }, {\n          type: 'selectbox',\n          name: 'borderstyle',\n          label: 'Border style',\n          items: [{\n            text: 'Select...',\n            value: ''\n          }, {\n            text: 'Solid',\n            value: 'solid'\n          }, {\n            text: 'Dotted',\n            value: 'dotted'\n          }, {\n            text: 'Dashed',\n            value: 'dashed'\n          }, {\n            text: 'Double',\n            value: 'double'\n          }, {\n            text: 'Groove',\n            value: 'groove'\n          }, {\n            text: 'Ridge',\n            value: 'ridge'\n          }, {\n            text: 'Inset',\n            value: 'inset'\n          }, {\n            text: 'Outset',\n            value: 'outset'\n          }, {\n            text: 'None',\n            value: 'none'\n          }, {\n            text: 'Hidden',\n            value: 'hidden'\n          }]\n        }]\n      }]\n    };\n  };\n\n  var AdvTab = {\n    makeTab: makeTab$1\n  };\n\n  var collect = function collect(editor) {\n    var urlListSanitizer = ListUtils.sanitizer(function (item) {\n      return editor.convertURL(item.value || item.url, 'src');\n    });\n    var futureImageList = Future.nu(function (completer) {\n      Utils.createImageList(editor, function (imageList) {\n        completer(urlListSanitizer(imageList).map(function (items) {\n          return flatten([[{\n            text: 'None',\n            value: ''\n          }], items]);\n        }));\n      });\n    });\n    var classList = ListUtils.sanitize(Settings.getClassList(editor));\n    var hasAdvTab = Settings.hasAdvTab(editor);\n    var hasUploadTab = Settings.hasUploadTab(editor);\n    var hasUploadUrl = Settings.hasUploadUrl(editor);\n    var hasUploadHandler = Settings.hasUploadHandler(editor);\n    var image = readImageDataFromSelection(editor);\n    var hasDescription = Settings.hasDescription(editor);\n    var hasImageTitle = Settings.hasImageTitle(editor);\n    var hasDimensions = Settings.hasDimensions(editor);\n    var hasImageCaption = Settings.hasImageCaption(editor);\n    var url = Settings.getUploadUrl(editor);\n    var basePath = Settings.getUploadBasePath(editor);\n    var credentials = Settings.getUploadCredentials(editor);\n    var handler = Settings.getUploadHandler(editor);\n    var prependURL = Option.some(Settings.getPrependUrl(editor)).filter(function (preUrl) {\n      return isString(preUrl) && preUrl.length > 0;\n    });\n    return futureImageList.map(function (imageList) {\n      return {\n        image: image,\n        imageList: imageList,\n        classList: classList,\n        hasAdvTab: hasAdvTab,\n        hasUploadTab: hasUploadTab,\n        hasUploadUrl: hasUploadUrl,\n        hasUploadHandler: hasUploadHandler,\n        hasDescription: hasDescription,\n        hasImageTitle: hasImageTitle,\n        hasDimensions: hasDimensions,\n        hasImageCaption: hasImageCaption,\n        url: url,\n        basePath: basePath,\n        credentials: credentials,\n        handler: handler,\n        prependURL: prependURL\n      };\n    });\n  };\n\n  var makeTab$2 = function makeTab$2(info) {\n    var items = [{\n      type: 'dropzone',\n      name: 'fileinput'\n    }];\n    return {\n      title: 'Upload',\n      name: 'upload',\n      items: items\n    };\n  };\n\n  var UploadTab = {\n    makeTab: makeTab$2\n  };\n\n  var createState = function createState(info) {\n    return {\n      prevImage: ListUtils.findEntry(info.imageList, info.image.src),\n      prevAlt: info.image.alt,\n      open: true\n    };\n  };\n\n  var fromImageData = function fromImageData(image) {\n    return {\n      src: {\n        value: image.src,\n        meta: {}\n      },\n      images: image.src,\n      alt: image.alt,\n      title: image.title,\n      dimensions: {\n        width: image.width,\n        height: image.height\n      },\n      classes: image[\"class\"],\n      caption: image.caption,\n      style: image.style,\n      vspace: image.vspace,\n      border: image.border,\n      hspace: image.hspace,\n      borderstyle: image.borderStyle,\n      fileinput: []\n    };\n  };\n\n  var toImageData = function toImageData(data) {\n    return {\n      src: data.src.value,\n      alt: data.alt,\n      title: data.title,\n      width: data.dimensions.width,\n      height: data.dimensions.height,\n      \"class\": data.classes,\n      style: data.style,\n      caption: data.caption,\n      hspace: data.hspace,\n      vspace: data.vspace,\n      border: data.border,\n      borderStyle: data.borderstyle\n    };\n  };\n\n  var addPrependUrl2 = function addPrependUrl2(info, srcURL) {\n    if (!/^(?:[a-zA-Z]+:)?\\/\\//.test(srcURL)) {\n      return info.prependURL.bind(function (prependUrl) {\n        if (srcURL.substring(0, prependUrl.length) !== prependUrl) {\n          return Option.some(prependUrl + srcURL);\n        }\n\n        return Option.none();\n      });\n    }\n\n    return Option.none();\n  };\n\n  var addPrependUrl = function addPrependUrl(info, api) {\n    var data = api.getData();\n    addPrependUrl2(info, data.src.value).each(function (srcURL) {\n      api.setData({\n        src: {\n          value: srcURL,\n          meta: data.src.meta\n        }\n      });\n    });\n  };\n\n  var formFillFromMeta2 = function formFillFromMeta2(info, data, meta) {\n    if (info.hasDescription && isString(meta.alt)) {\n      data.alt = meta.alt;\n    }\n\n    if (info.hasImageTitle && isString(meta.title)) {\n      data.title = meta.title;\n    }\n\n    if (info.hasDimensions) {\n      if (isString(meta.width)) {\n        data.dimensions.width = meta.width;\n      }\n\n      if (isString(meta.height)) {\n        data.dimensions.height = meta.height;\n      }\n    }\n\n    if (isString(meta[\"class\"])) {\n      ListUtils.findEntry(info.classList, meta[\"class\"]).each(function (entry) {\n        data.classes = entry.value;\n      });\n    }\n\n    if (info.hasImageCaption) {\n      if (isBoolean(meta.caption)) {\n        data.caption = meta.caption;\n      }\n    }\n\n    if (info.hasAdvTab) {\n      if (isString(meta.vspace)) {\n        data.vspace = meta.vspace;\n      }\n\n      if (isString(meta.border)) {\n        data.border = meta.border;\n      }\n\n      if (isString(meta.hspace)) {\n        data.hspace = meta.hspace;\n      }\n\n      if (isString(meta.borderstyle)) {\n        data.borderstyle = meta.borderstyle;\n      }\n    }\n  };\n\n  var formFillFromMeta = function formFillFromMeta(info, api) {\n    var data = api.getData();\n    var meta = data.src.meta;\n\n    if (meta !== undefined) {\n      var newData = deepMerge({}, data);\n      formFillFromMeta2(info, newData, meta);\n      api.setData(newData);\n    }\n  };\n\n  var calculateImageSize = function calculateImageSize(helpers, info, state, api) {\n    var data = api.getData();\n    var url = data.src.value;\n    var meta = data.src.meta || {};\n\n    if (!meta.width && !meta.height && info.hasDimensions) {\n      helpers.imageSize(url).get(function (result) {\n        result.each(function (size) {\n          if (state.open) {\n            api.setData({\n              dimensions: size\n            });\n          }\n        });\n      });\n    }\n  };\n\n  var updateImagesDropdown = function updateImagesDropdown(info, state, api) {\n    var data = api.getData();\n    var image = ListUtils.findEntry(info.imageList, data.src.value);\n    state.prevImage = image;\n    api.setData({\n      images: image.map(function (entry) {\n        return entry.value;\n      }).getOr('')\n    });\n  };\n\n  var changeSrc = function changeSrc(helpers, info, state, api) {\n    addPrependUrl(info, api);\n    formFillFromMeta(info, api);\n    calculateImageSize(helpers, info, state, api);\n    updateImagesDropdown(info, state, api);\n  };\n\n  var changeImages = function changeImages(helpers, info, state, api) {\n    var data = api.getData();\n    var image = ListUtils.findEntry(info.imageList, data.images);\n    image.each(function (img) {\n      var updateAlt = data.alt === '' || state.prevImage.map(function (image) {\n        return image.text === data.alt;\n      }).getOr(false);\n\n      if (updateAlt) {\n        if (img.value === '') {\n          api.setData({\n            src: img,\n            alt: state.prevAlt\n          });\n        } else {\n          api.setData({\n            src: img,\n            alt: img.text\n          });\n        }\n      } else {\n        api.setData({\n          src: img\n        });\n      }\n    });\n    state.prevImage = image;\n    changeSrc(helpers, info, state, api);\n  };\n\n  var calcVSpace = function calcVSpace(css) {\n    var matchingTopBottom = css['margin-top'] && css['margin-bottom'] && css['margin-top'] === css['margin-bottom'];\n    return matchingTopBottom ? Utils.removePixelSuffix(String(css['margin-top'])) : '';\n  };\n\n  var calcHSpace = function calcHSpace(css) {\n    var matchingLeftRight = css['margin-right'] && css['margin-left'] && css['margin-right'] === css['margin-left'];\n    return matchingLeftRight ? Utils.removePixelSuffix(String(css['margin-right'])) : '';\n  };\n\n  var calcBorderWidth = function calcBorderWidth(css) {\n    return css['border-width'] ? Utils.removePixelSuffix(String(css['border-width'])) : '';\n  };\n\n  var calcBorderStyle = function calcBorderStyle(css) {\n    return css['border-style'] ? String(css['border-style']) : '';\n  };\n\n  var calcStyle = function calcStyle(parseStyle, serializeStyle, css) {\n    return serializeStyle(parseStyle(serializeStyle(css)));\n  };\n\n  var changeStyle2 = function changeStyle2(parseStyle, serializeStyle, data) {\n    var css = Utils.mergeMargins(parseStyle(data.style));\n    var dataCopy = deepMerge({}, data);\n    dataCopy.vspace = calcVSpace(css);\n    dataCopy.hspace = calcHSpace(css);\n    dataCopy.border = calcBorderWidth(css);\n    dataCopy.borderstyle = calcBorderStyle(css);\n    dataCopy.style = calcStyle(parseStyle, serializeStyle, css);\n    return dataCopy;\n  };\n\n  var changeStyle = function changeStyle(helpers, api) {\n    var data = api.getData();\n    var newData = changeStyle2(helpers.parseStyle, helpers.serializeStyle, data);\n    api.setData(newData);\n  };\n\n  var changeAStyle = function changeAStyle(helpers, info, api) {\n    var data = deepMerge(fromImageData(info.image), api.getData());\n    var style = getStyleValue(helpers.normalizeCss, toImageData(data));\n    api.setData({\n      style: style\n    });\n  };\n\n  var changeFileInput = function changeFileInput(helpers, info, state, api) {\n    var data = api.getData();\n    api.block('Uploading image');\n    head(data.fileinput).fold(function () {\n      api.unblock();\n    }, function (file) {\n      var blobUri = domGlobals.URL.createObjectURL(file);\n      var uploader = Uploader({\n        url: info.url,\n        basePath: info.basePath,\n        credentials: info.credentials,\n        handler: info.handler\n      });\n\n      var finalize = function finalize() {\n        api.unblock();\n        domGlobals.URL.revokeObjectURL(blobUri);\n      };\n\n      Utils.blobToDataUri(file).then(function (dataUrl) {\n        var blobInfo = helpers.createBlobCache(file, blobUri, dataUrl);\n        uploader.upload(blobInfo).then(function (url) {\n          api.setData({\n            src: {\n              value: url,\n              meta: {}\n            }\n          });\n          api.showTab('general');\n          changeSrc(helpers, info, state, api);\n          finalize();\n        })[\"catch\"](function (err) {\n          finalize();\n          helpers.alertErr(api, err);\n        });\n      });\n    });\n  };\n\n  var changeHandler = function changeHandler(helpers, info, state) {\n    return function (api, evt) {\n      if (evt.name === 'src') {\n        changeSrc(helpers, info, state, api);\n      } else if (evt.name === 'images') {\n        changeImages(helpers, info, state, api);\n      } else if (evt.name === 'alt') {\n        state.prevAlt = api.getData().alt;\n      } else if (evt.name === 'style') {\n        changeStyle(helpers, api);\n      } else if (evt.name === 'vspace' || evt.name === 'hspace' || evt.name === 'border' || evt.name === 'borderstyle') {\n        changeAStyle(helpers, info, api);\n      } else if (evt.name === 'fileinput') {\n        changeFileInput(helpers, info, state, api);\n      }\n    };\n  };\n\n  var closeHandler = function closeHandler(state) {\n    return function () {\n      state.open = false;\n    };\n  };\n\n  var makeDialogBody = function makeDialogBody(info) {\n    if (info.hasAdvTab || info.hasUploadUrl || info.hasUploadHandler) {\n      var tabPanel = {\n        type: 'tabpanel',\n        tabs: flatten([[MainTab.makeTab(info)], info.hasAdvTab ? [AdvTab.makeTab(info)] : [], info.hasUploadTab && (info.hasUploadUrl || info.hasUploadHandler) ? [UploadTab.makeTab(info)] : []])\n      };\n      return tabPanel;\n    } else {\n      var panel = {\n        type: 'panel',\n        items: MainTab.makeItems(info)\n      };\n      return panel;\n    }\n  };\n\n  var makeDialog = function makeDialog(helpers) {\n    return function (info) {\n      var state = createState(info);\n      return {\n        title: 'Insert/Edit Image',\n        size: 'normal',\n        body: makeDialogBody(info),\n        buttons: [{\n          type: 'cancel',\n          name: 'cancel',\n          text: 'Cancel'\n        }, {\n          type: 'submit',\n          name: 'save',\n          text: 'Save',\n          primary: true\n        }],\n        initialData: fromImageData(info.image),\n        onSubmit: helpers.onSubmit(info),\n        onChange: changeHandler(helpers, info, state),\n        onClose: closeHandler(state)\n      };\n    };\n  };\n\n  var submitHandler = function submitHandler(editor) {\n    return function (info) {\n      return function (api) {\n        var data = deepMerge(fromImageData(info.image), api.getData());\n        editor.undoManager.transact(function () {\n          insertOrUpdateImage(editor, toImageData(data));\n        });\n        editor.editorUpload.uploadImagesAuto();\n        api.close();\n      };\n    };\n  };\n\n  var imageSize = function imageSize(editor) {\n    return function (url) {\n      return FutureResult.nu(function (completer) {\n        Utils.getImageSize(editor.documentBaseURI.toAbsolute(url), function (data) {\n          var result = data.map(function (dimensions) {\n            return {\n              width: String(dimensions.width),\n              height: String(dimensions.height)\n            };\n          });\n          completer(result);\n        });\n      });\n    };\n  };\n\n  var createBlobCache = function createBlobCache(editor) {\n    return function (file, blobUri, dataUrl) {\n      return editor.editorUpload.blobCache.create({\n        blob: file,\n        blobUri: blobUri,\n        name: file.name ? file.name.replace(/\\.[^\\.]+$/, '') : null,\n        base64: dataUrl.split(',')[1]\n      });\n    };\n  };\n\n  var alertErr = function alertErr(editor) {\n    return function (api, message) {\n      editor.windowManager.alert(message, api.close);\n    };\n  };\n\n  var normalizeCss$1 = function normalizeCss$1(editor) {\n    return function (cssText) {\n      return normalizeCss(editor, cssText);\n    };\n  };\n\n  var parseStyle = function parseStyle(editor) {\n    return function (cssText) {\n      return editor.dom.parseStyle(cssText);\n    };\n  };\n\n  var serializeStyle = function serializeStyle(editor) {\n    return function (stylesArg, name) {\n      return editor.dom.serializeStyle(stylesArg, name);\n    };\n  };\n\n  var Dialog = function Dialog(editor) {\n    var helpers = {\n      onSubmit: submitHandler(editor),\n      imageSize: imageSize(editor),\n      createBlobCache: createBlobCache(editor),\n      alertErr: alertErr(editor),\n      normalizeCss: normalizeCss$1(editor),\n      parseStyle: parseStyle(editor),\n      serializeStyle: serializeStyle(editor)\n    };\n\n    var open = function open() {\n      return collect(editor).map(makeDialog(helpers)).get(function (spec) {\n        editor.windowManager.open(spec);\n      });\n    };\n\n    return {\n      open: open\n    };\n  };\n\n  var register = function register(editor) {\n    editor.addCommand('mceImage', Dialog(editor).open);\n  };\n\n  var Commands = {\n    register: register\n  };\n\n  var hasImageClass = function hasImageClass(node) {\n    var className = node.attr('class');\n    return className && /\\bimage\\b/.test(className);\n  };\n\n  var toggleContentEditableState = function toggleContentEditableState(state) {\n    return function (nodes) {\n      var i = nodes.length;\n\n      var toggleContentEditable = function toggleContentEditable(node) {\n        node.attr('contenteditable', state ? 'true' : null);\n      };\n\n      while (i--) {\n        var node = nodes[i];\n\n        if (hasImageClass(node)) {\n          node.attr('contenteditable', state ? 'false' : null);\n          global$5.each(node.getAll('figcaption'), toggleContentEditable);\n        }\n      }\n    };\n  };\n\n  var setup = function setup(editor) {\n    editor.on('PreInit', function () {\n      editor.parser.addNodeFilter('figure', toggleContentEditableState(true));\n      editor.serializer.addNodeFilter('figure', toggleContentEditableState(false));\n    });\n  };\n\n  var FilterContent = {\n    setup: setup\n  };\n\n  var register$1 = function register$1(editor) {\n    editor.ui.registry.addToggleButton('image', {\n      icon: 'image',\n      tooltip: 'Insert/edit image',\n      onAction: Dialog(editor).open,\n      onSetup: function onSetup(buttonApi) {\n        return editor.selection.selectorChangedWithUnbind('img:not([data-mce-object],[data-mce-placeholder]),figure.image', buttonApi.setActive).unbind;\n      }\n    });\n    editor.ui.registry.addMenuItem('image', {\n      icon: 'image',\n      text: 'Image...',\n      onAction: Dialog(editor).open\n    });\n    editor.ui.registry.addContextMenu('image', {\n      update: function update(element) {\n        return isFigure(element) || isImage(element) && !Utils.isPlaceholderImage(element) ? ['image'] : [];\n      }\n    });\n  };\n\n  var Buttons = {\n    register: register$1\n  };\n\n  function Plugin() {\n    global$1.add('image', function (editor) {\n      FilterContent.setup(editor);\n      Buttons.register(editor);\n      Commands.register(editor);\n    });\n  }\n\n  Plugin();\n})(window);"],"sourceRoot":""}